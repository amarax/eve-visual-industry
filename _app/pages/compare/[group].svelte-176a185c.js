import{S as ne,i as ue,s as fe,P as be,B as Ne,e as V,k as Q,a3 as Re,c as q,a as S,n as Y,a4 as Pe,d as k,a5 as De,a6 as ke,b as G,f as O,D as T,R as Ie,T as Me,U as Ce,p as Le,x as Z,u as z,a7 as Qe,N as H,O as J,t as re,j as ee,g as oe,m as te,o as ie,h as me,Q as K,v as se,L as X,M as Ye,H as He,Y as Je,y as Ke,C as Ze,l as Ee,Z as ze,E as We,F as Te,G as Be,ab as Xe,w as xe,a0 as $e,ac as we,ad as et,ae as tt,r as it,af as st,K as rt}from"../../chunks/vendor-dd7e5550.js";import{M as ot,a as at,C as lt,b as nt,c as Se,p as ut,g as ft}from"../../chunks/IndustryJob-4913fb84.js";import{P as Oe,U as ct,q as Ue,e as Ve,L as _t,R as pt,j as dt,k as mt,m as yt,s as gt}from"../../chunks/EveMarketGroups-94ca141b.js";import{b as qe}from"../../chunks/paths-28a87002.js";import"../../chunks/singletons-12a22614.js";function vt(e){let i,t,s,r,p,y;const g=e[6].default,_=be(g,e,e[5],null);let P=[{class:p=e[0]<0?"negative":"positive"},e[1](e[0])],c={};for(let u=0;u<P.length;u+=1)c=Ne(c,P[u]);return{c(){i=V("div"),_&&_.c(),t=Q(),s=Re("svg"),r=Re("rect"),this.h()},l(u){i=q(u,"DIV",{class:!0});var n=S(i);_&&_.l(n),t=Y(n),s=Pe(n,"svg",{class:!0});var h=S(s);r=Pe(h,"rect",{class:!0}),S(r).forEach(k),h.forEach(k),n.forEach(k),this.h()},h(){De(r,c),ke(r,"svelte-1driw1p",!0),G(s,"class","svelte-1driw1p"),G(i,"class","block svelte-1driw1p")},m(u,n){O(u,i,n),_&&_.m(i,null),T(i,t),T(i,s),T(s,r),y=!0},p(u,[n]){_&&_.p&&(!y||n&32)&&Ie(_,g,u,u[5],y?Ce(g,u[5],n,null):Me(u[5]),null),De(r,c=Le(P,[(!y||n&1&&p!==(p=u[0]<0?"negative":"positive"))&&{class:p},n&3&&u[1](u[0])])),ke(r,"svelte-1driw1p",!0)},i(u){y||(Z(_,u),y=!0)},o(u){z(_,u),y=!1},d(u){u&&k(i),_&&_.d(u)}}}function ht(e,i,t){let s,r,p,{$$slots:y={},$$scope:g}=i,{value:_}=i,{extents:P}=i;return e.$$set=c=>{"value"in c&&t(0,_=c.value),"extents"in c&&t(2,P=c.extents),"$$scope"in c&&t(5,g=c.$$scope)},e.$$.update=()=>{e.$$.dirty&4&&t(4,s=P[1]>P[0]),e.$$.dirty&20&&t(3,r=Qe().domain(s?P:[0,1]).range([0,100])),e.$$.dirty&8&&t(1,p=c=>({x:`${Math.min(r(c),r(0))}%`,width:`${Math.abs(r(c)-r(0))}%`,y:0,height:"100%"}))},[_,p,P,r,s,g,y]}class Ae extends ne{constructor(i){super();ue(this,i,ht,vt,fe,{value:0,extents:2})}}function bt(e){let i=Ue(e[1])+"",t;return{c(){t=re(i)},l(s){t=oe(s,i)},m(s,r){O(s,t,r)},p(s,r){r&2&&i!==(i=Ue(s[1])+"")&&me(t,i)},d(s){s&&k(t)}}}function Rt(e){let i=Ve(e[2])+"",t;return{c(){t=re(i)},l(s){t=oe(s,i)},m(s,r){O(s,t,r)},p(s,r){r&4&&i!==(i=Ve(s[2])+"")&&me(t,i)},d(s){s&&k(t)}}}function Pt(e){var v;let i,t,s=((v=e[10].types[e[3]])==null?void 0:v.name)+"",r,p,y,g,_,P,c,u,n,h,o,b,d,I,m;P=new Ae({props:{value:e[1],extents:e[6].profitRatio,$$slots:{default:[bt]},$$scope:{ctx:e}}}),n=new Ae({props:{value:e[2],extents:e[6].profitPerDay,$$slots:{default:[Rt]},$$scope:{ctx:e}}});function E(a){e[15](a)}function U(a){e[16](a)}let B={type_id:e[3],quantity:e[9].producedQuantity,totalCost:e[9].totalCost,buyOverheadRate:-e[4],sellOverheadRate:-e[5]-e[4],extents:e[6].graph};return e[0][e[3]]!==void 0&&(B.price=e[0][e[3]]),e[7]!==void 0&&(B.lowestSellPrice=e[7]),b=new ot({props:B}),H.push(()=>J(b,"price",E)),H.push(()=>J(b,"lowestSellPrice",U)),{c(){i=V("div"),t=V("a"),r=re(s),g=Q(),_=V("div"),ee(P.$$.fragment),c=Q(),u=V("div"),ee(n.$$.fragment),h=Q(),o=V("div"),ee(b.$$.fragment),this.h()},l(a){i=q(a,"DIV",{class:!0,title:!0});var R=S(i);t=q(R,"A",{href:!0});var j=S(t);r=oe(j,s),j.forEach(k),R.forEach(k),g=Y(a),_=q(a,"DIV",{class:!0});var C=S(_);te(P.$$.fragment,C),C.forEach(k),c=Y(a),u=q(a,"DIV",{class:!0});var w=S(u);te(n.$$.fragment,w),w.forEach(k),h=Y(a),o=q(a,"DIV",{class:!0});var N=S(o);te(b.$$.fragment,N),N.forEach(k),this.h()},h(){var a;G(t,"href",p=`${qe}/breakdown/${e[3]}`),G(i,"class","itemName svelte-1dxbxfs"),G(i,"title",y=`${(a=e[10].types[e[3]])==null?void 0:a.name} [${e[3]}]`),G(_,"class","metric svelte-1dxbxfs"),G(u,"class","metric svelte-1dxbxfs"),G(o,"class","graph")},m(a,R){O(a,i,R),T(i,t),T(t,r),O(a,g,R),O(a,_,R),ie(P,_,null),O(a,c,R),O(a,u,R),ie(n,u,null),O(a,h,R),O(a,o,R),ie(b,o,null),m=!0},p(a,[R]){var N,L;(!m||R&1032)&&s!==(s=((N=a[10].types[a[3]])==null?void 0:N.name)+"")&&me(r,s),(!m||R&8&&p!==(p=`${qe}/breakdown/${a[3]}`))&&G(t,"href",p),(!m||R&1032&&y!==(y=`${(L=a[10].types[a[3]])==null?void 0:L.name} [${a[3]}]`))&&G(i,"title",y);const j={};R&2&&(j.value=a[1]),R&64&&(j.extents=a[6].profitRatio),R&131074&&(j.$$scope={dirty:R,ctx:a}),P.$set(j);const C={};R&4&&(C.value=a[2]),R&64&&(C.extents=a[6].profitPerDay),R&131076&&(C.$$scope={dirty:R,ctx:a}),n.$set(C);const w={};R&8&&(w.type_id=a[3]),R&512&&(w.quantity=a[9].producedQuantity),R&512&&(w.totalCost=a[9].totalCost),R&16&&(w.buyOverheadRate=-a[4]),R&48&&(w.sellOverheadRate=-a[5]-a[4]),R&64&&(w.extents=a[6].graph),!d&&R&9&&(d=!0,w.price=a[0][a[3]],K(()=>d=!1)),!I&&R&128&&(I=!0,w.lowestSellPrice=a[7],K(()=>I=!1)),b.$set(w)},i(a){m||(Z(P.$$.fragment,a),Z(n.$$.fragment,a),Z(b.$$.fragment,a),m=!0)},o(a){z(P.$$.fragment,a),z(n.$$.fragment,a),z(b.$$.fragment,a),m=!1},d(a){a&&k(i),a&&k(g),a&&k(_),se(P),a&&k(c),a&&k(u),se(n),a&&k(h),a&&k(o),se(b)}}}function Dt(e,i,t){let s,r,p=He,y=()=>(p(),p=Ye(s,v=>t(9,r=v)),s),g,_,P;X(e,at,v=>t(13,g=v)),X(e,Oe,v=>t(14,_=v)),X(e,ct,v=>t(10,P=v)),e.$$.on_destroy.push(()=>p());let{productTypeId:c=null}=i,{prices:u}=i,{facilityModifiers:n}=i,{salesTaxRate:h=.036}=i,{brokerFeeRate:o=.0113709973928}=i,{profitRatio:b=0}=i,{profitPerDay:d=0}=i,{extents:I={profitRatio:[-.5,.5],profitPerDay:[-1e6,1e6],graph:[0,1e3]}}=i,{priceUpperBound:m=0}=i,E;function U(v){e.$$.not_equal(u[c],v)&&(u[c]=v,t(0,u))}function B(v){E=v,t(7,E)}return e.$$set=v=>{"productTypeId"in v&&t(3,c=v.productTypeId),"prices"in v&&t(0,u=v.prices),"facilityModifiers"in v&&t(12,n=v.facilityModifiers),"salesTaxRate"in v&&t(4,h=v.salesTaxRate),"brokerFeeRate"in v&&t(5,o=v.brokerFeeRate),"profitRatio"in v&&t(1,b=v.profitRatio),"profitPerDay"in v&&t(2,d=v.profitPerDay),"extents"in v&&t(6,I=v.extents),"priceUpperBound"in v&&t(11,m=v.priceUpperBound)},e.$$.update=()=>{e.$$.dirty&16392&&y(t(8,s=lt(c,_))),e.$$.dirty&8448&&s.update({indexPrices:g}),e.$$.dirty&257&&s.update({prices:u}),e.$$.dirty&4352&&n&&s.update({facilityModifiers:n}),e.$$.dirty&512&&t(1,b=(r==null?void 0:r.profit)/(r==null?void 0:r.totalCost)),e.$$.dirty&512&&t(2,d=(r==null?void 0:r.profit)*(24*60*60)/(r==null?void 0:r.jobDuration)),e.$$.dirty&649&&t(11,m=Math.max(r==null?void 0:r.totalCost,u[c]*(r==null?void 0:r.producedQuantity),E))},[u,b,d,c,h,o,I,E,s,r,P,m,n,g,_,U,B]}class kt extends ne{constructor(i){super();ue(this,i,Dt,Pt,fe,{productTypeId:3,prices:0,facilityModifiers:12,salesTaxRate:4,brokerFeeRate:5,profitRatio:1,profitPerDay:2,extents:6,priceUpperBound:11})}}function It(e){let i,t,s,r,p,y,g;function _(o){e[7](o)}function P(o){e[8](o)}function c(o){e[9](o)}function u(o){e[10](o)}function n(o){e[11](o)}let h={activity:e[2]};return e[1]!==void 0&&(h.value=e[1]),e[0].systemCostIndex!==void 0&&(h.activitySystemCostIndex=e[0].systemCostIndex),e[0].taxRate!==void 0&&(h.activityTax=e[0].taxRate),e[3]!==void 0&&(h.structureRoleBonuses=e[3]),e[4]!==void 0&&(h.structureRigBonuses=e[4]),i=new _t({props:h}),H.push(()=>J(i,"value",_)),H.push(()=>J(i,"activitySystemCostIndex",P)),H.push(()=>J(i,"activityTax",c)),H.push(()=>J(i,"structureRoleBonuses",u)),H.push(()=>J(i,"structureRigBonuses",n)),{c(){ee(i.$$.fragment)},l(o){te(i.$$.fragment,o)},m(o,b){ie(i,o,b),g=!0},p(o,[b]){const d={};b&4&&(d.activity=o[2]),!t&&b&2&&(t=!0,d.value=o[1],K(()=>t=!1)),!s&&b&1&&(s=!0,d.activitySystemCostIndex=o[0].systemCostIndex,K(()=>s=!1)),!r&&b&1&&(r=!0,d.activityTax=o[0].taxRate,K(()=>r=!1)),!p&&b&8&&(p=!0,d.structureRoleBonuses=o[3],K(()=>p=!1)),!y&&b&16&&(y=!0,d.structureRigBonuses=o[4],K(()=>y=!1)),i.$set(d)},i(o){g||(Z(i.$$.fragment,o),g=!0)},o(o){z(i.$$.fragment,o),g=!1},d(o){se(i,o)}}}function Mt(e,i,t){let s,{facilityModifiers:r={systemCostIndex:.05,taxRate:10}}=i,p,y,{value:g}=i,{activity:_}=i,P=Je("locations");X(e,P,d=>t(6,s=d));let c=Ze(s);Ke("locations",c);function u(d){g=d,t(1,g)}function n(d){e.$$.not_equal(r.systemCostIndex,d)&&(r.systemCostIndex=d,t(0,r),t(3,p),t(4,y))}function h(d){e.$$.not_equal(r.taxRate,d)&&(r.taxRate=d,t(0,r),t(3,p),t(4,y))}function o(d){p=d,t(3,p)}function b(d){y=d,t(4,y)}return e.$$set=d=>{"facilityModifiers"in d&&t(0,r=d.facilityModifiers),"value"in d&&t(1,g=d.value),"activity"in d&&t(2,_=d.activity)},e.$$.update=()=>{if(e.$$.dirty&9&&(p?t(0,r.roleModifiers={jobDuration:p.jobDurationModifier,materialConsumption:p.materialConsumptionModifier,jobCost:p.jobCostModifier},r):delete r.roleModifiers),e.$$.dirty&17&&(y?t(0,r.rigModifiers={materialReduction:y.materialReductionBonus,timeReduction:y.timeReductionBonus,costReduction:y.costReductionBonus},r):delete r.rigModifiers),e.$$.dirty&68&&s)switch(_){case pt:const d=35835;let I=Object.values(s).filter(m=>(m==null?void 0:m.type_id)==d).map(m=>[m==null?void 0:m.type_id,m]);c.set(Object.fromEntries(I));break;default:c.set(s)}},[r,g,_,p,y,P,s,u,n,h,o,b]}class Ct extends ne{constructor(i){super();ue(this,i,Mt,It,fe,{facilityModifiers:0,value:1,activity:2})}}const{Map:Et}=tt;function Ge(e,i,t){const s=e.slice();return s[27]=i[t],s[28]=i,s[29]=t,s}function je(e,i){let t,s,r,p,y,g;function _(n){i[24](n,i[27])}function P(n){i[25](n,i[27])}function c(n){i[26](n,i[27])}let u={productTypeId:i[27],facilityModifiers:i[7],prices:i[1],extents:i[10]};return i[2].profitRatio[i[27]]!==void 0&&(u.profitRatio=i[2].profitRatio[i[27]]),i[2].profitPerDay[i[27]]!==void 0&&(u.profitPerDay=i[2].profitPerDay[i[27]]),i[4][i[27]]!==void 0&&(u.priceUpperBound=i[4][i[27]]),s=new kt({props:u}),H.push(()=>J(s,"profitRatio",_)),H.push(()=>J(s,"profitPerDay",P)),H.push(()=>J(s,"priceUpperBound",c)),{key:e,first:null,c(){t=Ee(),ee(s.$$.fragment),this.h()},l(n){t=Ee(),te(s.$$.fragment,n),this.h()},h(){this.first=t},m(n,h){O(n,t,h),ie(s,n,h),g=!0},p(n,h){i=n;const o={};h&32&&(o.productTypeId=i[27]),h&128&&(o.facilityModifiers=i[7]),h&2&&(o.prices=i[1]),h&1024&&(o.extents=i[10]),!r&&h&36&&(r=!0,o.profitRatio=i[2].profitRatio[i[27]],K(()=>r=!1)),!p&&h&36&&(p=!0,o.profitPerDay=i[2].profitPerDay[i[27]],K(()=>p=!1)),!y&&h&48&&(y=!0,o.priceUpperBound=i[4][i[27]],K(()=>y=!1)),s.$set(o)},i(n){g||(Z(s.$$.fragment,n),g=!0)},o(n){z(s.$$.fragment,n),g=!1},d(n){n&&k(t),se(s,n)}}}function Tt(e){let i,t,s,r,p,y,g,_,P,c,u,n,h,o,b,d,I,m,E,U,B,v,a,R,j,C=[],w=new Et,N,L,f,M;document.title=i=""+((e[11]&&e[11][e[0]]?`${e[11][e[0]].name} - `:"")+"EVE Online Visual Industry Calculator"),r=new nt({props:{value:e[9]}}),r.$on("change",e[19]);function W(l){e[21](l)}function le(l){e[22](l)}let ce={activity:e[8]};e[6]!==void 0&&(ce.value=e[6]),e[7]!==void 0&&(ce.facilityModifiers=e[7]),c=new Ct({props:ce}),H.push(()=>J(c,"value",W)),H.push(()=>J(c,"facilityModifiers",le));let ae=e[5];const ye=l=>l[27];for(let l=0;l<ae.length;l+=1){let D=Ge(e,ae,l),A=ye(D);w.set(A,C[l]=je(A,D))}const _e=e[18].default,F=be(_e,e,e[17],null);return{c(){t=Q(),s=V("p"),ee(r.$$.fragment),p=V("br"),y=Q(),g=V("button"),_=re("Compare"),P=Q(),ee(c.$$.fragment),h=Q(),o=V("div"),b=V("div"),d=Q(),I=V("div"),m=V("select"),E=V("option"),U=re("Profit Ratio"),B=V("option"),v=re("Profit per Day"),a=Q(),R=V("div"),j=Q();for(let l=0;l<C.length;l+=1)C[l].c();N=Q(),F&&F.c(),this.h()},l(l){ze('[data-svelte="svelte-1wghn3n"]',document.head).forEach(k),t=Y(l),s=q(l,"P",{});var A=S(s);te(r.$$.fragment,A),p=q(A,"BR",{}),y=Y(A),g=q(A,"BUTTON",{});var $=S(g);_=oe($,"Compare"),$.forEach(k),A.forEach(k),P=Y(l),te(c.$$.fragment,l),h=Y(l),o=q(l,"DIV",{class:!0});var x=S(o);b=q(x,"DIV",{class:!0}),S(b).forEach(k),d=Y(x),I=q(x,"DIV",{class:!0});var ge=S(I);m=q(ge,"SELECT",{});var pe=S(m);E=q(pe,"OPTION",{});var ve=S(E);U=oe(ve,"Profit Ratio"),ve.forEach(k),B=q(pe,"OPTION",{});var he=S(B);v=oe(he,"Profit per Day"),he.forEach(k),pe.forEach(k),ge.forEach(k),a=Y(x),R=q(x,"DIV",{class:!0});var Fe=S(R);Fe.forEach(k),j=Y(x);for(let de=0;de<C.length;de+=1)C[de].l(x);x.forEach(k),N=Y(l),F&&F.l(l),this.h()},h(){G(b,"class","itemName"),E.__value="profitRatio",E.value=E.__value,B.__value="profitPerDay",B.value=B.__value,e[3]===void 0&&We(()=>e[23].call(m)),G(I,"class","metricSelector svelte-1no3laa"),G(R,"class","graph"),G(o,"class","compare svelte-1no3laa")},m(l,D){O(l,t,D),O(l,s,D),ie(r,s,null),T(s,p),T(s,y),T(s,g),T(g,_),O(l,P,D),ie(c,l,D),O(l,h,D),O(l,o,D),T(o,b),T(o,d),T(o,I),T(I,m),T(m,E),T(E,U),T(m,B),T(B,v),Te(m,e[3]),T(o,a),T(o,R),T(o,j);for(let A=0;A<C.length;A+=1)C[A].m(o,null);O(l,N,D),F&&F.m(l,D),L=!0,f||(M=[Be(g,"click",e[20]),Be(m,"change",e[23])],f=!0)},p(l,[D]){(!L||D&2049)&&i!==(i=""+((l[11]&&l[11][l[0]]?`${l[11][l[0]].name} - `:"")+"EVE Online Visual Industry Calculator"))&&(document.title=i);const A={};D&512&&(A.value=l[9]),r.$set(A);const $={};D&256&&($.activity=l[8]),!u&&D&64&&(u=!0,$.value=l[6],K(()=>u=!1)),!n&&D&128&&(n=!0,$.facilityModifiers=l[7],K(()=>n=!1)),c.$set($),D&8&&Te(m,l[3]),D&1206&&(ae=l[5],it(),C=Xe(C,D,ye,1,l,ae,w,o,st,je,null,Ge),xe()),F&&F.p&&(!L||D&131072)&&Ie(F,_e,l,l[17],L?Ce(_e,l[17],D,null):Me(l[17]),null)},i(l){if(!L){Z(r.$$.fragment,l),Z(c.$$.fragment,l);for(let D=0;D<ae.length;D+=1)Z(C[D]);Z(F,l),L=!0}},o(l){z(r.$$.fragment,l),z(c.$$.fragment,l);for(let D=0;D<C.length;D+=1)z(C[D]);z(F,l),L=!1},d(l){l&&k(t),l&&k(s),se(r),l&&k(P),se(c,l),l&&k(h),l&&k(o);for(let D=0;D<C.length;D+=1)C[D].d();l&&k(N),F&&F.d(l),f=!1,$e(M)}}}function Bt(e,i,t){let s,r,p,y,g,_,P;X(e,Oe,f=>t(13,p=f)),X(e,mt,f=>t(14,y=f)),X(e,yt,f=>t(15,g=f)),X(e,ut,f=>t(16,_=f)),X(e,gt,f=>t(11,P=f));let{$$slots:c={},$$scope:u}=i,n,h=null,o,b={},d=null,I=new Map,m={profitRatio:{},profitPerDay:{}},E="profitRatio",U={},B=n;const v=f=>t(9,B=f.detail),a=f=>ft(`${B}`,{keepfocus:!0});function R(f){h=f,t(6,h)}function j(f){o=f,t(7,o)}function C(){E=rt(this),t(3,E)}function w(f,M){e.$$.not_equal(m.profitRatio[M],f)&&(m.profitRatio[M]=f,t(2,m))}function N(f,M){e.$$.not_equal(m.profitPerDay[M],f)&&(m.profitPerDay[M]=f,t(2,m))}function L(f,M){e.$$.not_equal(U[M],f)&&(U[M]=f,t(4,U),t(5,s),t(0,n),t(15,g),t(14,y),t(13,p),t(2,m),t(3,E),t(16,_))}return e.$$set=f=>{"$$scope"in f&&t(17,u=f.$$scope)},e.$$.update=()=>{if(e.$$.dirty&65537&&(t(0,n=parseInt(_.params.group)||null),t(9,B=n)),e.$$.dirty&57357&&t(5,s=dt(n,g,y,p).sort((f,M)=>m[E][M]-m[E][f])),e.$$.dirty&12322){I.clear(),s.forEach(f=>I.set(f,null)),s.map(f=>p.get(f).activity).filter(f=>f!==void 0).forEach(f=>{for(const M in f.materials)I.set(parseInt(M),null);t(8,d=f.activity.activityID)}),I.forEach((f,M)=>{Se(M).subscribe(W=>{var le;I.set(M,W),b[M]===void 0&&t(1,b[M]=(le=W==null?void 0:W.orders.sell[0])==null?void 0:le.price,b)})});for(let f in I)Se(parseInt(f)).subscribe(M=>{var W;t(12,I[f]=M,I),b[f]===void 0&&t(1,b[f]=(W=M==null?void 0:M.orders.sell[0])==null?void 0:W.price,b)})}if(e.$$.dirty&48){for(let f in U)s.includes(parseInt(f))||delete U[f];t(4,U),t(5,s),t(0,n),t(15,g),t(14,y),t(13,p),t(2,m),t(3,E),t(16,_)}e.$$.dirty&20&&t(10,r={profitRatio:we(Object.values(m.profitRatio)),profitPerDay:we(Object.values(m.profitPerDay)),graph:[0,et(Object.values(U))*1.1]})},[n,b,m,E,U,s,h,o,d,B,r,P,I,p,y,g,_,u,c,v,a,R,j,C,w,N,L]}class qt extends ne{constructor(i){super();ue(this,i,Bt,Tt,fe,{})}}export{qt as default};
