var Yr=Object.defineProperty;var wi=Object.getOwnPropertySymbols;var Jr=Object.prototype.hasOwnProperty,zr=Object.prototype.propertyIsEnumerable;var Oi=(e,l,t)=>l in e?Yr(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,qi=(e,l)=>{for(var t in l||(l={}))Jr.call(l,t)&&Oi(e,t,l[t]);if(wi)for(var t of wi(l))zr.call(l,t)&&Oi(e,t,l[t]);return e};import{K as Vl,L as Ul,P as ji,C as Ml,S as vl,i as gl,s as kl,e as E,t as B,c as I,a as O,g as w,d as o,f as q,H as a,h as Z,M as Fl,N as Ut,O as ye,I as Se,Q as It,R as ci,T as Al,U as Xr,B as Xl,l as Te,V as Pt,W as Bt,X as El,Y as Il,p as Hl,b as T,Z as Kl,_ as Ql,$ as Ke,A as Si,a0 as Ol,a1 as di,a2 as Hr,a3 as Kr,a4 as Wr,a5 as De,k as J,n as z,a6 as Be,j as et,m as tt,o as lt,a7 as we,x as ie,u as fe,v as it,a8 as ft,r as Jt,w as zt,a9 as Ft,aa as Zr,J as xr,y as hi}from"../../chunks/vendor-0ab7548f.js";import{r as $r,b as Gl}from"../../chunks/paths-c3a241ee.js";const es=$r,ts=ls;async function ls(e,l){return es.goto(e,l,[])}const is=()=>{const e=Vl("__svelte__");return{page:{subscribe:e.page.subscribe},navigating:{subscribe:e.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:e.navigating.subscribe}},session:e.session}},rs={subscribe(e){return is().page.subscribe(e)}};async function Wl(e,l){let t=new URL(`https://esi.evetech.net/${l&&l.dev?"dev":"latest"}${e}`);const i=await fetch(t.toString(),{method:"GET",headers:{accept:"application/json"}}),n=await i.json();if(i.ok){let s=i.headers.get("X-Pages");return s&&parseInt(s)>1&&console.log("More pages were available but not retrieved",t.toString()),n}return Promise.reject(i)}async function ss(){const e=await fetch(`${Gl}/eve-sde/categories.json`,{method:"GET",headers:{accept:"application/json"}}),l=await e.json();return e.ok?l:Promise.reject(e)}async function ns(){let e;try{e=await ll("invMarketGroups")}catch(i){console.error(i)}let l={groups:{},groupTree:{}};e.forEach(i=>{l.groups[i.market_group_id]=i,i.types=[],i.parent_group_id=="None"&&delete i.parent_group_id});let t={};for(let i in l.groups){let n=l.groups[i];if(n.parent_group_id){let s=l.groups[n.parent_group_id];s.child_groups===void 0&&(s.child_groups={}),s.child_groups[i]=n}}for(let i in l.groups){let n=l.groups[i];n.parent_group_id===void 0&&(t[n.market_group_id]=n)}return l.groupTree=t,l}function ll(e){let l=i=>({header:!0,dynamicTyping:!0,complete:async n=>{i(n.data)}}),t=`${Gl}/eve-sde/${e}.csv`;return new Promise(i=>{ji.parse(t,qi({download:!0},l(i)))})}async function us(e){return new Promise(l=>{ji.parse(`${Gl}/eve-sde/types.csv`,{download:!0,header:!0,dynamicTyping:!0,complete:async(t,i)=>{let n={};for(let s of t.data)s.published?(n[s.type_id]=s,s.market_group_id==="None"?delete s.market_group_id:e[s.market_group_id].types.push(s.type_id)):delete n[s.type_id];l(n)}})})}let Zl={},Ni=!1;function os(e){if(Ni)return()=>{};const l={categories:null,types:Zl,markets:null};return e(l),ss().then(t=>{l.categories=t,e(l)}).catch(t=>{console.error(t)}),ns().then(t=>{l.markets=t,e(l),us(t.groups).then(i=>{Zl=i,l.types=Zl,e(l),Ni=!0}).catch(i=>{console.error(i)})}).catch(t=>{console.error(t)}),()=>{}}async function as(e){try{let l=await Wl(`/universe/types/${e}/`);return Zl[e]=l,l}catch(l){console.error(l)}}const ql=Ul({types:{}},os);Ul({},fs);function fs(e){return e({attributes:null}),()=>{}}let xl={};function _s(){const{subscribe:e,update:l}=Ml({});return{subscribe:e,update:t=>l(i=>{for(let n in t)i[n]===void 0&&(i[n]={}),Object.assign(i[n],t[n]);return i})}}const Li=_s();function $l(e){return 6e7<=e&&e<7e7}function cs(e){return xl[e]===void 0&&($l(e)?xl[e]=ei(`/universe/stations/${e}/`):xl[e]=mi(`/universe/structures/${e}/`)),xl[e]}var pi;(function(e){e[e.loading=0]="loading",e[e.loaded=1]="loaded",e[e.error=2]="error"})(pi||(pi={}));function ei(e,l){let t={status:0,subscribe:null};function i(s){return t.status!==1&&Wl(e).then(r=>{l&&(r=l(r)),t.status=1,s(r)}).catch(r=>{t.status=2,s(null),console.error(r)}),()=>{}}const{subscribe:n}=Ml(null,i);return t.subscribe=n,t}function mi(e,l){let t={status:0,subscribe:null};function i(s){return t.status!==1&&fetch(`${Gl}/esi-cache${e}index.json`).then(r=>r.ok?r.json():Promise.reject("Fetch failed")).then(r=>{l&&(r=l(r)),t.status=1,s(r)}).catch(r=>{t.status=2,s(null),console.error(r)}),()=>{}}const{subscribe:n}=Ml(null,i);return t.subscribe=n,t}const ti={},li={},Vi={};async function ds(){try{let e=await(await fetch(`${Gl}/esi-cache/authorisedCharacters.json`)).json();for(let l of e)ti[l]=ei(`/characters/${l}/`),li[l]=mi(`/characters/${l}/skills/`),Vi[l]=mi(`/characters/${l}/blueprints/`)}catch(e){console.error(e)}}function Ui(e,l,t){const i=e.slice();return i[4]=l[t],i}function Fi(e){let l,t=(e[1][e[4]]||e[4])+"",i,n;return{c(){l=E("option"),i=B(t),this.h()},l(s){l=I(s,"OPTION",{});var r=O(l);i=w(r,t),r.forEach(o),this.h()},h(){l.__value=n=parseInt(e[4]),l.value=l.__value},m(s,r){q(s,l,r),a(l,i)},p(s,r){r&2&&t!==(t=(s[1][s[4]]||s[4])+"")&&Z(i,t),r&2&&n!==(n=parseInt(s[4]))&&(l.__value=n,l.value=l.__value)},d(s){s&&o(l)}}}function hs(e){let l,t,i,n=Object.keys(e[1]),s=[];for(let r=0;r<n.length;r+=1)s[r]=Fi(Ui(e,n,r));return{c(){l=E("select");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){l=I(r,"SELECT",{});var u=O(l);for(let c=0;c<s.length;c+=1)s[c].l(u);u.forEach(o),this.h()},h(){e[0]===void 0&&Fl(()=>e[2].call(l))},m(r,u){q(r,l,u);for(let c=0;c<s.length;c+=1)s[c].m(l,null);Ut(l,e[0]),t||(i=ye(l,"change",e[2]),t=!0)},p(r,[u]){if(u&2){n=Object.keys(r[1]);let c;for(c=0;c<n.length;c+=1){const f=Ui(r,n,c);s[c]?s[c].p(f,u):(s[c]=Fi(f),s[c].c(),s[c].m(l,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=n.length}u&3&&Ut(l,r[0])},i:Se,o:Se,d(r){r&&o(l),It(s,r),t=!1,i()}}}function ps(e,l,t){let{value:i=null}=l,n={},s=[];ds().then(()=>{for(let u in ti)s.push(ti[u].subscribe(c=>{t(1,n[u]=c==null?void 0:c.name,n)}));t(0,i=parseInt(Object.keys(ti)[0]))}),ci(()=>{s.forEach(u=>u())});function r(){i=Al(this),t(0,i),t(1,n)}return e.$$set=u=>{"value"in u&&t(0,i=u.value)},[i,n,r]}class ms extends vl{constructor(l){super();gl(this,l,ps,hs,kl,{value:0})}}const pt=1,ii=8,wt=11;let Ai=!1;function bs(e){if(Ai)return()=>{};let l={activities:{},types:{}};return ll("ramActivities").then(t=>{t.filter(i=>i.activityID).forEach(i=>l.activities[i.activityID]=i)}).then(()=>ll("industryActivity")).then(t=>{t.forEach(i=>{if(i.type_id===null)return;let n=l.types[i.type_id];n===void 0&&(n={type_id:i.type_id,activities:{}},l.types[i.type_id]=n),n.activities[i.activityID]={activity:l.activities[i.activityID],time:i.time,materials:{},products:{}}})}).then(()=>ll("industryActivityMaterials")).then(t=>{t.forEach(i=>{if(i.typeID===null)return;let n=l.types[i.typeID];console.assert(n!==void 0,i);let s=n.activities[i.activityID].materials;console.assert(s instanceof Object),s[i.materialTypeID]={materialTypeID:i.materialTypeID,quantity:i.quantity}})}).then(()=>ll("industryActivityProducts")).then(t=>{t.forEach(i=>{if(i.type_id===null)return;let n=l.types[i.type_id].activities[i.activityID];n.products[i.productTypeID]={type_id:i.productTypeID,quantity:i.quantity}})}).then(()=>ll("industryActivityProbabilities")).then(t=>{t.forEach(i=>{if(i.typeID===null)return;let n=l.types[i.typeID].activities[i.activityID];n.products[i.productTypeID].probability=i.probability})}).then(()=>ll("industryActivitySkills")).then(t=>{t.forEach(i=>{if(i.typeID===null)return;let n=l.types[i.typeID].activities[i.activityID];n.requiredSkills===void 0&&(n.requiredSkills={}),n.requiredSkills[i.skillID]={type_id:i.skillID,level:i.level}})}).then(()=>ll("industryBlueprints")).then(t=>{t.forEach(i=>l.types[i.type_id].maxProductionLimit=i.maxProductionLimit),e(l),Ai=!0}).catch(t=>console.error(t)),e(l),()=>{}}const Yl=Ul(null,bs);function ri(e,l){return Object.values(e.types).find(t=>{var i;return(i=t.activities[pt])==null?void 0:i.products[l]})}function ys(e,l){return Object.values(e.types).find(t=>{var i;return(i=t.activities[ii])==null?void 0:i.products[l]})}const vs=Xr(ql,(e,l)=>(gs(e).then(t=>l(t)),()=>{}),{});async function gs(e){const l=1873;let t=Object.keys(e.types).filter(n=>e.types[n].market_group_id==l),i={};try{for(let n of t)i[n]=await Wl(`/universe/types/${n}/`)}catch(n){console.error(n)}return i}const Qi=3388,ks=ei("/industry/systems/"),Es={manufacturing:1,researching_time_efficiency:3,researching_material_efficiency:4,copying:5,invention:8,reaction:11};function Is(e,l,t){var i,n;return(n=(i=e==null?void 0:e.find(s=>{var r;return s.solar_system_id===((r=l==null?void 0:l.solar_system_id)!=null?r:l==null?void 0:l.system_id)}))==null?void 0:i.cost_indices.find(s=>Es[s.activity]==t))==null?void 0:n.cost_index}function Jl(e,l){let t=Object.values(l.types).find(i=>{var n;return(n=i.activities[wt])==null?void 0:n.products[e]});return{type:t,activity:t==null?void 0:t.activities[wt]}}function Gi(e,l){return ri(l,e)!=null||Jl(e,l).activity!=null}class Ts{constructor(l){this.orders={buy:[],sell:[],lastUpdated:null},this.type_id=l}}const si={regions:{10000002:{types:{}}},prices:Ul({},e=>(Wl("/markets/prices/?datasource=tranquility").then(l=>{let t={};l.forEach(i=>{t[i.type_id]=i}),e(t)}).catch(l=>console.error(l)),()=>{}))},bi=si.prices;function Cs(e,l=10000002){return si.regions[l].types[e]===void 0&&(si.regions[l].types[e]=ei(`/markets/${l}/orders/?order_type=all&type_id=${e}`,t=>{let i=new Ts(e);return i.orders.buy=t.filter(n=>n.is_buy_order).sort((n,s)=>s.price-n.price),i.orders.sell=t.filter(n=>!n.is_buy_order).sort((n,s)=>n.price-s.price),i.orders.lastUpdated=new Date().getTime(),i})),si.regions[l].types[e]}const Ds=Ul({attributes:{},types:{}},e=>{let l={},t={};ll("dgmAttributeTypes").then(i=>{i.filter(n=>{var s,r;return n.attributeID!==null&&(((s=n.attributeName)==null?void 0:s.indexOf("Manufacturing Time Bonus"))!=-1||((r=n.attributeName)==null?void 0:r.indexOf("Industry Job Length Bonus"))!=-1)}).forEach(n=>l[n.attributeID]=n)}).then(()=>ll("dgmIndustryTypeAttributes")).then(i=>{i.filter(n=>l[n.attributeID]!==void 0).forEach(n=>{var s;t[n.typeID]=(s=t[n.typeID])!=null?s:{},t[n.typeID][n.attributeID]={type_id:n.typeID,attribute_id:n.attributeID,value:n.valueInt==="None"?n.valueFloat:n.valueInt}}),e({attributes:l,types:t})}).catch(i=>console.error(i))});let yi="en-US";const Je=new Intl.NumberFormat(yi,{useGrouping:!0,maximumFractionDigits:2,minimumFractionDigits:2}).format,ni=new Intl.NumberFormat(yi,{useGrouping:!0,maximumFractionDigits:2,minimumFractionDigits:2,signDisplay:"always"}).format;let vi=new Intl.NumberFormat(yi,{minimumIntegerDigits:2}).format;function ui(e){let l=Math.ceil(e%60),t=Math.floor(e%(60*60)/60),i=Math.floor(e%(24*60*60)/(60*60)),n=Math.floor(e/(24*60*60)),s=`${vi(i)}:${vi(t)}:${vi(l)}`;return n>0&&(s=`${n}d `+s),s}function Yi(e,l,t){const i=e.slice();return i[47]=l[t],i[49]=t,i}function Ji(e){let l,t,i,n,s,r=e[11],u=[];for(let _=0;_<r.length;_+=1)u[_]=zi(Yi(e,r,_));let c=e[9]&&e[9].price!==null&&Xi(e),f=e[10]&&e[10].price!==null&&Ki(e),p=e[6]!==null&&Zi(e),d=e[3]&&$i(e);return{c(){for(let _=0;_<u.length;_+=1)u[_].c();l=Te(),c&&c.c(),t=Te(),f&&f.c(),i=Te(),p&&p.c(),n=Te(),d&&d.c(),s=Te()},l(_){for(let h=0;h<u.length;h+=1)u[h].l(_);l=Te(),c&&c.l(_),t=Te(),f&&f.l(_),i=Te(),p&&p.l(_),n=Te(),d&&d.l(_),s=Te()},m(_,h){for(let m=0;m<u.length;m+=1)u[m].m(_,h);q(_,l,h),c&&c.m(_,h),q(_,t,h),f&&f.m(_,h),q(_,i,h),p&&p.m(_,h),q(_,n,h),d&&d.m(_,h),q(_,s,h)},p(_,h){if(h[0]&6293504){r=_[11];let m;for(m=0;m<r.length;m+=1){const v=Yi(_,r,m);u[m]?u[m].p(v,h):(u[m]=zi(v),u[m].c(),u[m].m(l.parentNode,l))}for(;m<u.length;m+=1)u[m].d(1);u.length=r.length}_[9]&&_[9].price!==null?c?c.p(_,h):(c=Xi(_),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),_[10]&&_[10].price!==null?f?f.p(_,h):(f=Ki(_),f.c(),f.m(i.parentNode,i)):f&&(f.d(1),f=null),_[6]!==null?p?p.p(_,h):(p=Zi(_),p.c(),p.m(n.parentNode,n)):p&&(p.d(1),p=null),_[3]?d?d.p(_,h):(d=$i(_),d.c(),d.m(s.parentNode,s)):d&&(d.d(1),d=null)},d(_){It(u,_),_&&o(l),c&&c.d(_),_&&o(t),f&&f.d(_),_&&o(i),p&&p.d(_),_&&o(n),d&&d.d(_),_&&o(s)}}}function zi(e){let l,t,i,n=[{class:"mark scale"},{style:t=e[21](e[47])},{width:i=1},e[22]],s={};for(let r=0;r<n.length;r+=1)s=Xl(s,n[r]);return{c(){l=Pt("rect"),this.h()},l(r){l=Bt(r,"rect",{class:!0,style:!0,width:!0}),O(l).forEach(o),this.h()},h(){El(l,s),Il(l,"svelte-rhumtt",!0)},m(r,u){q(r,l,u)},p(r,u){El(l,s=Hl(n,[{class:"mark scale"},u[0]&2099200&&t!==(t=r[21](r[47]))&&{style:t},{width:i},u[0]&4194304&&r[22]])),Il(l,"svelte-rhumtt",!0)},d(r){r&&o(l)}}}function Xi(e){let l,t,i,n=e[4]!=0&&Hi(e);return{c(){l=Pt("path"),n&&n.c(),i=Te(),this.h()},l(s){l=Bt(s,"path",{class:!0,d:!0}),O(l).forEach(o),n&&n.l(s),i=Te(),this.h()},h(){var s;T(l,"class","graph buy svelte-rhumtt"),T(l,"d",t=e[24].y(e[23]())([{price:e[9].price,volume_remain:0},...(s=e[16])==null?void 0:s.orders.buy.filter(e[8])]))},m(s,r){q(s,l,r),n&&n.m(s,r),q(s,i,r)},p(s,r){var u;r[0]&25232128&&t!==(t=s[24].y(s[23]())([{price:s[9].price,volume_remain:0},...(u=s[16])==null?void 0:u.orders.buy.filter(s[8])]))&&T(l,"d",t),s[4]!=0?n?n.p(s,r):(n=Hi(s),n.c(),n.m(i.parentNode,i)):n&&(n.d(1),n=null)},d(s){s&&o(l),n&&n.d(s),s&&o(i)}}}function Hi(e){let l,t,i,n=[{class:"overhead buy"},{x:t=e[12](e[9].price*Math.min(1,1+e[4])*e[7])},{width:i=e[12](Math.abs(e[4]*e[9].price*e[7]))},e[22]],s={};for(let r=0;r<n.length;r+=1)s=Xl(s,n[r]);return{c(){l=Pt("rect"),this.h()},l(r){l=Bt(r,"rect",{class:!0,x:!0,width:!0}),O(l).forEach(o),this.h()},h(){El(l,s),Il(l,"svelte-rhumtt",!0)},m(r,u){q(r,l,u)},p(r,u){El(l,s=Hl(n,[{class:"overhead buy"},u[0]&4752&&t!==(t=r[12](r[9].price*Math.min(1,1+r[4])*r[7]))&&{x:t},u[0]&4752&&i!==(i=r[12](Math.abs(r[4]*r[9].price*r[7])))&&{width:i},u[0]&4194304&&r[22]])),Il(l,"svelte-rhumtt",!0)},d(r){r&&o(l)}}}function Ki(e){let l,t,i,n=e[5]!=0&&Wi(e);return{c(){l=Pt("path"),n&&n.c(),i=Te(),this.h()},l(s){l=Bt(s,"path",{class:!0,d:!0}),O(l).forEach(o),n&&n.l(s),i=Te(),this.h()},h(){var s;T(l,"class","graph sell svelte-rhumtt"),T(l,"d",t=e[24].y(e[23]())([{price:e[10].price,volume_remain:0},...(s=e[16])==null?void 0:s.orders.sell.filter(e[8])]))},m(s,r){q(s,l,r),n&&n.m(s,r),q(s,i,r)},p(s,r){var u;r[0]&25232640&&t!==(t=s[24].y(s[23]())([{price:s[10].price,volume_remain:0},...(u=s[16])==null?void 0:u.orders.sell.filter(s[8])]))&&T(l,"d",t),s[5]!=0?n?n.p(s,r):(n=Wi(s),n.c(),n.m(i.parentNode,i)):n&&(n.d(1),n=null)},d(s){s&&o(l),n&&n.d(s),s&&o(i)}}}function Wi(e){let l,t,i,n=[{class:"overhead sell"},{x:t=e[12](e[10].price*Math.min(1,1+e[5])*e[7])},{width:i=e[12](Math.abs(e[5]*e[10].price*e[7]))},e[22]],s={};for(let r=0;r<n.length;r+=1)s=Xl(s,n[r]);return{c(){l=Pt("rect"),this.h()},l(r){l=Bt(r,"rect",{class:!0,x:!0,width:!0}),O(l).forEach(o),this.h()},h(){El(l,s),Il(l,"svelte-rhumtt",!0)},m(r,u){q(r,l,u)},p(r,u){El(l,s=Hl(n,[{class:"overhead sell"},u[0]&5280&&t!==(t=r[12](r[10].price*Math.min(1,1+r[5])*r[7]))&&{x:t},u[0]&5280&&i!==(i=r[12](Math.abs(r[5]*r[10].price*r[7])))&&{width:i},u[0]&4194304&&r[22]])),Il(l,"svelte-rhumtt",!0)},d(r){r&&o(l)}}}function Zi(e){let l,t,i,n=e[1]!=0&&xi(e);return{c(){l=Pt("rect"),n&&n.c(),i=Te(),this.h()},l(s){l=Bt(s,"rect",{class:!0,x:!0,width:!0,height:!0}),O(l).forEach(o),n&&n.l(s),i=Te(),this.h()},h(){T(l,"class","mark cost svelte-rhumtt"),T(l,"x",t=e[12](e[6])),T(l,"width",1),T(l,"height",e[2])},m(s,r){q(s,l,r),n&&n.m(s,r),q(s,i,r)},p(s,r){r[0]&4160&&t!==(t=s[12](s[6]))&&T(l,"x",t),r[0]&4&&T(l,"height",s[2]),s[1]!=0?n?n.p(s,r):(n=xi(s),n.c(),n.m(i.parentNode,i)):n&&(n.d(1),n=null)},d(s){s&&o(l),n&&n.d(s),s&&o(i)}}}function xi(e){let l,t,i,n,s;return{c(){l=Pt("rect"),this.h()},l(r){l=Bt(r,"rect",{class:!0,x:!0,width:!0,y:!0,height:!0}),O(l).forEach(o),this.h()},h(){T(l,"class",t=""+(Kl(`difference profit ${e[13]>e[1]?"negative":"positive"}`)+" svelte-rhumtt")),T(l,"x",i=Math.min(e[12](e[6]),e[12](e[1]*e[7]))),T(l,"width",n=Math.abs(e[12](e[6])-e[12](e[1]*e[7]))),T(l,"y",s=e[14](.5)),T(l,"height",1)},m(r,u){q(r,l,u)},p(r,u){u[0]&8194&&t!==(t=""+(Kl(`difference profit ${r[13]>r[1]?"negative":"positive"}`)+" svelte-rhumtt"))&&T(l,"class",t),u[0]&4290&&i!==(i=Math.min(r[12](r[6]),r[12](r[1]*r[7])))&&T(l,"x",i),u[0]&4290&&n!==(n=Math.abs(r[12](r[6])-r[12](r[1]*r[7])))&&T(l,"width",n),u[0]&16384&&s!==(s=r[14](.5))&&T(l,"y",s)},d(r){r&&o(l)}}}function $i(e){let l,t,i;return{c(){l=Pt("circle"),this.h()},l(n){l=Bt(n,"circle",{class:!0,cx:!0,cy:!0,r:!0}),O(l).forEach(o),this.h()},h(){T(l,"class","mark price svelte-rhumtt"),T(l,"cx",t=e[12](e[1]*e[7])),T(l,"cy",i=e[14](.5)),T(l,"r",2)},m(n,s){q(n,l,s)},p(n,s){s[0]&4226&&t!==(t=n[12](n[1]*n[7]))&&T(l,"cx",t),s[0]&16384&&i!==(i=n[14](.5))&&T(l,"cy",i)},d(n){n&&o(l)}}}function er(e){let l,t=Je(e[19]*e[7])+"",i,n,s=Je(e[19])+"",r,u,c,f,p,d,_,h,m;return{c(){l=Pt("text"),i=B(t),n=B(" @"),r=B(s),p=Pt("circle"),this.h()},l(v){l=Bt(v,"text",{class:!0,style:!0,y:!0,dy:!0,"text-anchor":!0});var k=O(l);i=w(k,t),n=w(k," @"),r=w(k,s),k.forEach(o),p=Bt(v,"circle",{class:!0,style:!0,cx:!0,cy:!0,r:!0}),O(p).forEach(o),this.h()},h(){T(l,"class","hover svelte-rhumtt"),T(l,"style",u=e[21](e[19]*e[7])),T(l,"y",c=e[14](0)),T(l,"dy",f=8),T(l,"text-anchor","middle"),T(p,"class","hover svelte-rhumtt"),T(p,"style",d=e[21](e[19]*e[7])),T(p,"cx",_=0),T(p,"cy",h=e[14](.5)),T(p,"r",m=4)},m(v,k){q(v,l,k),a(l,i),a(l,n),a(l,r),q(v,p,k)},p(v,k){k[0]&524416&&t!==(t=Je(v[19]*v[7])+"")&&Z(i,t),k[0]&524288&&s!==(s=Je(v[19])+"")&&Z(r,s),k[0]&2621568&&u!==(u=v[21](v[19]*v[7]))&&T(l,"style",u),k[0]&16384&&c!==(c=v[14](0))&&T(l,"y",c),k[0]&2621568&&d!==(d=v[21](v[19]*v[7]))&&T(p,"style",d),k[0]&16384&&h!==(h=v[14](.5))&&T(p,"cy",h)},d(v){v&&o(l),v&&o(p)}}}function Rs(e){let l,t,i,n,s,r,u,c,f,p=[{class:"graphArea"},{width:e[0]},e[22]],d={};for(let m=0;m<p.length;m+=1)d=Xl(d,p[m]);let _=e[17]&&Ji(e),h=e[18]&&er(e);return{c(){l=Pt("svg"),t=Pt("rect"),_&&_.c(),i=Te(),h&&h.c(),n=Pt("rect"),this.h()},l(m){l=Bt(m,"svg",{height:!0,viewBox:!0,xmlns:!0,class:!0});var v=O(l);t=Bt(v,"rect",{class:!0,width:!0}),O(t).forEach(o),_&&_.l(v),i=Te(),h&&h.l(v),n=Bt(v,"rect",{class:!0,width:!0,y:!0,height:!0}),O(n).forEach(o),v.forEach(o),this.h()},h(){El(t,d),Il(t,"svelte-rhumtt",!0),T(n,"class","hitArea svelte-rhumtt"),T(n,"width",e[0]),T(n,"y",s=e[14](1)),T(n,"height",r=e[14](0)-e[14](1)),T(l,"height",e[2]),T(l,"viewBox",u=`0 0 ${e[0]} ${e[2]}`),T(l,"xmlns","http://www.w3.org/2000/svg"),T(l,"class","svelte-rhumtt")},m(m,v){q(m,l,v),a(l,t),_&&_.m(l,null),a(l,i),h&&h.m(l,null),a(l,n),e[41](l),c||(f=[ye(n,"mouseenter",e[39]),ye(n,"mouseleave",e[40]),ye(n,"mousemove",e[26]),ye(n,"click",e[27])],c=!0)},p(m,v){El(t,d=Hl(p,[{class:"graphArea"},v[0]&1&&{width:m[0]},v[0]&4194304&&m[22]])),Il(t,"svelte-rhumtt",!0),m[17]?_?_.p(m,v):(_=Ji(m),_.c(),_.m(l,i)):_&&(_.d(1),_=null),m[18]?h?h.p(m,v):(h=er(m),h.c(),h.m(l,n)):h&&(h.d(1),h=null),v[0]&1&&T(n,"width",m[0]),v[0]&16384&&s!==(s=m[14](1))&&T(n,"y",s),v[0]&16384&&r!==(r=m[14](0)-m[14](1))&&T(n,"height",r),v[0]&4&&T(l,"height",m[2]),v[0]&5&&u!==(u=`0 0 ${m[0]} ${m[2]}`)&&T(l,"viewBox",u)},i:Se,o:Se,d(m){m&&o(l),_&&_.d(),h&&h.d(),e[41](null),c=!1,Ql(f)}}}let gi=8;function Ms(e,l,t){let i,n,s,r,u,c,f,p,d,_,h,m=Se,v=()=>(m(),m=Ol(i,K=>t(16,h=K)),i),k;e.$$.on_destroy.push(()=>m());let{compact:S=!1}=l,{height:y=S?24:40}=l,{width:P=500}=l,{extents:D=[0,1e3]}=l,{type_id:N=null}=l,M=Vl("marketFilterLocation");Ke(e,M,K=>t(38,k=K));let b=()=>!0;function R(K,A){return K?A?K.filter(b)[0]:K[0]:null}let{buyOverheadRate:G=0}=l,{sellOverheadRate:F=0}=l,W=null,j=null,{lowestSellPrice:L=0}=l,{highestBuyPrice:V=0}=l,{price:X=null}=l,{overridePrice:Y=null}=l,le=null,ee=null,{totalCost:ne=null}=l,{quantity:_e=1}=l,ve=S?[0,y-gi]:[gi,y-2*gi],me=!1,Re=[],he=!1,ce=[],Me=0,re=0;function se(K){var $;let A=K.clientX-K.target.getBoundingClientRect().left;re=Wr(ce,ue=>Math.abs(ue.price*_e-r.invert(A))/_e),t(19,Me=($=ce[re])==null?void 0:$.price)}function ze(K){var A;((A=ce[re])==null?void 0:A.is_buy_order)!==void 0&&(t(33,le=Me),t(33,le*=1+(ce[re].is_buy_order?G:F)))}function Xe(K){t(0,P=ge.getBoundingClientRect().width)}let ge;Si(()=>{t(0,P=ge.getBoundingClientRect().width),window.addEventListener("resize",Xe)}),ci(()=>{window.removeEventListener("resize",Xe)});const pe=K=>t(18,he=!0),oe=K=>t(18,he=!1);function rt(K){De[K?"unshift":"push"](()=>{ge=K,t(20,ge)})}return e.$$set=K=>{"compact"in K&&t(30,S=K.compact),"height"in K&&t(2,y=K.height),"width"in K&&t(0,P=K.width),"extents"in K&&t(31,D=K.extents),"type_id"in K&&t(3,N=K.type_id),"buyOverheadRate"in K&&t(4,G=K.buyOverheadRate),"sellOverheadRate"in K&&t(5,F=K.sellOverheadRate),"lowestSellPrice"in K&&t(28,L=K.lowestSellPrice),"highestBuyPrice"in K&&t(29,V=K.highestBuyPrice),"price"in K&&t(1,X=K.price),"overridePrice"in K&&t(32,Y=K.overridePrice),"totalCost"in K&&t(6,ne=K.totalCost),"quantity"in K&&t(7,_e=K.quantity)},e.$$.update=()=>{var K,A,$;if(e.$$.dirty[0]&8&&v(t(15,i=N&&Cs(N))),e.$$.dirty[1]&128&&t(8,b=ue=>k?ue.location_id===k:!0),e.$$.dirty[0]&65536|e.$$.dirty[1]&128&&(t(9,W=R(h==null?void 0:h.orders.buy,k)),t(10,j=R(h==null?void 0:h.orders.sell,k))),e.$$.dirty[0]&1536&&(t(28,L=j==null?void 0:j.price),t(29,V=W==null?void 0:W.price)),e.$$.dirty[0]&98304&&((h==null?void 0:h.orders)?i==null||i.status:pi.loading),e.$$.dirty[0]&1056&&t(37,n=(j==null?void 0:j.price)*(1+F)),e.$$.dirty[0]&8|e.$$.dirty[1]&8&&ee!==N&&(t(33,le=null),t(34,ee=N)),e.$$.dirty[0]&2|e.$$.dirty[1]&70&&(t(1,X=(K=Y!=null?Y:le)!=null?K:n),isNaN(X)&&t(1,X=0)),e.$$.dirty[0]&192&&t(13,s=ne/_e),e.$$.dirty[0]&1|e.$$.dirty[1]&1&&t(12,r=di().domain([D[0],D[1]]).range([0,P])),e.$$.dirty[0]&128&&t(36,c=di().domain([_e*2,0]).range(ve)),e.$$.dirty[0]&4224&&t(24,f=Hr().curve(Kr).x(ue=>r(ue.price*_e))),e.$$.dirty[1]&32&&t(23,p=()=>{let ue=0;return Ne=>(ue+=Ne.volume_remain,c(ue))}),e.$$.dirty[0]&2048|e.$$.dirty[1]&1){t(17,me=D[1]>D[0]),t(11,Re=[]);let ue=10;for(let Ne=1e6;Ne<D[1];Ne*=ue)Re.push(Ne)}e.$$.dirty[0]&16384&&t(22,d={y:u(1),height:Math.abs(u(0)-u(1))}),e.$$.dirty[0]&4096&&t(21,_=ue=>`transform: translateX(${r(ue)}px)`),e.$$.dirty[0]&74048|e.$$.dirty[1]&16&&(h&&h.orders?t(35,ce=($=h==null?void 0:h.orders)==null?void 0:$.buy.concat((A=h==null?void 0:h.orders)==null?void 0:A.sell).filter(b)):t(35,ce=[]),ne&&t(35,ce=[...ce,{price:s}]))},t(14,u=di().domain([1,0]).range(ve)),[P,X,y,N,G,F,ne,_e,b,W,j,Re,r,s,u,i,h,me,he,Me,ge,_,d,p,f,M,se,ze,L,V,S,D,Y,le,ee,ce,c,n,k,pe,oe,rt]}class il extends vl{constructor(l){super();gl(this,l,Ms,Rs,kl,{compact:30,height:2,width:0,extents:31,type_id:3,buyOverheadRate:4,sellOverheadRate:5,lowestSellPrice:28,highestBuyPrice:29,price:1,overridePrice:32,totalCost:6,quantity:7},null,[-1,-1])}}function Ps(e,l){return e.reduce((t,i)=>t+(l?l(i):i),0)}function tr(e,l,t){const i=e.slice();return i[27]=l[t],i}function lr(e,l,t){const i=e.slice();return i[27]=l[t],i}function ir(e,l,t){const i=e.slice();return i[27]=l[t],i}function rr(e,l,t){const i=e.slice();return i[34]=l[t],i}function sr(e){let l,t;return{c(){l=E("option"),this.h()},l(i){l=I(i,"OPTION",{}),O(l).forEach(o),this.h()},h(){l.__value=t=null,l.value=l.__value},m(i,n){q(i,l,n)},d(i){i&&o(l)}}}function nr(e){var s;let l,t=((s=e[34].name)!=null?s:e[34].location_id)+"",i,n;return{c(){l=E("option"),i=B(t),this.h()},l(r){l=I(r,"OPTION",{});var u=O(l);i=w(u,t),u.forEach(o),this.h()},h(){l.__value=n=e[34].location_id,l.value=l.__value},m(r,u){q(r,l,u),a(l,i)},p(r,u){var c;u[0]&1024&&t!==(t=((c=r[34].name)!=null?c:r[34].location_id)+"")&&Z(i,t),u[0]&1024&&n!==(n=r[34].location_id)&&(l.__value=n,l.value=l.__value)},d(r){r&&o(l)}}}function ur(e){let l,t,i,n,s,r=e[1]*100+"",u,c,f,p,d=e[9].activityName+"",_,h,m,v,k=e[8]&&or(e);return{c(){l=E("div"),t=E("dl"),i=E("dt"),n=B("System cost index"),s=E("dd"),u=B(r),c=B("%"),f=E("dt"),p=B("Tax for "),_=B(d),h=E("dd"),m=B(e[3]),v=B("%"),k&&k.c(),this.h()},l(S){l=I(S,"DIV",{class:!0});var y=O(l);t=I(y,"DL",{});var P=O(t);i=I(P,"DT",{});var D=O(i);n=w(D,"System cost index"),D.forEach(o),s=I(P,"DD",{});var N=O(s);u=w(N,r),c=w(N,"%"),N.forEach(o),f=I(P,"DT",{});var M=O(f);p=w(M,"Tax for "),_=w(M,d),M.forEach(o),h=I(P,"DD",{});var b=O(h);m=w(b,e[3]),v=w(b,"%"),b.forEach(o),k&&k.l(P),P.forEach(o),y.forEach(o),this.h()},h(){T(l,"class","overlay")},m(S,y){q(S,l,y),a(l,t),a(t,i),a(i,n),a(t,s),a(s,u),a(s,c),a(t,f),a(f,p),a(f,_),a(t,h),a(h,m),a(h,v),k&&k.m(t,null)},p(S,y){y[0]&2&&r!==(r=S[1]*100+"")&&Z(u,r),y[0]&512&&d!==(d=S[9].activityName+"")&&Z(_,d),y[0]&8&&Z(m,S[3]),S[8]?k?k.p(S,y):(k=or(S),k.c(),k.m(t,null)):k&&(k.d(1),k=null)},d(S){S&&o(l),k&&k.d()}}}function or(e){let l,t,i,n,s=e[2].materialConsumptionModifier+"",r,u,c=e[2].jobCostModifier+"",f,p,d=e[2].jobDurationModifier+"",_,h,m,v,k,S,y,P=e[4].timeReductionBonus+"",D,N,M=(e[7]===pt||e[7]===wt)&&ar(e),b=e[7]!==pt&&e[7]!==wt&&fr(e);return{c(){l=E("dt"),t=B("Structure role bonuses"),i=E("dd"),n=B("ME "),r=B(s),u=B("% | Cost "),f=B(c),p=B("% | TE "),_=B(d),h=B("%"),m=E("dt"),v=B("Structure rig bonuses"),k=E("dd"),M&&M.c(),S=J(),b&&b.c(),y=B(`\r
                | TE `),D=B(P),N=B("%"),this.h()},l(R){l=I(R,"DT",{class:!0});var G=O(l);t=w(G,"Structure role bonuses"),G.forEach(o),i=I(R,"DD",{class:!0});var F=O(i);n=w(F,"ME "),r=w(F,s),u=w(F,"% | Cost "),f=w(F,c),p=w(F,"% | TE "),_=w(F,d),h=w(F,"%"),F.forEach(o),m=I(R,"DT",{class:!0});var W=O(m);v=w(W,"Structure rig bonuses"),W.forEach(o),k=I(R,"DD",{class:!0});var j=O(k);M&&M.l(j),S=z(j),b&&b.l(j),y=w(j,`\r
                | TE `),D=w(j,P),N=w(j,"%"),j.forEach(o),this.h()},h(){T(l,"class","full-width"),T(i,"class","full-width"),T(m,"class","full-width"),T(k,"class","full-width")},m(R,G){q(R,l,G),a(l,t),q(R,i,G),a(i,n),a(i,r),a(i,u),a(i,f),a(i,p),a(i,_),a(i,h),q(R,m,G),a(m,v),q(R,k,G),M&&M.m(k,null),a(k,S),b&&b.m(k,null),a(k,y),a(k,D),a(k,N)},p(R,G){G[0]&4&&s!==(s=R[2].materialConsumptionModifier+"")&&Z(r,s),G[0]&4&&c!==(c=R[2].jobCostModifier+"")&&Z(f,c),G[0]&4&&d!==(d=R[2].jobDurationModifier+"")&&Z(_,d),R[7]===pt||R[7]===wt?M?M.p(R,G):(M=ar(R),M.c(),M.m(k,S)):M&&(M.d(1),M=null),R[7]!==pt&&R[7]!==wt?b?b.p(R,G):(b=fr(R),b.c(),b.m(k,y)):b&&(b.d(1),b=null),G[0]&16&&P!==(P=R[4].timeReductionBonus+"")&&Z(D,P)},d(R){R&&o(l),R&&o(i),R&&o(m),R&&o(k),M&&M.d(),b&&b.d()}}}function ar(e){let l,t=e[4].materialReductionBonus+"",i,n;return{c(){l=B("ME "),i=B(t),n=B("%")},l(s){l=w(s,"ME "),i=w(s,t),n=w(s,"%")},m(s,r){q(s,l,r),q(s,i,r),q(s,n,r)},p(s,r){r[0]&16&&t!==(t=s[4].materialReductionBonus+"")&&Z(i,t)},d(s){s&&o(l),s&&o(i),s&&o(n)}}}function fr(e){let l,t=e[4].costReductionBonus+"",i,n;return{c(){l=B("Cost "),i=B(t),n=B("%")},l(s){l=w(s,"Cost "),i=w(s,t),n=w(s,"%")},m(s,r){q(s,l,r),q(s,i,r),q(s,n,r)},p(s,r){r[0]&16&&t!==(t=s[4].costReductionBonus+"")&&Z(i,t)},d(s){s&&o(l),s&&o(i),s&&o(n)}}}function _r(e){let l,t,i,n,s=e[1]*100+"",r,u,c,f,p=e[9].activityName+"",d,_,h,m,v,k,S,y,P,D,N,M=e[8]&&cr(e);return{c(){l=E("dl"),t=E("dt"),i=B("System cost index"),n=E("dd"),r=B(s),u=B("%"),c=E("dt"),f=B("Tax for "),d=B(p),_=E("dd"),h=E("input"),y=J(),P=B(e[3]),M&&M.c(),this.h()},l(b){l=I(b,"DL",{});var R=O(l);t=I(R,"DT",{});var G=O(t);i=w(G,"System cost index"),G.forEach(o),n=I(R,"DD",{});var F=O(n);r=w(F,s),u=w(F,"%"),F.forEach(o),c=I(R,"DT",{});var W=O(c);f=w(W,"Tax for "),d=w(W,p),W.forEach(o),_=I(R,"DD",{});var j=O(_);h=I(j,"INPUT",{type:!0,min:!0,max:!0,step:!0}),y=z(j),P=w(j,e[3]),j.forEach(o),M&&M.l(R),R.forEach(o),this.h()},h(){T(h,"type","range"),T(h,"min",m=0),T(h,"max",v=15),T(h,"step",k=.5),h.value=e[3],h.disabled=S=$l(e[0])},m(b,R){q(b,l,R),a(l,t),a(t,i),a(l,n),a(n,r),a(n,u),a(l,c),a(c,f),a(c,d),a(l,_),a(_,h),a(_,y),a(_,P),M&&M.m(l,null),D||(N=ye(h,"input",e[12]),D=!0)},p(b,R){R[0]&2&&s!==(s=b[1]*100+"")&&Z(r,s),R[0]&512&&p!==(p=b[9].activityName+"")&&Z(d,p),R[0]&8&&(h.value=b[3]),R[0]&1025&&S!==(S=$l(b[0]))&&(h.disabled=S),R[0]&8&&Z(P,b[3]),b[8]?M?M.p(b,R):(M=cr(b),M.c(),M.m(l,null)):M&&(M.d(1),M=null)},d(b){b&&o(l),M&&M.d(),D=!1,N()}}}function cr(e){let l,t,i,n,s=e[2].materialConsumptionModifier+"",r,u,c=e[2].jobCostModifier+"",f,p,d=e[2].jobDurationModifier+"",_,h,m,v,k,S,y=(e[7]===pt||e[7]===wt)&&dr(e),P=e[7]!==pt&&e[7]!==wt&&pr(e),D=e[14],N=[];for(let M=0;M<D.length;M+=1)N[M]=br(tr(e,D,M));return{c(){l=E("dt"),t=B("Structure role bonuses"),i=E("dd"),n=B("ME "),r=B(s),u=B("% | Cost "),f=B(c),p=B("% | TE "),_=B(d),h=B("%"),y&&y.c(),m=Te(),P&&P.c(),v=E("dt"),k=B("Structure rig duration bonus"),S=E("dd");for(let M=0;M<N.length;M+=1)N[M].c()},l(M){l=I(M,"DT",{});var b=O(l);t=w(b,"Structure role bonuses"),b.forEach(o),i=I(M,"DD",{});var R=O(i);n=w(R,"ME "),r=w(R,s),u=w(R,"% | Cost "),f=w(R,c),p=w(R,"% | TE "),_=w(R,d),h=w(R,"%"),R.forEach(o),y&&y.l(M),m=Te(),P&&P.l(M),v=I(M,"DT",{});var G=O(v);k=w(G,"Structure rig duration bonus"),G.forEach(o),S=I(M,"DD",{});var F=O(S);for(let W=0;W<N.length;W+=1)N[W].l(F);F.forEach(o)},m(M,b){q(M,l,b),a(l,t),q(M,i,b),a(i,n),a(i,r),a(i,u),a(i,f),a(i,p),a(i,_),a(i,h),y&&y.m(M,b),q(M,m,b),P&&P.m(M,b),q(M,v,b),a(v,k),q(M,S,b);for(let R=0;R<N.length;R+=1)N[R].m(S,null)},p(M,b){if(b[0]&4&&s!==(s=M[2].materialConsumptionModifier+"")&&Z(r,s),b[0]&4&&c!==(c=M[2].jobCostModifier+"")&&Z(f,c),b[0]&4&&d!==(d=M[2].jobDurationModifier+"")&&Z(_,d),M[7]===pt||M[7]===wt?y?y.p(M,b):(y=dr(M),y.c(),y.m(m.parentNode,m)):y&&(y.d(1),y=null),M[7]!==pt&&M[7]!==wt?P?P.p(M,b):(P=pr(M),P.c(),P.m(v.parentNode,v)):P&&(P.d(1),P=null),b[0]&16400){D=M[14];let R;for(R=0;R<D.length;R+=1){const G=tr(M,D,R);N[R]?N[R].p(G,b):(N[R]=br(G),N[R].c(),N[R].m(S,null))}for(;R<N.length;R+=1)N[R].d(1);N.length=D.length}},d(M){M&&o(l),M&&o(i),y&&y.d(M),M&&o(m),P&&P.d(M),M&&o(v),M&&o(S),It(N,M)}}}function dr(e){let l,t,i,n,s=e[13],r=[];for(let u=0;u<s.length;u+=1)r[u]=hr(ir(e,s,u));return{c(){l=E("dt"),t=B("Structure rig material bonus"),i=E("dd");for(let u=0;u<r.length;u+=1)r[u].c();n=J()},l(u){l=I(u,"DT",{});var c=O(l);t=w(c,"Structure rig material bonus"),c.forEach(o),i=I(u,"DD",{});var f=O(i);for(let p=0;p<r.length;p+=1)r[p].l(f);n=z(f),f.forEach(o)},m(u,c){q(u,l,c),a(l,t),q(u,i,c);for(let f=0;f<r.length;f+=1)r[f].m(i,null);a(i,n)},p(u,c){if(c[0]&8208){s=u[13];let f;for(f=0;f<s.length;f+=1){const p=ir(u,s,f);r[f]?r[f].p(p,c):(r[f]=hr(p),r[f].c(),r[f].m(i,n))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}},d(u){u&&o(l),u&&o(i),It(r,u)}}}function hr(e){let l,t,i,n=e[27]+"",s,r,u,c;return{c(){l=E("label"),t=E("input"),i=J(),s=B(n),r=B("%"),this.h()},l(f){l=I(f,"LABEL",{});var p=O(l);t=I(p,"INPUT",{type:!0,name:!0}),i=z(p),s=w(p,n),r=w(p,"%"),p.forEach(o),this.h()},h(){T(t,"type","radio"),T(t,"name","MEBonus"),t.__value=e[27],t.value=t.__value,e[24][0].push(t)},m(f,p){q(f,l,p),a(l,t),t.checked=t.__value===e[4].materialReductionBonus,a(l,i),a(l,s),a(l,r),u||(c=ye(t,"change",e[23]),u=!0)},p(f,p){p[0]&16&&(t.checked=t.__value===f[4].materialReductionBonus)},d(f){f&&o(l),e[24][0].splice(e[24][0].indexOf(t),1),u=!1,c()}}}function pr(e){let l,t,i,n,s=e[15],r=[];for(let u=0;u<s.length;u+=1)r[u]=mr(lr(e,s,u));return{c(){l=E("dt"),t=B("Structure rig cost bonus"),i=E("dd");for(let u=0;u<r.length;u+=1)r[u].c();n=J()},l(u){l=I(u,"DT",{});var c=O(l);t=w(c,"Structure rig cost bonus"),c.forEach(o),i=I(u,"DD",{});var f=O(i);for(let p=0;p<r.length;p+=1)r[p].l(f);n=z(f),f.forEach(o)},m(u,c){q(u,l,c),a(l,t),q(u,i,c);for(let f=0;f<r.length;f+=1)r[f].m(i,null);a(i,n)},p(u,c){if(c[0]&32784){s=u[15];let f;for(f=0;f<s.length;f+=1){const p=lr(u,s,f);r[f]?r[f].p(p,c):(r[f]=mr(p),r[f].c(),r[f].m(i,n))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}},d(u){u&&o(l),u&&o(i),It(r,u)}}}function mr(e){let l,t,i,n=e[27]+"",s,r,u,c;return{c(){l=E("label"),t=E("input"),i=J(),s=B(n),r=B("%"),this.h()},l(f){l=I(f,"LABEL",{});var p=O(l);t=I(p,"INPUT",{type:!0,name:!0}),i=z(p),s=w(p,n),r=w(p,"%"),p.forEach(o),this.h()},h(){T(t,"type","radio"),T(t,"name","CostBonus"),t.__value=e[27],t.value=t.__value,e[24][1].push(t)},m(f,p){q(f,l,p),a(l,t),t.checked=t.__value===e[4].costReductionBonus,a(l,i),a(l,s),a(l,r),u||(c=ye(t,"change",e[25]),u=!0)},p(f,p){p[0]&16&&(t.checked=t.__value===f[4].costReductionBonus)},d(f){f&&o(l),e[24][1].splice(e[24][1].indexOf(t),1),u=!1,c()}}}function br(e){let l,t,i,n=e[27]+"",s,r,u,c;return{c(){l=E("label"),t=E("input"),i=J(),s=B(n),r=B("%"),this.h()},l(f){l=I(f,"LABEL",{});var p=O(l);t=I(p,"INPUT",{type:!0,name:!0}),i=z(p),s=w(p,n),r=w(p,"%"),p.forEach(o),this.h()},h(){T(t,"type","radio"),T(t,"name","TEBonus"),t.__value=e[27],t.value=t.__value,e[24][2].push(t)},m(f,p){q(f,l,p),a(l,t),t.checked=t.__value===e[4].timeReductionBonus,a(l,i),a(l,s),a(l,r),u||(c=ye(t,"change",e[26]),u=!0)},p(f,p){p[0]&16&&(t.checked=t.__value===f[4].timeReductionBonus)},d(f){f&&o(l),e[24][2].splice(e[24][2].indexOf(t),1),u=!1,c()}}}function Bs(e){let l,t,i,n,s,r=(e[5]?"+":"-")+"",u,c,f,p,d,_,h=e[6]&&sr(),m=e[10],v=[];for(let y=0;y<m.length;y+=1)v[y]=nr(rr(e,m,y));let k=e[9]&&e[5]&&ur(e),S=e[9]&&!e[5]&&_r(e);return{c(){l=E("span"),t=E("select"),h&&h.c(),i=Te();for(let y=0;y<v.length;y+=1)v[y].c();n=J(),s=E("button"),u=B(r),c=J(),k&&k.c(),f=J(),S&&S.c(),p=Te(),this.h()},l(y){l=I(y,"SPAN",{class:!0});var P=O(l);t=I(P,"SELECT",{class:!0});var D=O(t);h&&h.l(D),i=Te();for(let M=0;M<v.length;M+=1)v[M].l(D);D.forEach(o),n=z(P),s=I(P,"BUTTON",{});var N=O(s);u=w(N,r),N.forEach(o),c=z(P),k&&k.l(P),P.forEach(o),f=z(y),S&&S.l(y),p=Te(),this.h()},h(){T(t,"class","svelte-1kq2d5g"),e[0]===void 0&&Fl(()=>e[21].call(t)),T(l,"class","overlay-parent svelte-1kq2d5g")},m(y,P){q(y,l,P),a(l,t),h&&h.m(t,null),a(t,i);for(let D=0;D<v.length;D+=1)v[D].m(t,null);Ut(t,e[0]),a(l,n),a(l,s),a(s,u),a(l,c),k&&k.m(l,null),q(y,f,P),S&&S.m(y,P),q(y,p,P),d||(_=[ye(t,"change",e[21]),ye(s,"click",e[22])],d=!0)},p(y,P){if(y[6]?h||(h=sr(),h.c(),h.m(t,i)):h&&(h.d(1),h=null),P[0]&1024){m=y[10];let D;for(D=0;D<m.length;D+=1){const N=rr(y,m,D);v[D]?v[D].p(N,P):(v[D]=nr(N),v[D].c(),v[D].m(t,null))}for(;D<v.length;D+=1)v[D].d(1);v.length=m.length}P[0]&1025&&Ut(t,y[0]),P[0]&32&&r!==(r=(y[5]?"+":"-")+"")&&Z(u,r),y[9]&&y[5]?k?k.p(y,P):(k=ur(y),k.c(),k.m(l,null)):k&&(k.d(1),k=null),y[9]&&!y[5]?S?S.p(y,P):(S=_r(y),S.c(),S.m(p.parentNode,p)):S&&(S.d(1),S=null)},i:Se,o:Se,d(y){y&&o(l),h&&h.d(),It(v,y),k&&k.d(),y&&o(f),S&&S.d(y),y&&o(p),d=!1,Ql(_)}}}const ki=.01,ws=35825,Os=35826,qs=35827,yr=10;function js(e,l,t){let i,n,s,r,u=Se,c=()=>(u(),u=Ol(i,Y=>t(17,r=Y)),i),f,p,d;Ke(e,Li,Y=>t(18,f=Y)),Ke(e,ks,Y=>t(19,p=Y)),Ke(e,Yl,Y=>t(20,d=Y)),e.$$.on_destroy.push(()=>u());let{value:_=null}=l,{allowUnselected:h=!1}=l,{selectedLocation:m=null}=l,{activity:v=null}=l,{activitySystemCostIndex:k=ki}=l,{structureRoleBonuses:S=null}=l,{activityTax:y=yr}=l;function P(Y){let le={};le[_]={},le[_][v]=parseFloat(Y.target.value),Li.update(le)}const D=[0,-2,-2.4],N=[0,-20,-24],M=[0,-10,-12];let{structureRigBonuses:b=null}=l,{collapsed:R=!0}=l,G=[];const F=[[],[],[]];function W(){_=Al(this),t(0,_),t(6,h),t(17,r),t(10,G),t(17,r)}const j=()=>{t(5,R=!R)};function L(){b.materialReductionBonus=this.__value,t(4,b),t(8,s),t(16,m),t(0,_),t(17,r),t(6,h)}function V(){b.costReductionBonus=this.__value,t(4,b),t(8,s),t(16,m),t(0,_),t(17,r),t(6,h)}function X(){b.timeReductionBonus=this.__value,t(4,b),t(8,s),t(16,m),t(0,_),t(17,r),t(6,h)}return e.$$set=Y=>{"value"in Y&&t(0,_=Y.value),"allowUnselected"in Y&&t(6,h=Y.allowUnselected),"selectedLocation"in Y&&t(16,m=Y.selectedLocation),"activity"in Y&&t(7,v=Y.activity),"activitySystemCostIndex"in Y&&t(1,k=Y.activitySystemCostIndex),"structureRoleBonuses"in Y&&t(2,S=Y.structureRoleBonuses),"activityTax"in Y&&t(3,y=Y.activityTax),"structureRigBonuses"in Y&&t(4,b=Y.structureRigBonuses),"collapsed"in Y&&t(5,R=Y.collapsed)},e.$$.update=()=>{var Y;if(e.$$.dirty[0]&131137&&!h&&_==null&&Object.keys(r).length>0&&t(0,_=parseInt(Object.keys(r)[0])),e.$$.dirty[0]&131073&&t(16,m=r[_]),e.$$.dirty[0]&1048704&&t(9,n=d.activities[v]),e.$$.dirty[0]&590464&&(n?t(1,k=(Y=Is(p,m,v))!=null?Y:ki):t(1,k=ki)),e.$$.dirty[0]&65537&&t(8,s=m&&!$l(_)),e.$$.dirty[0]&65920)if(s)switch(m.type_id){case ws:t(2,S={jobDurationModifier:-15,materialConsumptionModifier:0,jobCostModifier:-3}),(v===pt||v===wt)&&t(2,S.materialConsumptionModifier=-1,S);break;case Os:t(2,S={jobDurationModifier:-20,materialConsumptionModifier:0,jobCostModifier:-4}),(v===pt||v===wt)&&t(2,S.materialConsumptionModifier=-1,S);break;case qs:t(2,S={jobDurationModifier:-30,materialConsumptionModifier:0,jobCostModifier:-5}),(v===pt||v===wt)&&t(2,S.materialConsumptionModifier=-1,S);break;default:t(2,S=null)}else t(2,S=null);e.$$.dirty[0]&262529&&(s&&f[_]&&f[_][v]!==void 0?t(3,y=f[_][v]):t(3,y=yr)),e.$$.dirty[0]&256&&(s?t(4,b={materialReductionBonus:-2,timeReductionBonus:0,costReductionBonus:0}):t(4,b=null)),e.$$.dirty[0]&131072&&t(10,G=Object.keys(r).map(le=>{var ee;return{location_id:parseInt(le),name:(ee=r[le])==null?void 0:ee.name}}).sort((le,ee)=>le.name&&ee.name?le.name.localeCompare(ee.name):0))},c(t(11,i=Vl("locations"))),[_,k,S,y,b,R,h,v,s,n,G,i,P,D,N,M,m,r,f,p,d,W,j,L,F,V,X]}class Ei extends vl{constructor(l){super();gl(this,l,js,Bs,kl,{value:0,allowUnselected:6,selectedLocation:16,activity:7,activitySystemCostIndex:1,structureRoleBonuses:2,activityTax:3,structureRigBonuses:4,collapsed:5},null,[-1,-1])}}function vr(e,l,t){const i=e.slice();return i[58]=l[t],i}function gr(e,l,t){const i=e.slice();return i[61]=l[t],i}function kr(e,l,t){const i=e.slice();return i[64]=l[t],i[65]=l,i[66]=t,i}function Er(e){var k,S;let l,t=e[28].types[e[64]].name+"",i,n,s,r,u=((k=e[25].materials[e[64]])==null?void 0:k.quantity)+"",c,f,p,d,_,h;function m(y){e[51](y,e[64])}let v={compact:!0,extents:e[29],quantity:(S=e[25].materials[e[64]])==null?void 0:S.quantity,type_id:e[64],buyOverheadRate:e[1]};return e[5][e[64]]!==void 0&&(v.price=e[5][e[64]]),d=new il({props:v}),De.push(()=>Be(d,"price",m)),{c(){l=E("div"),i=B(t),s=J(),r=E("div"),c=B(u),f=J(),p=E("div"),et(d.$$.fragment),this.h()},l(y){l=I(y,"DIV",{class:!0,title:!0});var P=O(l);i=w(P,t),P.forEach(o),s=z(y),r=I(y,"DIV",{class:!0});var D=O(r);c=w(D,u),D.forEach(o),f=z(y),p=I(y,"DIV",{class:!0});var N=O(p);tt(d.$$.fragment,N),N.forEach(o),this.h()},h(){T(l,"class","itemName"),T(l,"title",n=`${e[28].types[e[64]].name} [${e[64]}]`),T(r,"class","qty"),T(p,"class","graph svelte-1u87si0")},m(y,P){q(y,l,P),a(l,i),q(y,s,P),q(y,r,P),a(r,c),q(y,f,P),q(y,p,P),lt(d,p,null),h=!0},p(y,P){var N,M;e=y,(!h||P[0]&301989888)&&t!==(t=e[28].types[e[64]].name+"")&&Z(i,t),(!h||P[0]&301989888&&n!==(n=`${e[28].types[e[64]].name} [${e[64]}]`))&&T(l,"title",n),(!h||P[0]&33554432)&&u!==(u=((N=e[25].materials[e[64]])==null?void 0:N.quantity)+"")&&Z(c,u);const D={};P[0]&536870912&&(D.extents=e[29]),P[0]&33554432&&(D.quantity=(M=e[25].materials[e[64]])==null?void 0:M.quantity),P[0]&33554432&&(D.type_id=e[64]),P[0]&2&&(D.buyOverheadRate=e[1]),!_&&P[0]&33554464&&(_=!0,D.price=e[5][e[64]],we(()=>_=!1)),d.$set(D)},i(y){h||(ie(d.$$.fragment,y),h=!0)},o(y){fe(d.$$.fragment,y),h=!1},d(y){y&&o(l),y&&o(s),y&&o(r),y&&o(f),y&&o(p),it(d)}}}function Ir(e){let l,t=e[61].name+"",i,n;return{c(){l=E("option"),i=B(t),this.h()},l(s){l=I(s,"OPTION",{});var r=O(l);i=w(r,t),r.forEach(o),this.h()},h(){l.__value=n=e[61].type_id,l.value=l.__value},m(s,r){q(s,l,r),a(l,i)},p(s,r){r[1]&1&&t!==(t=s[61].name+"")&&Z(i,t),r[1]&1&&n!==(n=s[61].type_id)&&(l.__value=n,l.value=l.__value)},d(s){s&&o(l)}}}function Ss(e){let l,t,i;return{c(){l=E("div"),t=J(),i=E("div"),this.h()},l(n){l=I(n,"DIV",{}),O(l).forEach(o),t=z(n),i=I(n,"DIV",{class:!0}),O(i).forEach(o),this.h()},h(){T(i,"class","graph svelte-1u87si0")},m(n,s){q(n,l,s),q(n,t,s),q(n,i,s)},p:Se,i:Se,o:Se,d(n){n&&o(l),n&&o(t),n&&o(i)}}}function Ns(e){let l,t=1+"",i,n,s,r,u,c;function f(d){e[53](d)}let p={compact:!0,extents:e[29],quantity:1,type_id:e[6],buyOverheadRate:e[1]};return e[5][e[6]]!==void 0&&(p.price=e[5][e[6]]),r=new il({props:p}),De.push(()=>Be(r,"price",f)),{c(){l=E("div"),i=B(t),n=J(),s=E("div"),et(r.$$.fragment),this.h()},l(d){l=I(d,"DIV",{class:!0});var _=O(l);i=w(_,t),_.forEach(o),n=z(d),s=I(d,"DIV",{class:!0});var h=O(s);tt(r.$$.fragment,h),h.forEach(o),this.h()},h(){T(l,"class","qty"),T(s,"class","graph svelte-1u87si0")},m(d,_){q(d,l,_),a(l,i),q(d,n,_),q(d,s,_),lt(r,s,null),c=!0},p(d,_){const h={};_[0]&536870912&&(h.extents=d[29]),_[0]&64&&(h.type_id=d[6]),_[0]&2&&(h.buyOverheadRate=d[1]),!u&&_[0]&96&&(u=!0,h.price=d[5][d[6]],we(()=>u=!1)),r.$set(h)},i(d){c||(ie(r.$$.fragment,d),c=!0)},o(d){fe(r.$$.fragment,d),c=!1},d(d){d&&o(l),d&&o(n),d&&o(s),it(r)}}}function Tr(e){var s,r;let l,t=((r=e[28].types[(s=e[58])==null?void 0:s.type_id])==null?void 0:r.name)+"",i,n;return{c(){l=E("option"),i=B(t),this.h()},l(u){l=I(u,"OPTION",{});var c=O(l);i=w(c,t),c.forEach(o),this.h()},h(){l.__value=n=e[58],l.value=l.__value},m(u,c){q(u,l,c),a(l,i)},p(u,c){var f,p;c[0]&268435464&&t!==(t=((p=u[28].types[(f=u[58])==null?void 0:f.type_id])==null?void 0:p.name)+"")&&Z(i,t),c[0]&8&&n!==(n=u[58])&&(l.__value=n,l.value=l.__value)},d(u){u&&o(l)}}}function Ls(e){let l,t=1+"",i,n,s,r,u,c;function f(d){e[56](d)}let p={compact:!0,extents:e[29],quantity:1,type_id:e[4].type_id,buyOverheadRate:e[1]};return e[5][e[4].type_id]!==void 0&&(p.price=e[5][e[4].type_id]),r=new il({props:p}),De.push(()=>Be(r,"price",f)),{c(){l=E("div"),i=B(t),n=J(),s=E("div"),et(r.$$.fragment),this.h()},l(d){l=I(d,"DIV",{class:!0});var _=O(l);i=w(_,t),_.forEach(o),n=z(d),s=I(d,"DIV",{class:!0});var h=O(s);tt(r.$$.fragment,h),h.forEach(o),this.h()},h(){T(l,"class","qty"),T(s,"class","graph svelte-1u87si0")},m(d,_){q(d,l,_),a(l,i),q(d,n,_),q(d,s,_),lt(r,s,null),c=!0},p(d,_){const h={};_[0]&536870912&&(h.extents=d[29]),_[0]&16&&(h.type_id=d[4].type_id),_[0]&2&&(h.buyOverheadRate=d[1]),!u&&_[0]&48&&(u=!0,h.price=d[5][d[4].type_id],we(()=>u=!1)),r.$set(h)},i(d){c||(ie(r.$$.fragment,d),c=!0)},o(d){fe(r.$$.fragment,d),c=!1},d(d){d&&o(l),d&&o(n),d&&o(s),it(r)}}}function Vs(e){let l,t,i,n,s,r,u;return{c(){l=E("div"),t=J(),i=E("div"),n=B("Blueprint cost per run "),s=E("input"),this.h()},l(c){l=I(c,"DIV",{}),O(l).forEach(o),t=z(c),i=I(c,"DIV",{class:!0});var f=O(i);n=w(f,"Blueprint cost per run "),s=I(f,"INPUT",{type:!0}),f.forEach(o),this.h()},h(){T(s,"type","number"),T(i,"class","graph svelte-1u87si0")},m(c,f){q(c,l,f),q(c,t,f),q(c,i,f),a(i,n),a(i,s),ft(s,e[7]),r||(u=ye(s,"input",e[55]),r=!0)},p(c,f){f[0]&128&&Ft(s.value)!==c[7]&&ft(s,c[7])},i:Se,o:Se,d(c){c&&o(l),c&&o(t),c&&o(i),r=!1,u()}}}function Us(e){var Lt,He,Rt;let l,t=((Lt=e[13])==null?void 0:Lt.name)+"",i,n,s,r,u,c,f,p=((He=e[14])==null?void 0:He.name)+"",d,_,h,m,v,k,S,y=((Rt=e[15])==null?void 0:Rt.name)+"",P,D,N,M,b,R,G,F,W,j,L,V,X,Y,le,ee,ne,_e,ve,me,Re,he,ce,Me,re,se,ze,Xe,ge,pe,oe,rt,K,A=Tl(e[20])+"",$,ue,Ne,ke,Le=Tl(e[22])+"",be,st,Ae,Tt,bt=Tl(e[23])+"",x,Ve,Ot,Ue,yt=Tl(100-e[21]*100)+"",vt,qt,jt,Ze,Qe,Ie,U,Pe,nt,Ee,xe,Oe,de,Ct,St=Je(e[26])+"",At,Xt,Ht,Dt=ui(e[30])+"",gt,Kt,Qt,_t,Gt=Je(e[12])+"",dl,Nt,Ge,hl,Wt=e[19]*100+"",Zt,Cl,rl,sl,xt=Math.ceil(Math.log(1-.9)/Math.log(1-e[19]))+"",nl,ct,ul,Dl,ol,Rl,$t,kt,al=Je(e[0])+"",Ce,We,Pl,zl;function oi(g){e[46](g)}function ai(g){e[47](g)}function Bl(g){e[48](g)}function ot(g){e[49](g)}let qe={activity:ii};e[8]!==void 0&&(qe.activitySystemCostIndex=e[8]),e[9]!==void 0&&(qe.activityTax=e[9]),e[10]!==void 0&&(qe.structureRoleBonuses=e[10]),e[11]!==void 0&&(qe.structureRigBonuses=e[11]),R=new Ei({props:qe}),De.push(()=>Be(R,"activitySystemCostIndex",oi)),De.push(()=>Be(R,"activityTax",ai)),De.push(()=>Be(R,"structureRoleBonuses",Bl)),De.push(()=>Be(R,"structureRigBonuses",ot)),me=new il({props:{compact:!0,extents:e[29],quantity:1,totalCost:e[26]}});let fl=Object.keys(e[25].materials).map(e[50]),Fe=[];for(let g=0;g<fl.length;g+=1)Fe[g]=Er(kr(e,fl,g));const fi=g=>fe(Fe[g],1,1,()=>{Fe[g]=null});let pl=Object.values(e[31]),at=[];for(let g=0;g<pl.length;g+=1)at[g]=Ir(gr(e,pl,g));const _l=[Ns,Ss],ht=[];function je(g,H){return g[6]?0:1}Ze=je(e),Qe=ht[Ze]=_l[Ze](e);let ml=e[3],ut=[];for(let g=0;g<ml.length;g+=1)ut[g]=Tr(vr(e,ml,g));const C=[Vs,Ls],Q=[];function $e(g,H){return g[27]?0:1}return Ee=$e(e),xe=Q[Ee]=C[Ee](e),{c(){l=E("label"),i=B(t),n=J(),s=E("input"),r=J(),u=E("br"),c=J(),f=E("label"),d=B(p),_=J(),h=E("input"),m=J(),v=E("br"),k=J(),S=E("label"),P=B(y),D=J(),N=E("input"),M=J(),b=E("p"),et(R.$$.fragment),L=E("br"),V=J(),X=E("div"),Y=E("div"),le=B("Job cost"),ee=J(),ne=E("div"),_e=J(),ve=E("div"),et(me.$$.fragment),Re=J();for(let g=0;g<Fe.length;g+=1)Fe[g].c();he=J(),ce=E("div"),Me=E("span"),re=E("select"),se=E("option"),ze=B("No decryptor");for(let g=0;g<at.length;g+=1)at[g].c();Xe=J(),ge=E("div"),pe=E("dl"),oe=E("dt"),rt=B("Runs"),K=E("dd"),$=B(A),ue=E("dt"),Ne=B("ME"),ke=E("dd"),be=B(Le),st=E("dt"),Ae=B("TE"),Tt=E("dd"),x=B(bt),Ve=E("dt"),Ot=B("Probability"),Ue=E("dd"),vt=B(yt),qt=B("%"),jt=J(),Qe.c(),Ie=J(),U=E("div"),Pe=E("select");for(let g=0;g<ut.length;g+=1)ut[g].c();nt=J(),xe.c(),Oe=J(),de=E("p"),Ct=B("Invention job cost: "),At=B(St),Xt=E("br"),Ht=B(`\r
    Invention job duration: `),gt=B(Dt),Kt=E("br"),Qt=B(`\r
    Invention cost per attempt: `),_t=E("b"),dl=B(Gt),Nt=J(),Ge=E("p"),hl=B("Chance of success: "),Zt=B(Wt),Cl=B("% "),rl=E("br"),sl=B(`\r
    Expected invention attempts to get >=90% chance to get >=1 successes: `),nl=B(xt),ct=J(),ul=E("br"),Dl=B(`\r
    Expected Runs: `),ol=B(e[24]),Rl=E("br"),$t=B(`\r
    Expected cost per run: `),kt=E("b"),Ce=B(al),this.h()},l(g){l=I(g,"LABEL",{});var H=O(l);i=w(H,t),n=z(H),s=I(H,"INPUT",{type:!0,min:!0,max:!0}),H.forEach(o),r=z(g),u=I(g,"BR",{}),c=z(g),f=I(g,"LABEL",{});var ae=O(f);d=w(ae,p),_=z(ae),h=I(ae,"INPUT",{type:!0,min:!0,max:!0}),ae.forEach(o),m=z(g),v=I(g,"BR",{}),k=z(g),S=I(g,"LABEL",{});var dt=O(S);P=w(dt,y),D=z(dt),N=I(dt,"INPUT",{type:!0,min:!0,max:!0}),dt.forEach(o),M=z(g),b=I(g,"P",{});var Mt=O(b);tt(R.$$.fragment,Mt),L=I(Mt,"BR",{}),Mt.forEach(o),V=z(g),X=I(g,"DIV",{class:!0});var Ye=O(X);Y=I(Ye,"DIV",{class:!0});var el=O(Y);le=w(el,"Job cost"),el.forEach(o),ee=z(Ye),ne=I(Ye,"DIV",{class:!0}),O(ne).forEach(o),_e=z(Ye),ve=I(Ye,"DIV",{class:!0});var bl=O(ve);tt(me.$$.fragment,bl),bl.forEach(o),Re=z(Ye);for(let Yt=0;Yt<Fe.length;Yt+=1)Fe[Yt].l(Ye);he=z(Ye),ce=I(Ye,"DIV",{});var yl=O(ce);Me=I(yl,"SPAN",{class:!0});var te=O(Me);re=I(te,"SELECT",{class:!0});var mt=O(re);se=I(mt,"OPTION",{});var jl=O(se);ze=w(jl,"No decryptor"),jl.forEach(o);for(let Yt=0;Yt<at.length;Yt+=1)at[Yt].l(mt);mt.forEach(o),Xe=z(te),ge=I(te,"DIV",{class:!0});var Sl=O(ge);pe=I(Sl,"DL",{class:!0});var Vt=O(pe);oe=I(Vt,"DT",{});var tl=O(oe);rt=w(tl,"Runs"),tl.forEach(o),K=I(Vt,"DD",{});var Nl=O(K);$=w(Nl,A),Nl.forEach(o),ue=I(Vt,"DT",{});var Ll=O(ue);Ne=w(Ll,"ME"),Ll.forEach(o),ke=I(Vt,"DD",{});var wl=O(ke);be=w(wl,Le),wl.forEach(o),st=I(Vt,"DT",{});var Ti=O(st);Ae=w(Ti,"TE"),Ti.forEach(o),Tt=I(Vt,"DD",{});var Ci=O(Tt);x=w(Ci,bt),Ci.forEach(o),Ve=I(Vt,"DT",{});var Di=O(Ve);Ot=w(Di,"Probability"),Di.forEach(o),Ue=I(Vt,"DD",{});var _i=O(Ue);vt=w(_i,yt),qt=w(_i,"%"),_i.forEach(o),Vt.forEach(o),Sl.forEach(o),te.forEach(o),yl.forEach(o),jt=z(Ye),Qe.l(Ye),Ie=z(Ye),U=I(Ye,"DIV",{});var Ri=O(U);Pe=I(Ri,"SELECT",{class:!0});var Mi=O(Pe);for(let Yt=0;Yt<ut.length;Yt+=1)ut[Yt].l(Mi);Mi.forEach(o),Ri.forEach(o),nt=z(Ye),xe.l(Ye),Ye.forEach(o),Oe=z(g),de=I(g,"P",{});var cl=O(de);Ct=w(cl,"Invention job cost: "),At=w(cl,St),Xt=I(cl,"BR",{}),Ht=w(cl,`\r
    Invention job duration: `),gt=w(cl,Dt),Kt=I(cl,"BR",{}),Qt=w(cl,`\r
    Invention cost per attempt: `),_t=I(cl,"B",{});var Pi=O(_t);dl=w(Pi,Gt),Pi.forEach(o),cl.forEach(o),Nt=z(g),Ge=I(g,"P",{});var Et=O(Ge);hl=w(Et,"Chance of success: "),Zt=w(Et,Wt),Cl=w(Et,"% "),rl=I(Et,"BR",{}),sl=w(Et,`\r
    Expected invention attempts to get >=90% chance to get >=1 successes: `),nl=w(Et,xt),ct=z(Et),ul=I(Et,"BR",{}),Dl=w(Et,`\r
    Expected Runs: `),ol=w(Et,e[24]),Rl=I(Et,"BR",{}),$t=w(Et,`\r
    Expected cost per run: `),kt=I(Et,"B",{});var Bi=O(kt);Ce=w(Bi,al),Bi.forEach(o),Et.forEach(o),this.h()},h(){T(s,"type","range"),T(s,"min",0),T(s,"max",5),T(h,"type","range"),T(h,"min",0),T(h,"max",5),T(N,"type","range"),T(N,"min",0),T(N,"max",5),T(Y,"class","itemName"),T(ne,"class","qty"),T(ve,"class","graph svelte-1u87si0"),se.__value=null,se.value=se.__value,T(re,"class","svelte-1u87si0"),e[6]===void 0&&Fl(()=>e[52].call(re)),T(pe,"class","svelte-1u87si0"),T(ge,"class","overlay svelte-1u87si0"),T(Me,"class","overlay-parent"),T(Pe,"class","svelte-1u87si0"),e[4]===void 0&&Fl(()=>e[54].call(Pe)),T(X,"class","breakdown")},m(g,H){q(g,l,H),a(l,i),a(l,n),a(l,s),ft(s,e[16]),q(g,r,H),q(g,u,H),q(g,c,H),q(g,f,H),a(f,d),a(f,_),a(f,h),ft(h,e[17]),q(g,m,H),q(g,v,H),q(g,k,H),q(g,S,H),a(S,P),a(S,D),a(S,N),ft(N,e[18]),q(g,M,H),q(g,b,H),lt(R,b,null),a(b,L),q(g,V,H),q(g,X,H),a(X,Y),a(Y,le),a(X,ee),a(X,ne),a(X,_e),a(X,ve),lt(me,ve,null),a(X,Re);for(let ae=0;ae<Fe.length;ae+=1)Fe[ae].m(X,null);a(X,he),a(X,ce),a(ce,Me),a(Me,re),a(re,se),a(se,ze);for(let ae=0;ae<at.length;ae+=1)at[ae].m(re,null);Ut(re,e[6]),a(Me,Xe),a(Me,ge),a(ge,pe),a(pe,oe),a(oe,rt),a(pe,K),a(K,$),a(pe,ue),a(ue,Ne),a(pe,ke),a(ke,be),a(pe,st),a(st,Ae),a(pe,Tt),a(Tt,x),a(pe,Ve),a(Ve,Ot),a(pe,Ue),a(Ue,vt),a(Ue,qt),a(X,jt),ht[Ze].m(X,null),a(X,Ie),a(X,U),a(U,Pe);for(let ae=0;ae<ut.length;ae+=1)ut[ae].m(Pe,null);Ut(Pe,e[4]),a(X,nt),Q[Ee].m(X,null),q(g,Oe,H),q(g,de,H),a(de,Ct),a(de,At),a(de,Xt),a(de,Ht),a(de,gt),a(de,Kt),a(de,Qt),a(de,_t),a(_t,dl),q(g,Nt,H),q(g,Ge,H),a(Ge,hl),a(Ge,Zt),a(Ge,Cl),a(Ge,rl),a(Ge,sl),a(Ge,nl),a(Ge,ct),a(Ge,ul),a(Ge,Dl),a(Ge,ol),a(Ge,Rl),a(Ge,$t),a(Ge,kt),a(kt,Ce),We=!0,Pl||(zl=[ye(s,"change",e[43]),ye(s,"input",e[43]),ye(h,"change",e[44]),ye(h,"input",e[44]),ye(N,"change",e[45]),ye(N,"input",e[45]),ye(re,"change",e[52]),ye(Pe,"change",e[54])],Pl=!0)},p(g,H){var el,bl,yl;(!We||H[0]&8192)&&t!==(t=((el=g[13])==null?void 0:el.name)+"")&&Z(i,t),H[0]&65536&&ft(s,g[16]),(!We||H[0]&16384)&&p!==(p=((bl=g[14])==null?void 0:bl.name)+"")&&Z(d,p),H[0]&131072&&ft(h,g[17]),(!We||H[0]&32768)&&y!==(y=((yl=g[15])==null?void 0:yl.name)+"")&&Z(P,y),H[0]&262144&&ft(N,g[18]);const ae={};!G&&H[0]&256&&(G=!0,ae.activitySystemCostIndex=g[8],we(()=>G=!1)),!F&&H[0]&512&&(F=!0,ae.activityTax=g[9],we(()=>F=!1)),!W&&H[0]&1024&&(W=!0,ae.structureRoleBonuses=g[10],we(()=>W=!1)),!j&&H[0]&2048&&(j=!0,ae.structureRigBonuses=g[11],we(()=>j=!1)),R.$set(ae);const dt={};if(H[0]&536870912&&(dt.extents=g[29]),H[0]&67108864&&(dt.totalCost=g[26]),me.$set(dt),H[0]&838860834){fl=Object.keys(g[25].materials).map(g[50]);let te;for(te=0;te<fl.length;te+=1){const mt=kr(g,fl,te);Fe[te]?(Fe[te].p(mt,H),ie(Fe[te],1)):(Fe[te]=Er(mt),Fe[te].c(),ie(Fe[te],1),Fe[te].m(X,he))}for(Jt(),te=fl.length;te<Fe.length;te+=1)fi(te);zt()}if(H[1]&1){pl=Object.values(g[31]);let te;for(te=0;te<pl.length;te+=1){const mt=gr(g,pl,te);at[te]?at[te].p(mt,H):(at[te]=Ir(mt),at[te].c(),at[te].m(re,null))}for(;te<at.length;te+=1)at[te].d(1);at.length=pl.length}H[0]&64|H[1]&1&&Ut(re,g[6]),(!We||H[0]&1048576)&&A!==(A=Tl(g[20])+"")&&Z($,A),(!We||H[0]&4194304)&&Le!==(Le=Tl(g[22])+"")&&Z(be,Le),(!We||H[0]&8388608)&&bt!==(bt=Tl(g[23])+"")&&Z(x,bt),(!We||H[0]&2097152)&&yt!==(yt=Tl(100-g[21]*100)+"")&&Z(vt,yt);let Mt=Ze;if(Ze=je(g),Ze===Mt?ht[Ze].p(g,H):(Jt(),fe(ht[Mt],1,1,()=>{ht[Mt]=null}),zt(),Qe=ht[Ze],Qe?Qe.p(g,H):(Qe=ht[Ze]=_l[Ze](g),Qe.c()),ie(Qe,1),Qe.m(X,Ie)),H[0]&268435464){ml=g[3];let te;for(te=0;te<ml.length;te+=1){const mt=vr(g,ml,te);ut[te]?ut[te].p(mt,H):(ut[te]=Tr(mt),ut[te].c(),ut[te].m(Pe,null))}for(;te<ut.length;te+=1)ut[te].d(1);ut.length=ml.length}H[0]&24&&Ut(Pe,g[4]);let Ye=Ee;Ee=$e(g),Ee===Ye?Q[Ee].p(g,H):(Jt(),fe(Q[Ye],1,1,()=>{Q[Ye]=null}),zt(),xe=Q[Ee],xe?xe.p(g,H):(xe=Q[Ee]=C[Ee](g),xe.c()),ie(xe,1),xe.m(X,null)),(!We||H[0]&67108864)&&St!==(St=Je(g[26])+"")&&Z(At,St),(!We||H[0]&1073741824)&&Dt!==(Dt=ui(g[30])+"")&&Z(gt,Dt),(!We||H[0]&4096)&&Gt!==(Gt=Je(g[12])+"")&&Z(dl,Gt),(!We||H[0]&524288)&&Wt!==(Wt=g[19]*100+"")&&Z(Zt,Wt),(!We||H[0]&524288)&&xt!==(xt=Math.ceil(Math.log(1-.9)/Math.log(1-g[19]))+"")&&Z(nl,xt),(!We||H[0]&16777216)&&Z(ol,g[24]),(!We||H[0]&1)&&al!==(al=Je(g[0])+"")&&Z(Ce,al)},i(g){if(!We){ie(R.$$.fragment,g),ie(me.$$.fragment,g);for(let H=0;H<fl.length;H+=1)ie(Fe[H]);ie(Qe),ie(xe),We=!0}},o(g){fe(R.$$.fragment,g),fe(me.$$.fragment,g),Fe=Fe.filter(Boolean);for(let H=0;H<Fe.length;H+=1)fe(Fe[H]);fe(Qe),fe(xe),We=!1},d(g){g&&o(l),g&&o(r),g&&o(u),g&&o(c),g&&o(f),g&&o(m),g&&o(v),g&&o(k),g&&o(S),g&&o(M),g&&o(b),it(R),g&&o(V),g&&o(X),it(me),It(Fe,g),It(at,g),ht[Ze].d(),It(ut,g),Q[Ee].d(),g&&o(Oe),g&&o(de),g&&o(Nt),g&&o(Ge),Pl=!1,Ql(zl)}}}const Fs=1124,As=1112,Qs=1113,Gs=1114;let Cr=2,Dr=4;function Tl(e){return`${e>=0?"+":""}${Math.round(e)}`}function Ys(e,l,t){let i,n,s,r,u,c,f,p=Se,d=()=>(p(),p=Ol(S,x=>t(39,f=x)),S),_,h,m,v;Ke(e,ql,x=>t(28,c=x)),Ke(e,bi,x=>t(41,h=x)),Ke(e,Yl,x=>t(42,m=x)),Ke(e,vs,x=>t(31,v=x)),e.$$.on_destroy.push(()=>p());let k=Vl("currentCharacter");Ke(e,k,x=>t(40,_=x));let S,{blueprintToInvent:y=null}=l,P=[],D=P[0];function N(x){var Ve;return c.categories[9].groups[(Ve=c.types[x])==null?void 0:Ve.group_id]!=null}let M={},{brokerFeeRate:b=.0151114234532}=l,R,G=0,F,W,j,L,V,X=0,Y,le,ee,ne=3,_e=3,ve=3,me=.3,Re,he,ce,Me,{productME:re=Cr}=l,{productTE:se=Dr}=l,{productRuns:ze=1}=l,{expectedCostPerRun:Xe=0}=l,{extents:ge=null}=l,pe=[0,1e6];function oe(){ne=Ft(this.value),t(16,ne),t(2,S),t(40,_),t(39,f),t(25,i),t(28,c),t(15,ee),t(13,Y),t(14,le),t(4,D),t(3,P),t(42,m),t(36,y)}function rt(){_e=Ft(this.value),t(17,_e),t(2,S),t(40,_),t(39,f),t(25,i),t(28,c),t(15,ee),t(13,Y),t(14,le),t(4,D),t(3,P),t(42,m),t(36,y)}function K(){ve=Ft(this.value),t(18,ve),t(2,S),t(40,_),t(39,f),t(25,i),t(28,c),t(15,ee),t(13,Y),t(14,le),t(4,D),t(3,P),t(42,m),t(36,y)}function A(x){W=x,t(8,W)}function $(x){j=x,t(9,j)}function ue(x){L=x,t(10,L)}function Ne(x){V=x,t(11,V)}const ke=x=>parseInt(x);function Le(x,Ve){e.$$.not_equal(M[Ve],x)&&(M[Ve]=x,t(5,M))}function be(){R=Al(this),t(6,R)}function st(x){e.$$.not_equal(M[R],x)&&(M[R]=x,t(5,M))}function Ae(){D=Al(this),t(4,D),t(3,P),t(42,m),t(36,y),t(3,P),t(42,m),t(36,y)}function Tt(){G=Ft(this.value),t(7,G),t(27,n),t(5,M),t(4,D),t(3,P),t(42,m),t(36,y)}function bt(x){e.$$.not_equal(M[D.type_id],x)&&(M[D.type_id]=x,t(5,M))}return e.$$set=x=>{"blueprintToInvent"in x&&t(36,y=x.blueprintToInvent),"brokerFeeRate"in x&&t(1,b=x.brokerFeeRate),"productME"in x&&t(34,re=x.productME),"productTE"in x&&t(35,se=x.productTE),"productRuns"in x&&t(33,ze=x.productRuns),"expectedCostPerRun"in x&&t(0,Xe=x.expectedCostPerRun),"extents"in x&&t(37,ge=x.extents)},e.$$.update=()=>{var x,Ve,Ot,Ue,yt,vt,qt,jt,Ze,Qe;if(e.$$.dirty[1]&2080&&t(3,P=Object.values(m.types).filter(Ie=>{var U;return(U=Ie.activities[ii])==null?void 0:U.products[y==null?void 0:y.type_id]})),e.$$.dirty[0]&24&&P.length>=1&&P.indexOf(D)===-1&&t(4,D=P[0]),e.$$.dirty[0]&16&&t(25,i=D==null?void 0:D.activities[ii]),e.$$.dirty[0]&16&&t(27,n=N(D==null?void 0:D.type_id)),e.$$.dirty[0]&134217776&&(n||t(7,G=M[D.type_id])),e.$$.dirty[1]&1184){t(38,F=0);let Ie=y.activities[pt];for(let U in Ie.materials)t(38,F+=Ie.materials[U].quantity*((Ve=(x=h[U])==null?void 0:x.adjusted_price)!=null?Ve:0))}if(e.$$.dirty[0]&3840|e.$$.dirty[1]&128&&t(26,s=F*W*.02*(1+((Ot=L==null?void 0:L.jobCostModifier)!=null?Ot:0)/100)*(1+((Ue=V==null?void 0:V.costReductionBonus)!=null?Ue:0)/100)*(1+j/100)),e.$$.dirty[0]&100667616&&(t(12,X=0),i&&(t(12,X+=G),t(12,X+=Ps(Object.values(i.materials),Ie=>M[Ie.materialTypeID]*Ie.quantity)),t(12,X+=(yt=M[R])!=null?yt:0),t(12,X+=s))),e.$$.dirty[0]&33557504|e.$$.dirty[1]&256&&t(30,r=i.time*(1-.03*(((vt=f==null?void 0:f.skills.find(Ie=>Ie.skill_id===Qi))==null?void 0:vt.active_skill_level)||0))*(1+((qt=L==null?void 0:L.jobDurationModifier)!=null?qt:0)/100)*(1+((jt=V==null?void 0:V.timeReductionBonus)!=null?jt:0)/100)),e.$$.dirty[0]&302047236|e.$$.dirty[1]&768){let U=function(nt){var Ee;return((Ee=f==null?void 0:f.skills.find(xe=>xe.skill_id===nt))==null?void 0:Ee.active_skill_level)||0},Ie=!1;S!==li[_]&&(d(t(2,S=li[_])),Ie=!0);let Pe=!1;for(let nt of Object.values(i==null?void 0:i.requiredSkills)){let Ee=c.types[nt.type_id];if(Ee.name.indexOf("Encryption")>=0){(Ie||(ee==null?void 0:ee.type_id)!==Ee.type_id)&&(t(15,ee=Ee),t(18,ve=U(ee.type_id)));continue}Pe?(Ie||(le==null?void 0:le.type_id)!==Ee.type_id)&&(t(14,le=Ee),t(17,_e=U(le.type_id))):((Ie||(Y==null?void 0:Y.type_id)!==Ee.type_id)&&(t(13,Y=Ee),t(16,ne=U(Y.type_id))),Pe=!0)}}e.$$.dirty[0]&64&&(R?as(R).then(Ie=>{t(20,Re=Ie.dogma_attributes.find(U=>U.attribute_id==Fs).value),t(21,he=Ie.dogma_attributes.find(U=>U.attribute_id==As).value),t(22,ce=Ie.dogma_attributes.find(U=>U.attribute_id==Qs).value),t(23,Me=Ie.dogma_attributes.find(U=>U.attribute_id==Gs).value)}):(t(20,Re=0),t(21,he=1),t(22,ce=0),t(23,Me=0))),e.$$.dirty[0]&36110336|e.$$.dirty[1]&32&&t(19,me=((Ze=i==null?void 0:i.products[y.type_id])==null?void 0:Ze.probability)*(1+(ne+_e)/30+ve/40)*he),e.$$.dirty[0]&12582912&&(t(34,re=Cr+ce),t(35,se=Dr+Me)),e.$$.dirty[0]&34603008|e.$$.dirty[1]&36&&(t(33,ze=((Qe=i==null?void 0:i.products[y.type_id])==null?void 0:Qe.quantity)+Re),isNaN(ze)&&t(33,ze=1)),e.$$.dirty[0]&524288|e.$$.dirty[1]&4&&t(24,u=ze*me),e.$$.dirty[0]&16781313&&(t(0,Xe=X/u),isNaN(Xe)&&t(0,Xe=0)),e.$$.dirty[0]&4096|e.$$.dirty[1]&64&&t(29,pe=ge||[0,X*1.5])},[Xe,b,S,P,D,M,R,G,W,j,L,V,X,Y,le,ee,ne,_e,ve,me,Re,he,ce,Me,u,i,s,n,c,pe,r,v,k,ze,re,se,y,ge,F,f,_,h,m,oe,rt,K,A,$,ue,Ne,ke,Le,be,st,Ae,Tt,bt]}class Js extends vl{constructor(l){super();gl(this,l,Ys,Us,kl,{blueprintToInvent:36,brokerFeeRate:1,productME:34,productTE:35,productRuns:33,expectedCostPerRun:0,extents:37},null,[-1,-1,-1])}}function zs(e,l){return l*(1+(e!=null?e:0)/100)}function Ii(e,l){let t=e;return l.forEach(i=>{t=i.value==null?zs(i.value,t):t}),t}class Xs{constructor(l,t){var i,n,s,r,u,c,f;this.activity=l,this.selectedProduct=(f=(c=(n=(i=this.activity)==null?void 0:i.products[t])==null?void 0:n.type_id)!=null?c:(u=Object.values((r=(s=this.activity)==null?void 0:s.products)!=null?r:{})[0])==null?void 0:u.type_id)!=null?f:null,this.facilityModifiers={taxRate:10,systemCostIndex:.05},this.prices={},this.indexPrices={},this.blueprintCostPerRun=0,this.runs=1}get producedQuantity(){var l;return((l=this.activity)==null?void 0:l.products[this.selectedProduct].quantity)*this.runs}set requiredQuantity(l){var t,i;this.runs=Math.ceil(l/((i=(t=this.activity)==null?void 0:t.products[this.selectedProduct])==null?void 0:i.quantity))}qty(l){var i,n,s;if(l==null)return 0;let t=Ii(l*this.runs,[{value:-((i=this.blueprintModifiers)==null?void 0:i.materialEfficiency)},{value:(n=this.facilityModifiers.roleModifiers)==null?void 0:n.materialConsumption},{value:(s=this.facilityModifiers.rigModifiers)==null?void 0:s.materialReduction}]);return Math.max(this.runs,Math.ceil(t))}materialQuantity(l){var t,i;return this.qty((i=(t=this.activity)==null?void 0:t.materials[l])==null?void 0:i.quantity)}get estimatedItemValue(){var t,i,n,s;let l=0;for(let r in(i=(t=this.activity)==null?void 0:t.materials)!=null?i:[])l+=this.activity.materials[r].quantity*((s=(n=this.indexPrices[r])==null?void 0:n.adjusted_price)!=null?s:0);return l}get jobCost(){var t;return Ii(this.estimatedItemValue*this.facilityModifiers.systemCostIndex*this.runs,[{value:(t=this.facilityModifiers.roleModifiers)==null?void 0:t.jobCost},{value:this.facilityModifiers.taxRate}])}get totalCost(){var t,i,n,s;let l=0;for(let r in(i=(t=this.activity)==null?void 0:t.materials)!=null?i:[])l+=this.qty(this.activity.materials[r].quantity)*((n=this.prices[r])!=null?n:0);return l+=this.jobCost,l+=((s=this.blueprintCostPerRun)!=null?s:0)*this.runs,l}get unitCost(){return this.totalCost/this.producedQuantity}get jobDuration(){var l,t,i,n;return Ii(this.activity.time*this.runs,[{value:-((l=this.blueprintModifiers)==null?void 0:l.timeEfficiency)},{value:(t=this.characterModifiers)==null?void 0:t.skill_jobDuration},{value:(i=this.facilityModifiers.roleModifiers)==null?void 0:i.jobDuration},{value:(n=this.facilityModifiers.rigModifiers)==null?void 0:n.timeReduction}])}get profit(){return this.prices[this.selectedProduct]*this.producedQuantity-this.totalCost}}function Hs(e,l){let t=new Xs(e,l),{subscribe:i,set:n}=Ml(t);return{subscribe:i,update:s=>{for(let r in s)if(!t[r]||typeof s[r]!="object")t[r]=s[r];else for(let u in s[r])t[r][u]=s[r][u];n(t)}}}function Ks(e,l){let{activity:t}=Jl(e,l);return Hs(t,e)}function Rr(e,l,t){const i=e.slice();return i[25]=l[t],i[26]=l,i[27]=t,i}function Mr(e){let l,t,i,n,s,r;const u=[Zs,Ws],c=[];function f(p,d){return(t==null||d&3072)&&(t=!!Jl(p[25],p[11]).activity),t?0:1}return i=f(e,-1),n=c[i]=u[i](e),{c(){l=E("div"),n.c(),s=J(),this.h()},l(p){l=I(p,"DIV",{class:!0});var d=O(l);n.l(d),s=z(d),d.forEach(o),this.h()},h(){T(l,"class","subItem")},m(p,d){q(p,l,d),c[i].m(l,null),a(l,s),r=!0},p(p,d){let _=i;i=f(p,d),i===_?c[i].p(p,d):(Jt(),fe(c[_],1,1,()=>{c[_]=null}),zt(),n=c[i],n?n.p(p,d):(n=c[i]=u[i](p),n.c()),ie(n,1),n.m(l,s))},i(p){r||(ie(n),r=!0)},o(p){fe(n),r=!1},d(p){p&&o(l),c[i].d()}}}function Ws(e){var n;let l,t=((n=e[14].types[e[25]])==null?void 0:n.name)+"",i;return{c(){l=B("Could not find industry details for "),i=B(t)},l(s){l=w(s,"Could not find industry details for "),i=w(s,t)},m(s,r){q(s,l,r),q(s,i,r)},p(s,r){var u;r&17408&&t!==(t=((u=s[14].types[s[25]])==null?void 0:u.name)+"")&&Z(i,t)},i:Se,o:Se,d(s){s&&o(l),s&&o(i)}}}function Zs(e){let l,t,i;function n(r){e[24](r,e[25])}let s={productTypeId:e[25],requiredQuantity:e[10].materialQuantity(e[25])};return e[12][e[25]]!==void 0&&(s.unitCost=e[12][e[25]]),l=new Br({props:s}),De.push(()=>Be(l,"unitCost",n)),{c(){et(l.$$.fragment)},l(r){tt(l.$$.fragment,r)},m(r,u){lt(l,r,u),i=!0},p(r,u){e=r;const c={};u&1024&&(c.productTypeId=e[25]),u&1024&&(c.requiredQuantity=e[10].materialQuantity(e[25])),!t&&u&5120&&(t=!0,c.unitCost=e[12][e[25]],we(()=>t=!1)),l.$set(c)},i(r){i||(ie(l.$$.fragment,r),i=!0)},o(r){fe(l.$$.fragment,r),i=!1},d(r){it(l,r)}}}function Pr(e){var W;let l,t,i,n,s,r,u=((W=e[14].types[e[25]])==null?void 0:W.name)+"",c,f,p,d,_=e[10].materialQuantity(e[25])+"",h,m,v,k,S,y,P,D,N,M;function b(){e[22].call(i,e[25])}function R(j){e[23](j,e[25])}let G={extents:e[13],quantity:e[10].materialQuantity(e[25]),type_id:e[25],overridePrice:e[1][e[25]]?e[12][e[25]]:void 0,buyOverheadRate:e[4],totalCost:e[1][e[25]]?e[12][e[25]]*e[10].materialQuantity(e[25]):null,compact:!0};e[6][e[25]]!==void 0&&(G.price=e[6][e[25]]),k=new il({props:G}),De.push(()=>Be(k,"price",R));let F=e[1][e[25]]&&Mr(e);return{c(){l=E("div"),t=E("label"),i=E("input"),s=J(),r=E("span"),c=B(u),p=J(),d=E("div"),h=B(_),m=J(),v=E("div"),et(k.$$.fragment),y=J(),F&&F.c(),P=Te(),this.h()},l(j){l=I(j,"DIV",{class:!0});var L=O(l);t=I(L,"LABEL",{});var V=O(t);i=I(V,"INPUT",{type:!0}),s=z(V),r=I(V,"SPAN",{title:!0});var X=O(r);c=w(X,u),X.forEach(o),V.forEach(o),L.forEach(o),p=z(j),d=I(j,"DIV",{class:!0});var Y=O(d);h=w(Y,_),Y.forEach(o),m=z(j),v=I(j,"DIV",{class:!0});var le=O(v);tt(k.$$.fragment,le),le.forEach(o),y=z(j),F&&F.l(j),P=Te(),this.h()},h(){var j;T(i,"type","checkbox"),i.disabled=n=!Gi(e[25],e[11]),T(r,"title",f=`${(j=e[14].types[e[25]])==null?void 0:j.name} [${e[25]}]`),T(l,"class","itemName"),T(d,"class","qty"),T(v,"class","graph")},m(j,L){q(j,l,L),a(l,t),a(t,i),i.checked=e[1][e[25]],a(t,s),a(t,r),a(r,c),q(j,p,L),q(j,d,L),a(d,h),q(j,m,L),q(j,v,L),lt(k,v,null),q(j,y,L),F&&F.m(j,L),q(j,P,L),D=!0,N||(M=ye(i,"change",b),N=!0)},p(j,L){var X,Y;e=j,(!D||L&3072&&n!==(n=!Gi(e[25],e[11])))&&(i.disabled=n),L&1026&&(i.checked=e[1][e[25]]),(!D||L&17408)&&u!==(u=((X=e[14].types[e[25]])==null?void 0:X.name)+"")&&Z(c,u),(!D||L&17408&&f!==(f=`${(Y=e[14].types[e[25]])==null?void 0:Y.name} [${e[25]}]`))&&T(r,"title",f),(!D||L&1024)&&_!==(_=e[10].materialQuantity(e[25])+"")&&Z(h,_);const V={};L&8192&&(V.extents=e[13]),L&1024&&(V.quantity=e[10].materialQuantity(e[25])),L&1024&&(V.type_id=e[25]),L&5122&&(V.overridePrice=e[1][e[25]]?e[12][e[25]]:void 0),L&16&&(V.buyOverheadRate=e[4]),L&5122&&(V.totalCost=e[1][e[25]]?e[12][e[25]]*e[10].materialQuantity(e[25]):null),!S&&L&1088&&(S=!0,V.price=e[6][e[25]],we(()=>S=!1)),k.$set(V),e[1][e[25]]?F?(F.p(e,L),L&1026&&ie(F,1)):(F=Mr(e),F.c(),ie(F,1),F.m(P.parentNode,P)):F&&(Jt(),fe(F,1,1,()=>{F=null}),zt())},i(j){D||(ie(k.$$.fragment,j),ie(F),D=!0)},o(j){fe(k.$$.fragment,j),fe(F),D=!1},d(j){j&&o(l),j&&o(p),j&&o(d),j&&o(m),j&&o(v),it(k),j&&o(y),F&&F.d(j),j&&o(P),N=!1,M()}}}function xs(e){var K;let l,t,i=((K=e[14].types[e[2]])==null?void 0:K.name)+"",n,s,r,u,c=e[10].producedQuantity+"",f,p,d,_,h=Je(e[6][e[2]])+"",m,v,k=ni(e[10].profit)+"",S,y,P,D,N,M,b,R,G,F,W,j=Je(e[0])+"",L,V,X=Je(e[10].totalCost)+"",Y,le,ee,ne,_e,ve,me,Re,he,ce,Me,re;function se(A){e[18](A)}function ze(A){e[19](A)}function Xe(A){e[20](A)}let ge={extents:e[13],quantity:e[10].producedQuantity,type_id:e[2],buyOverheadRate:-e[3],sellOverheadRate:-e[4]-e[3],totalCost:e[10].totalCost};e[6][e[2]]!==void 0&&(ge.price=e[6][e[2]]),e[7]!==void 0&&(ge.lowestSellPrice=e[7]),e[8]!==void 0&&(ge.highestBuyPrice=e[8]),N=new il({props:ge}),De.push(()=>Be(N,"price",se)),De.push(()=>Be(N,"lowestSellPrice",ze)),De.push(()=>Be(N,"highestBuyPrice",Xe)),ce=new il({props:{compact:!0,extents:e[13],quantity:e[10].producedQuantity,totalCost:e[10].totalCost}});let pe=Object.keys(e[10].activity.materials).map(e[21]),oe=[];for(let A=0;A<pe.length;A+=1)oe[A]=Pr(Rr(e,pe,A));const rt=A=>fe(oe[A],1,1,()=>{oe[A]=null});return{c(){l=E("div"),t=E("div"),n=B(i),r=J(),u=E("div"),f=B(c),p=J(),d=E("div"),_=B(`Unit price\r
        `),m=B(h),v=B(`\r
        Total Profit \r
        `),S=B(k),y=J(),P=E("br"),D=J(),et(N.$$.fragment),G=J(),F=E("br"),W=B(`\r
\r
        Unit cost `),L=B(j),V=B(" Total cost "),Y=B(X),ee=J(),ne=E("div"),_e=E("div"),ve=B("Job cost"),me=E("div"),Re=J(),he=E("div"),et(ce.$$.fragment),Me=J();for(let A=0;A<oe.length;A+=1)oe[A].c();this.h()},l(A){l=I(A,"DIV",{class:!0});var $=O(l);t=I($,"DIV",{class:!0,title:!0});var ue=O(t);n=w(ue,i),ue.forEach(o),r=z($),u=I($,"DIV",{class:!0});var Ne=O(u);f=w(Ne,c),Ne.forEach(o),p=z($),d=I($,"DIV",{class:!0});var ke=O(d);_=w(ke,`Unit price\r
        `),m=w(ke,h),v=w(ke,`\r
        Total Profit \r
        `),S=w(ke,k),y=z(ke),P=I(ke,"BR",{}),D=z(ke),tt(N.$$.fragment,ke),G=z(ke),F=I(ke,"BR",{}),W=w(ke,`\r
\r
        Unit cost `),L=w(ke,j),V=w(ke," Total cost "),Y=w(ke,X),ke.forEach(o),$.forEach(o),ee=z(A),ne=I(A,"DIV",{class:!0});var Le=O(ne);_e=I(Le,"DIV",{});var be=O(_e);ve=w(be,"Job cost"),be.forEach(o),me=I(Le,"DIV",{}),O(me).forEach(o),Re=z(Le),he=I(Le,"DIV",{class:!0});var st=O(he);tt(ce.$$.fragment,st),st.forEach(o),Me=z(Le);for(let Ae=0;Ae<oe.length;Ae+=1)oe[Ae].l(Le);Le.forEach(o),this.h()},h(){var A;T(t,"class","itemName"),T(t,"title",s=`${(A=e[14].types[e[2]])==null?void 0:A.name} [${e[2]}]`),T(u,"class","qty"),T(d,"class","graph"),T(l,"class",le=`breakdown ${e[5]?"":"summary"}`),T(he,"class","graph"),T(ne,"class","breakdown")},m(A,$){q(A,l,$),a(l,t),a(t,n),a(l,r),a(l,u),a(u,f),a(l,p),a(l,d),a(d,_),a(d,m),a(d,v),a(d,S),a(d,y),a(d,P),a(d,D),lt(N,d,null),a(d,G),a(d,F),a(d,W),a(d,L),a(d,V),a(d,Y),q(A,ee,$),q(A,ne,$),a(ne,_e),a(_e,ve),a(ne,me),a(ne,Re),a(ne,he),lt(ce,he,null),a(ne,Me);for(let ue=0;ue<oe.length;ue+=1)oe[ue].m(ne,null);re=!0},p(A,[$]){var ke,Le;(!re||$&16388)&&i!==(i=((ke=A[14].types[A[2]])==null?void 0:ke.name)+"")&&Z(n,i),(!re||$&16388&&s!==(s=`${(Le=A[14].types[A[2]])==null?void 0:Le.name} [${A[2]}]`))&&T(t,"title",s),(!re||$&1024)&&c!==(c=A[10].producedQuantity+"")&&Z(f,c),(!re||$&68)&&h!==(h=Je(A[6][A[2]])+"")&&Z(m,h),(!re||$&1024)&&k!==(k=ni(A[10].profit)+"")&&Z(S,k);const ue={};$&8192&&(ue.extents=A[13]),$&1024&&(ue.quantity=A[10].producedQuantity),$&4&&(ue.type_id=A[2]),$&8&&(ue.buyOverheadRate=-A[3]),$&24&&(ue.sellOverheadRate=-A[4]-A[3]),$&1024&&(ue.totalCost=A[10].totalCost),!M&&$&68&&(M=!0,ue.price=A[6][A[2]],we(()=>M=!1)),!b&&$&128&&(b=!0,ue.lowestSellPrice=A[7],we(()=>b=!1)),!R&&$&256&&(R=!0,ue.highestBuyPrice=A[8],we(()=>R=!1)),N.$set(ue),(!re||$&1)&&j!==(j=Je(A[0])+"")&&Z(L,j),(!re||$&1024)&&X!==(X=Je(A[10].totalCost)+"")&&Z(Y,X),(!re||$&32&&le!==(le=`breakdown ${A[5]?"":"summary"}`))&&T(l,"class",le);const Ne={};if($&8192&&(Ne.extents=A[13]),$&1024&&(Ne.quantity=A[10].producedQuantity),$&1024&&(Ne.totalCost=A[10].totalCost),ce.$set(Ne),$&31826){pe=Object.keys(A[10].activity.materials).map(A[21]);let be;for(be=0;be<pe.length;be+=1){const st=Rr(A,pe,be);oe[be]?(oe[be].p(st,$),ie(oe[be],1)):(oe[be]=Pr(st),oe[be].c(),ie(oe[be],1),oe[be].m(ne,null))}for(Jt(),be=pe.length;be<oe.length;be+=1)rt(be);zt()}},i(A){if(!re){ie(N.$$.fragment,A),ie(ce.$$.fragment,A);for(let $=0;$<pe.length;$+=1)ie(oe[$]);re=!0}},o(A){fe(N.$$.fragment,A),fe(ce.$$.fragment,A),oe=oe.filter(Boolean);for(let $=0;$<oe.length;$+=1)fe(oe[$]);re=!1},d(A){A&&o(l),it(N),A&&o(ee),A&&o(ne),it(ce),It(oe,A)}}}function $s(e,l,t){let i,n,s=Se,r=()=>(s(),s=Ol(i,V=>t(10,n=V)),i),u,c,f;Ke(e,bi,V=>t(17,u=V)),Ke(e,Yl,V=>t(11,c=V)),Ke(e,ql,V=>t(14,f=V)),e.$$.on_destroy.push(()=>s());let{productTypeId:p=null}=l,{requiredQuantity:d=null}=l,{unitCost:_=0}=l,h={},{producedItems:m={}}=l,v={},{salesTaxRate:k=.036}=l,{brokerFeeRate:S=.0113709973928}=l,{compact:y=!1}=l,{extents:P=null}=l,D,N,M=[0,1e3];function b(V){e.$$.not_equal(h[p],V)&&(h[p]=V,t(6,h))}function R(V){D=V,t(7,D)}function G(V){N=V,t(8,N)}const F=V=>parseInt(V);function W(V){m[V]=this.checked,t(1,m)}function j(V,X){e.$$.not_equal(h[X],V)&&(h[X]=V,t(6,h))}function L(V,X){e.$$.not_equal(v[X],V)&&(v[X]=V,t(12,v))}return e.$$set=V=>{"productTypeId"in V&&t(2,p=V.productTypeId),"requiredQuantity"in V&&t(15,d=V.requiredQuantity),"unitCost"in V&&t(0,_=V.unitCost),"producedItems"in V&&t(1,m=V.producedItems),"salesTaxRate"in V&&t(3,k=V.salesTaxRate),"brokerFeeRate"in V&&t(4,S=V.brokerFeeRate),"compact"in V&&t(5,y=V.compact),"extents"in V&&t(16,P=V.extents)},e.$$.update=()=>{var V;if(e.$$.dirty&2052&&r(t(9,i=Ks(p,c))),e.$$.dirty&33280&&i.update({requiredQuantity:d}),e.$$.dirty&1024&&t(0,_=n.unitCost),e.$$.dirty&1025&&console.log(n,n.unitCost,_),e.$$.dirty&64){for(let X in h)t(6,h);t(6,h)}e.$$.dirty&131584&&i.update({indexPrices:u}),e.$$.dirty&576&&i.update({prices:h}),e.$$.dirty&67013&&(P===null?t(13,M[1]=1.1*Math.max((V=h[p])!=null?V:0,_!=null?_:0,D!=null?D:0,N!=null?N:0)*n.producedQuantity,M):t(13,M=P))},[_,m,p,k,S,y,h,D,N,i,n,c,v,M,f,d,P,u,b,R,G,F,W,j,L]}class Br extends vl{constructor(l){super();gl(this,l,$s,xs,kl,{productTypeId:2,requiredQuantity:15,unitCost:0,producedItems:1,salesTaxRate:3,brokerFeeRate:4,compact:5,extents:16})}}function wr(e,l,t){const i=e.slice();return i[69]=l[t],i[70]=l,i[71]=t,i}function en(e){var ut;let l,t,i=((ut=e[37].types[e[5]])==null?void 0:ut.name)+"",n,s,r,u,c,f,p,d,_=Je(e[28])+"",h,m,v=ni(e[34])+"",k,S,y,P,D,N,M,b,R,G,F,W=Je(e[3])+"",j,L,V=Je(e[21])+"",X,Y,le,ee,ne,_e,ve,me,Re,he,ce,Me,re,se,ze,Xe,ge,pe,oe,rt,K,A,$,ue,Ne,ke,Le,be,st,Ae,Tt,bt,x,Ve,Ot,Ue,yt,vt,qt,jt,Ze,Qe,Ie,U,Pe,nt,Ee,xe,Oe,de,Ct,St,At,Xt,Ht,Dt,gt,Kt,Qt,_t,Gt,dl,Nt,Ge=ui(e[35])+"",hl,Wt,Zt,Cl,rl,sl=Je(e[29])+"",xt,nl,ct,ul,Dl,ol,Rl,$t,kt,al,Ce,We,Pl;function zl(C){e[46](C)}function oi(C){e[47](C)}function ai(C){e[48](C)}let Bl={extents:e[32],quantity:e[26],type_id:e[5],buyOverheadRate:-e[6],sellOverheadRate:-e[7]-e[6],totalCost:e[21]};e[20][e[5]]!==void 0&&(Bl.price=e[20][e[5]]),e[24]!==void 0&&(Bl.lowestSellPrice=e[24]),e[25]!==void 0&&(Bl.highestBuyPrice=e[25]),D=new il({props:Bl}),De.push(()=>Be(D,"price",zl)),De.push(()=>Be(D,"lowestSellPrice",oi)),De.push(()=>Be(D,"highestBuyPrice",ai));let ot=e[8]!==null&&Or(e),qe=e[22]&&qr(e);function fl(C){e[60](C)}function Fe(C){e[61](C)}function fi(C){e[62](C)}function pl(C){e[63](C)}function at(C){e[64](C)}let _l={activity:pt};e[4]!==void 0&&(_l.value=e[4]),e[14]!==void 0&&(_l.activitySystemCostIndex=e[14]),e[15]!==void 0&&(_l.activityTax=e[15]),e[16]!==void 0&&(_l.structureRoleBonuses=e[16]),e[17]!==void 0&&(_l.structureRigBonuses=e[17]),de=new Ei({props:_l}),De.push(()=>Be(de,"value",fl)),De.push(()=>Be(de,"activitySystemCostIndex",Fe)),De.push(()=>Be(de,"activityTax",fi)),De.push(()=>Be(de,"structureRoleBonuses",pl)),De.push(()=>Be(de,"structureRigBonuses",at)),kt=new il({props:{compact:!0,extents:e[32],quantity:e[26],totalCost:e[29]}});let ht=Object.keys(e[12].materials).map(e[65]),je=[];for(let C=0;C<ht.length;C+=1)je[C]=Sr(wr(e,ht,C));const ml=C=>fe(je[C],1,1,()=>{je[C]=null});return{c(){l=E("div"),t=E("div"),n=B(i),r=J(),u=E("div"),c=B(e[26]),f=J(),p=E("div"),d=B(`Unit price\r
        `),h=B(_),m=B(`\r
        Total Profit \r
        `),k=B(v),S=J(),y=E("br"),P=J(),et(D.$$.fragment),R=J(),G=E("br"),F=B(`\r
\r
        Unit cost `),j=B(W),L=B(" Total cost "),X=B(V),le=J(),ee=E("div"),ne=B("Runs "),_e=E("input"),Re=J(),he=E("input"),Me=J(),ot&&ot.c(),re=J(),se=E("p"),ze=E("b"),Xe=B("Blueprint"),ge=J(),pe=E("br"),oe=J(),rt=E("label"),K=E("input"),$=B(" Invent"),ue=J(),Ne=E("br"),ke=J(),qe&&qe.c(),Le=J(),be=E("label"),st=B("ME "),Ae=E("input"),Tt=J(),bt=B(e[0]),x=J(),Ve=E("label"),Ot=B("TE "),Ue=E("input"),yt=J(),vt=B(e[1]),qt=J(),jt=E("br"),Ze=J(),Qe=E("label"),Ie=B("Cost per run "),U=E("input"),Pe=J(),nt=E("p"),Ee=E("b"),xe=B("Facility"),Oe=J(),et(de.$$.fragment),Dt=J(),gt=E("b"),Kt=B("Manufacturing"),Qt=J(),_t=E("dl"),Gt=E("dt"),dl=B("Time"),Nt=E("dd"),hl=B(Ge),Zt=E("dt"),Cl=B("Job Cost"),rl=E("dd"),xt=B(sl),nl=J(),ct=E("div"),ul=E("div"),Dl=B("Job cost"),ol=E("div"),Rl=J(),$t=E("div"),et(kt.$$.fragment),al=J();for(let C=0;C<je.length;C+=1)je[C].c();this.h()},l(C){l=I(C,"DIV",{class:!0});var Q=O(l);t=I(Q,"DIV",{class:!0,title:!0});var $e=O(t);n=w($e,i),$e.forEach(o),r=z(Q),u=I(Q,"DIV",{class:!0});var Lt=O(u);c=w(Lt,e[26]),Lt.forEach(o),f=z(Q),p=I(Q,"DIV",{class:!0});var He=O(p);d=w(He,`Unit price\r
        `),h=w(He,_),m=w(He,`\r
        Total Profit \r
        `),k=w(He,v),S=z(He),y=I(He,"BR",{}),P=z(He),tt(D.$$.fragment,He),R=z(He),G=I(He,"BR",{}),F=w(He,`\r
\r
        Unit cost `),j=w(He,W),L=w(He," Total cost "),X=w(He,V),He.forEach(o),Q.forEach(o),le=z(C),ee=I(C,"DIV",{class:!0});var Rt=O(ee);ne=w(Rt,"Runs "),_e=I(Rt,"INPUT",{type:!0,min:!0,max:!0}),Re=z(Rt),he=I(Rt,"INPUT",{type:!0,class:!0}),Me=z(Rt),ot&&ot.l(Rt),Rt.forEach(o),re=z(C),se=I(C,"P",{});var g=O(se);ze=I(g,"B",{});var H=O(ze);Xe=w(H,"Blueprint"),H.forEach(o),ge=z(g),pe=I(g,"BR",{}),oe=z(g),rt=I(g,"LABEL",{});var ae=O(rt);K=I(ae,"INPUT",{type:!0}),$=w(ae," Invent"),ae.forEach(o),ue=z(g),Ne=I(g,"BR",{}),ke=z(g),qe&&qe.l(g),Le=z(g),be=I(g,"LABEL",{});var dt=O(be);st=w(dt,"ME "),Ae=I(dt,"INPUT",{type:!0,min:!0,max:!0}),Tt=z(dt),bt=w(dt,e[0]),dt.forEach(o),x=z(g),Ve=I(g,"LABEL",{});var Mt=O(Ve);Ot=w(Mt,"TE "),Ue=I(Mt,"INPUT",{type:!0,min:!0,max:!0,step:!0}),yt=z(Mt),vt=w(Mt,e[1]),Mt.forEach(o),qt=z(g),jt=I(g,"BR",{}),Ze=z(g),Qe=I(g,"LABEL",{});var Ye=O(Qe);Ie=w(Ye,"Cost per run "),U=I(Ye,"INPUT",{type:!0}),Ye.forEach(o),g.forEach(o),Pe=z(C),nt=I(C,"P",{});var el=O(nt);Ee=I(el,"B",{});var bl=O(Ee);xe=w(bl,"Facility"),bl.forEach(o),Oe=z(el),tt(de.$$.fragment,el),el.forEach(o),Dt=z(C),gt=I(C,"B",{});var yl=O(gt);Kt=w(yl,"Manufacturing"),yl.forEach(o),Qt=z(C),_t=I(C,"DL",{});var te=O(_t);Gt=I(te,"DT",{});var mt=O(Gt);dl=w(mt,"Time"),mt.forEach(o),Nt=I(te,"DD",{title:!0});var jl=O(Nt);hl=w(jl,Ge),jl.forEach(o),Zt=I(te,"DT",{});var Sl=O(Zt);Cl=w(Sl,"Job Cost"),Sl.forEach(o),rl=I(te,"DD",{});var Vt=O(rl);xt=w(Vt,sl),Vt.forEach(o),te.forEach(o),nl=z(C),ct=I(C,"DIV",{class:!0});var tl=O(ct);ul=I(tl,"DIV",{});var Nl=O(ul);Dl=w(Nl,"Job cost"),Nl.forEach(o),ol=I(tl,"DIV",{}),O(ol).forEach(o),Rl=z(tl),$t=I(tl,"DIV",{class:!0});var Ll=O($t);tt(kt.$$.fragment,Ll),Ll.forEach(o),al=z(tl);for(let wl=0;wl<je.length;wl+=1)je[wl].l(tl);tl.forEach(o),this.h()},h(){var C,Q;T(t,"class","itemName"),T(t,"title",s=`${(C=e[37].types[e[5]])==null?void 0:C.name} [${e[5]}]`),T(u,"class","qty"),T(p,"class","graph"),T(l,"class",Y=""+(Kl(`breakdown ${e[9]?"":"summary"}`)+" svelte-8kmzjq")),T(_e,"type","range"),T(_e,"min",1),T(_e,"max",ve=e[22]?e[23]:(Q=e[30])==null?void 0:Q.maxProductionLimit),_e.disabled=me=e[8]!==null&&!e[13],T(he,"type","number"),he.disabled=ce=e[8]!==null&&!e[13],T(he,"class","svelte-8kmzjq"),T(ee,"class","combinedInput svelte-8kmzjq"),T(K,"type","checkbox"),K.disabled=A=!e[27],T(Ae,"type","range"),T(Ae,"min",0),T(Ae,"max",10),Ae.disabled=e[22],T(Ue,"type","range"),T(Ue,"min",0),T(Ue,"max",20),T(Ue,"step",2),Ue.disabled=e[22],T(U,"type","number"),U.disabled=e[22],T(Nt,"title",Wt=`${e[35]}s`),T($t,"class","graph"),T(ct,"class","breakdown")},m(C,Q){q(C,l,Q),a(l,t),a(t,n),a(l,r),a(l,u),a(u,c),a(l,f),a(l,p),a(p,d),a(p,h),a(p,m),a(p,k),a(p,S),a(p,y),a(p,P),lt(D,p,null),a(p,R),a(p,G),a(p,F),a(p,j),a(p,L),a(p,X),q(C,le,Q),q(C,ee,Q),a(ee,ne),a(ee,_e),ft(_e,e[11]),a(ee,Re),a(ee,he),ft(he,e[11]),a(ee,Me),ot&&ot.m(ee,null),q(C,re,Q),q(C,se,Q),a(se,ze),a(ze,Xe),a(se,ge),a(se,pe),a(se,oe),a(se,rt),a(rt,K),K.checked=e[22],a(rt,$),a(se,ue),a(se,Ne),a(se,ke),qe&&qe.m(se,null),a(se,Le),a(se,be),a(be,st),a(be,Ae),ft(Ae,e[0]),a(be,Tt),a(be,bt),a(se,x),a(se,Ve),a(Ve,Ot),a(Ve,Ue),ft(Ue,e[1]),a(Ve,yt),a(Ve,vt),a(se,qt),a(se,jt),a(se,Ze),a(se,Qe),a(Qe,Ie),a(Qe,U),ft(U,e[10]),q(C,Pe,Q),q(C,nt,Q),a(nt,Ee),a(Ee,xe),a(nt,Oe),lt(de,nt,null),q(C,Dt,Q),q(C,gt,Q),a(gt,Kt),q(C,Qt,Q),q(C,_t,Q),a(_t,Gt),a(Gt,dl),a(_t,Nt),a(Nt,hl),a(_t,Zt),a(Zt,Cl),a(_t,rl),a(rl,xt),q(C,nl,Q),q(C,ct,Q),a(ct,ul),a(ul,Dl),a(ct,ol),a(ct,Rl),a(ct,$t),lt(kt,$t,null),a(ct,al);for(let $e=0;$e<je.length;$e+=1)je[$e].m(ct,null);Ce=!0,We||(Pl=[ye(_e,"change",e[49]),ye(_e,"input",e[49]),ye(he,"input",e[50]),ye(K,"change",e[52]),ye(Ae,"change",e[57]),ye(Ae,"input",e[57]),ye(Ue,"change",e[58]),ye(Ue,"input",e[58]),ye(U,"input",e[59])],We=!0)},p(C,Q){var Rt,g,H;(!Ce||Q[0]&32|Q[1]&64)&&i!==(i=((Rt=C[37].types[C[5]])==null?void 0:Rt.name)+"")&&Z(n,i),(!Ce||Q[0]&32|Q[1]&64&&s!==(s=`${(g=C[37].types[C[5]])==null?void 0:g.name} [${C[5]}]`))&&T(t,"title",s),(!Ce||Q[0]&67108864)&&Z(c,C[26]),(!Ce||Q[0]&268435456)&&_!==(_=Je(C[28])+"")&&Z(h,_),(!Ce||Q[1]&8)&&v!==(v=ni(C[34])+"")&&Z(k,v);const $e={};Q[1]&2&&($e.extents=C[32]),Q[0]&67108864&&($e.quantity=C[26]),Q[0]&32&&($e.type_id=C[5]),Q[0]&64&&($e.buyOverheadRate=-C[6]),Q[0]&192&&($e.sellOverheadRate=-C[7]-C[6]),Q[0]&2097152&&($e.totalCost=C[21]),!N&&Q[0]&1048608&&(N=!0,$e.price=C[20][C[5]],we(()=>N=!1)),!M&&Q[0]&16777216&&(M=!0,$e.lowestSellPrice=C[24],we(()=>M=!1)),!b&&Q[0]&33554432&&(b=!0,$e.highestBuyPrice=C[25],we(()=>b=!1)),D.$set($e),(!Ce||Q[0]&8)&&W!==(W=Je(C[3])+"")&&Z(j,W),(!Ce||Q[0]&2097152)&&V!==(V=Je(C[21])+"")&&Z(X,V),(!Ce||Q[0]&512&&Y!==(Y=""+(Kl(`breakdown ${C[9]?"":"summary"}`)+" svelte-8kmzjq")))&&T(l,"class",Y),(!Ce||Q[0]&1086324736&&ve!==(ve=C[22]?C[23]:(H=C[30])==null?void 0:H.maxProductionLimit))&&T(_e,"max",ve),(!Ce||Q[0]&8448&&me!==(me=C[8]!==null&&!C[13]))&&(_e.disabled=me),Q[0]&2048&&ft(_e,C[11]),(!Ce||Q[0]&8448&&ce!==(ce=C[8]!==null&&!C[13]))&&(he.disabled=ce),Q[0]&2048&&Ft(he.value)!==C[11]&&ft(he,C[11]),C[8]!==null?ot?ot.p(C,Q):(ot=Or(C),ot.c(),ot.m(ee,null)):ot&&(ot.d(1),ot=null),(!Ce||Q[0]&134217728&&A!==(A=!C[27]))&&(K.disabled=A),Q[0]&4194304&&(K.checked=C[22]),C[22]?qe?(qe.p(C,Q),Q[0]&4194304&&ie(qe,1)):(qe=qr(C),qe.c(),ie(qe,1),qe.m(se,Le)):qe&&(Jt(),fe(qe,1,1,()=>{qe=null}),zt()),(!Ce||Q[0]&4194304)&&(Ae.disabled=C[22]),Q[0]&1&&ft(Ae,C[0]),(!Ce||Q[0]&1)&&Z(bt,C[0]),(!Ce||Q[0]&4194304)&&(Ue.disabled=C[22]),Q[0]&2&&ft(Ue,C[1]),(!Ce||Q[0]&2)&&Z(vt,C[1]),(!Ce||Q[0]&4194304)&&(U.disabled=C[22]),Q[0]&1024&&Ft(U.value)!==C[10]&&ft(U,C[10]);const Lt={};!Ct&&Q[0]&16&&(Ct=!0,Lt.value=C[4],we(()=>Ct=!1)),!St&&Q[0]&16384&&(St=!0,Lt.activitySystemCostIndex=C[14],we(()=>St=!1)),!At&&Q[0]&32768&&(At=!0,Lt.activityTax=C[15],we(()=>At=!1)),!Xt&&Q[0]&65536&&(Xt=!0,Lt.structureRoleBonuses=C[16],we(()=>Xt=!1)),!Ht&&Q[0]&131072&&(Ht=!0,Lt.structureRigBonuses=C[17],we(()=>Ht=!1)),de.$set(Lt),(!Ce||Q[1]&16)&&Ge!==(Ge=ui(C[35])+"")&&Z(hl,Ge),(!Ce||Q[1]&16&&Wt!==(Wt=`${C[35]}s`))&&T(Nt,"title",Wt),(!Ce||Q[0]&536870912)&&sl!==(sl=Je(C[29])+"")&&Z(xt,sl);const He={};if(Q[1]&2&&(He.extents=C[32]),Q[0]&67108864&&(He.quantity=C[26]),Q[0]&536870912&&(He.totalCost=C[29]),kt.$set(He),Q[0]&1839252|Q[1]&71){ht=Object.keys(C[12].materials).map(C[65]);let ae;for(ae=0;ae<ht.length;ae+=1){const dt=wr(C,ht,ae);je[ae]?(je[ae].p(dt,Q),ie(je[ae],1)):(je[ae]=Sr(dt),je[ae].c(),ie(je[ae],1),je[ae].m(ct,null))}for(Jt(),ae=ht.length;ae<je.length;ae+=1)ml(ae);zt()}},i(C){if(!Ce){ie(D.$$.fragment,C),ie(qe),ie(de.$$.fragment,C),ie(kt.$$.fragment,C);for(let Q=0;Q<ht.length;Q+=1)ie(je[Q]);Ce=!0}},o(C){fe(D.$$.fragment,C),fe(qe),fe(de.$$.fragment,C),fe(kt.$$.fragment,C),je=je.filter(Boolean);for(let Q=0;Q<je.length;Q+=1)fe(je[Q]);Ce=!1},d(C){C&&o(l),it(D),C&&o(le),C&&o(ee),ot&&ot.d(),C&&o(re),C&&o(se),qe&&qe.d(),C&&o(Pe),C&&o(nt),it(de),C&&o(Dt),C&&o(gt),C&&o(Qt),C&&o(_t),C&&o(nl),C&&o(ct),it(kt),It(je,C),We=!1,Ql(Pl)}}}function tn(e){let l;return{c(){l=B("No blueprint selected yet")},l(t){l=w(t,"No blueprint selected yet")},m(t,i){q(t,l,i)},p:Se,i:Se,o:Se,d(t){t&&o(l)}}}function Or(e){let l,t,i,n,s;return{c(){l=E("label"),t=E("input"),i=B(" Override"),this.h()},l(r){l=I(r,"LABEL",{});var u=O(l);t=I(u,"INPUT",{type:!0}),i=w(u," Override"),u.forEach(o),this.h()},h(){T(t,"type","checkbox")},m(r,u){q(r,l,u),a(l,t),t.checked=e[13],a(l,i),n||(s=ye(t,"change",e[51]),n=!0)},p(r,u){u[0]&8192&&(t.checked=r[13])},d(r){r&&o(l),n=!1,s()}}}function qr(e){let l,t,i,n,s,r,u;function c(h){e[53](h)}function f(h){e[54](h)}function p(h){e[55](h)}function d(h){e[56](h)}let _={blueprintToInvent:e[30]};return e[10]!==void 0&&(_.expectedCostPerRun=e[10]),e[0]!==void 0&&(_.productME=e[0]),e[1]!==void 0&&(_.productTE=e[1]),e[23]!==void 0&&(_.productRuns=e[23]),t=new Js({props:_}),De.push(()=>Be(t,"expectedCostPerRun",c)),De.push(()=>Be(t,"productME",f)),De.push(()=>Be(t,"productTE",p)),De.push(()=>Be(t,"productRuns",d)),{c(){l=E("div"),et(t.$$.fragment),this.h()},l(h){l=I(h,"DIV",{class:!0});var m=O(l);tt(t.$$.fragment,m),m.forEach(o),this.h()},h(){T(l,"class","subItem")},m(h,m){q(h,l,m),lt(t,l,null),u=!0},p(h,m){const v={};m[0]&1073741824&&(v.blueprintToInvent=h[30]),!i&&m[0]&1024&&(i=!0,v.expectedCostPerRun=h[10],we(()=>i=!1)),!n&&m[0]&1&&(n=!0,v.productME=h[0],we(()=>n=!1)),!s&&m[0]&2&&(s=!0,v.productTE=h[1],we(()=>s=!1)),!r&&m[0]&8388608&&(r=!0,v.productRuns=h[23],we(()=>r=!1)),t.$set(v)},i(h){u||(ie(t.$$.fragment,h),u=!0)},o(h){fe(t.$$.fragment,h),u=!1},d(h){h&&o(l),it(t)}}}function jr(e){let l,t,i,n,s,r,u;const c=[sn,rn,ln],f=[];function p(d,_){return(t==null||_[0]&4096|_[1]&1)&&(t=!!ri(d[31],d[69])),t?0:((i==null||_[0]&4096|_[1]&1)&&(i=!!Jl(d[69],d[31]).activity),i?1:2)}return n=p(e,[-1,-1,-1]),s=f[n]=c[n](e),{c(){l=E("div"),s.c(),r=J(),this.h()},l(d){l=I(d,"DIV",{class:!0});var _=O(l);s.l(_),r=z(_),_.forEach(o),this.h()},h(){T(l,"class","subItem")},m(d,_){q(d,l,_),f[n].m(l,null),a(l,r),u=!0},p(d,_){let h=n;n=p(d,_),n===h?f[n].p(d,_):(Jt(),fe(f[h],1,1,()=>{f[h]=null}),zt(),s=f[n],s?s.p(d,_):(s=f[n]=c[n](d),s.c()),ie(s,1),s.m(l,r))},i(d){u||(ie(s),u=!0)},o(d){fe(s),u=!1},d(d){d&&o(l),f[n].d()}}}function ln(e){var n;let l,t=((n=e[37].types[e[69]])==null?void 0:n.name)+"",i;return{c(){l=B("Could not find industry details for "),i=B(t)},l(s){l=w(s,"Could not find industry details for "),i=w(s,t)},m(s,r){q(s,l,r),q(s,i,r)},p(s,r){var u;r[0]&4096|r[1]&64&&t!==(t=((u=s[37].types[s[69]])==null?void 0:u.name)+"")&&Z(i,t)},i:Se,o:Se,d(s){s&&o(l),s&&o(i)}}}function rn(e){let l,t;return l=new Br({props:{productTypeId:e[69],requiredQuantity:e[18](e[12].materials[e[69]].quantity)}}),{c(){et(l.$$.fragment)},l(i){tt(l.$$.fragment,i)},m(i,n){lt(l,i,n),t=!0},p(i,n){const s={};n[0]&4096&&(s.productTypeId=i[69]),n[0]&266240&&(s.requiredQuantity=i[18](i[12].materials[i[69]].quantity)),l.$set(s)},i(i){t||(ie(l.$$.fragment,i),t=!0)},o(i){fe(l.$$.fragment,i),t=!1},d(i){it(l,i)}}}function sn(e){let l,t,i;function n(r){e[68](r,e[69])}let s={selectedProductId:e[69],requiredQuantity:e[18](e[12].materials[e[69]].quantity),producedItems:e[2],materialEfficiency:10,timeEfficiency:20,selectedLocationId:e[4],compact:!0};return e[19][e[69]]!==void 0&&(s.unitCost=e[19][e[69]]),l=new Nr({props:s}),De.push(()=>Be(l,"unitCost",n)),{c(){et(l.$$.fragment)},l(r){tt(l.$$.fragment,r)},m(r,u){lt(l,r,u),i=!0},p(r,u){e=r;const c={};u[0]&4096&&(c.selectedProductId=e[69]),u[0]&266240&&(c.requiredQuantity=e[18](e[12].materials[e[69]].quantity)),u[0]&4&&(c.producedItems=e[2]),u[0]&16&&(c.selectedLocationId=e[4]),!t&&u[0]&528384&&(t=!0,c.unitCost=e[19][e[69]],we(()=>t=!1)),l.$set(c)},i(r){i||(ie(l.$$.fragment,r),i=!0)},o(r){fe(l.$$.fragment,r),i=!1},d(r){it(l,r)}}}function Sr(e){var W;let l,t,i,n,s,r,u=((W=e[37].types[e[69]])==null?void 0:W.name)+"",c,f,p,d,_=e[18](e[12].materials[e[69]].quantity)+"",h,m,v,k,S,y,P,D,N,M;function b(){e[66].call(i,e[69])}function R(j){e[67](j,e[69])}let G={extents:e[32],quantity:e[18](e[12].materials[e[69]].quantity),type_id:e[69],overridePrice:e[19][e[69]],buyOverheadRate:e[7],totalCost:e[19][e[69]]?e[19][e[69]]*e[18](e[12].materials[e[69]].quantity):null,compact:!0};e[20][e[69]]!==void 0&&(G.price=e[20][e[69]]),k=new il({props:G}),De.push(()=>Be(k,"price",R));let F=e[2][e[69]]&&jr(e);return{c(){l=E("div"),t=E("label"),i=E("input"),s=J(),r=E("span"),c=B(u),p=J(),d=E("div"),h=B(_),m=J(),v=E("div"),et(k.$$.fragment),y=J(),F&&F.c(),P=Te(),this.h()},l(j){l=I(j,"DIV",{class:!0});var L=O(l);t=I(L,"LABEL",{});var V=O(t);i=I(V,"INPUT",{type:!0}),s=z(V),r=I(V,"SPAN",{title:!0});var X=O(r);c=w(X,u),X.forEach(o),V.forEach(o),L.forEach(o),p=z(j),d=I(j,"DIV",{class:!0});var Y=O(d);h=w(Y,_),Y.forEach(o),m=z(j),v=I(j,"DIV",{class:!0});var le=O(v);tt(k.$$.fragment,le),le.forEach(o),y=z(j),F&&F.l(j),P=Te(),this.h()},h(){var j;T(i,"type","checkbox"),i.disabled=n=!e[33](e[69]),T(r,"title",f=`${(j=e[37].types[e[69]])==null?void 0:j.name} [${e[69]}]`),T(l,"class","itemName"),T(d,"class","qty"),T(v,"class","graph")},m(j,L){q(j,l,L),a(l,t),a(t,i),i.checked=e[2][e[69]],a(t,s),a(t,r),a(r,c),q(j,p,L),q(j,d,L),a(d,h),q(j,m,L),q(j,v,L),lt(k,v,null),q(j,y,L),F&&F.m(j,L),q(j,P,L),D=!0,N||(M=ye(i,"change",b),N=!0)},p(j,L){var X,Y;e=j,(!D||L[0]&4096|L[1]&4&&n!==(n=!e[33](e[69])))&&(i.disabled=n),L[0]&4100&&(i.checked=e[2][e[69]]),(!D||L[0]&4096|L[1]&64)&&u!==(u=((X=e[37].types[e[69]])==null?void 0:X.name)+"")&&Z(c,u),(!D||L[0]&4096|L[1]&64&&f!==(f=`${(Y=e[37].types[e[69]])==null?void 0:Y.name} [${e[69]}]`))&&T(r,"title",f),(!D||L[0]&266240)&&_!==(_=e[18](e[12].materials[e[69]].quantity)+"")&&Z(h,_);const V={};L[1]&2&&(V.extents=e[32]),L[0]&266240&&(V.quantity=e[18](e[12].materials[e[69]].quantity)),L[0]&4096&&(V.type_id=e[69]),L[0]&528384&&(V.overridePrice=e[19][e[69]]),L[0]&128&&(V.buyOverheadRate=e[7]),L[0]&790528&&(V.totalCost=e[19][e[69]]?e[19][e[69]]*e[18](e[12].materials[e[69]].quantity):null),!S&&L[0]&1052672&&(S=!0,V.price=e[20][e[69]],we(()=>S=!1)),k.$set(V),e[2][e[69]]?F?(F.p(e,L),L[0]&4100&&ie(F,1)):(F=jr(e),F.c(),ie(F,1),F.m(P.parentNode,P)):F&&(Jt(),fe(F,1,1,()=>{F=null}),zt())},i(j){D||(ie(k.$$.fragment,j),ie(F),D=!0)},o(j){fe(k.$$.fragment,j),fe(F),D=!1},d(j){j&&o(l),j&&o(p),j&&o(d),j&&o(m),j&&o(v),it(k),j&&o(y),F&&F.d(j),j&&o(P),N=!1,M()}}}function nn(e){let l,t,i,n;const s=[tn,en],r=[];function u(c,f){return c[30]?1:0}return l=u(e),t=r[l]=s[l](e),{c(){t.c(),i=Te()},l(c){t.l(c),i=Te()},m(c,f){r[l].m(c,f),q(c,i,f),n=!0},p(c,f){let p=l;l=u(c),l===p?r[l].p(c,f):(Jt(),fe(r[p],1,1,()=>{r[p]=null}),zt(),t=r[l],t?t.p(c,f):(t=r[l]=s[l](c),t.c()),ie(t,1),t.m(i.parentNode,i))},i(c){n||(ie(t),n=!0)},o(c){fe(t),n=!1},d(c){r[l].d(c),c&&o(i)}}}function un(e,l,t){let i,n,s,r,u,c,f,p,d,_,h,m=Se,v=()=>(m(),m=Ol(r,U=>t(42,h=U)),r),k,S,y,P;Ke(e,Yl,U=>t(31,_=U)),Ke(e,Ds,U=>t(43,k=U)),Ke(e,bi,U=>t(45,y=U)),Ke(e,ql,U=>t(37,P=U)),e.$$.on_destroy.push(()=>m());let D=0,{selectedProductId:N=null}=l,{salesTaxRate:M=.036}=l,{brokerFeeRate:b=.0113709973928}=l,{requiredQuantity:R=null}=l,G=1,{materialEfficiency:F=0}=l,{timeEfficiency:W=0}=l,{producedItems:j={}}=l,L=null,V=!1,{selectedLocationId:X=null}=l,Y,le,ee,ne,_e=U=>U,ve={},me={},Re=0,he=0,{unitCost:ce=null}=l,{compact:Me=!1}=l,re=!1,se=10,ze=Vl("currentCharacter");Ke(e,ze,U=>t(44,S=U));let{extents:Xe=null}=l,ge,pe,oe=[0,1e3],rt=()=>!1;function K(U){e.$$.not_equal(me[N],U)&&(me[N]=U,t(20,me))}function A(U){ge=U,t(24,ge)}function $(U){pe=U,t(25,pe)}function ue(){G=Ft(this.value),t(11,G),t(8,R),t(13,V),t(12,L),t(5,N),t(22,re),t(23,se),t(30,i),t(27,n),t(31,_)}function Ne(){G=Ft(this.value),t(11,G),t(8,R),t(13,V),t(12,L),t(5,N),t(22,re),t(23,se),t(30,i),t(27,n),t(31,_)}function ke(){V=this.checked,t(13,V)}function Le(){re=this.checked,t(22,re),t(27,n),t(31,_),t(30,i),t(5,N)}function be(U){D=U,t(10,D)}function st(U){F=U,t(0,F)}function Ae(U){W=U,t(1,W)}function Tt(U){se=U,t(23,se)}function bt(){F=Ft(this.value),t(0,F)}function x(){W=Ft(this.value),t(1,W)}function Ve(){D=Ft(this.value),t(10,D)}function Ot(U){X=U,t(4,X)}function Ue(U){Y=U,t(14,Y)}function yt(U){le=U,t(15,le)}function vt(U){ee=U,t(16,ee)}function qt(U){ne=U,t(17,ne)}const jt=U=>parseInt(U);function Ze(U){j[U]=this.checked,t(2,j),t(12,L),t(30,i),t(31,_),t(5,N)}function Qe(U,Pe){e.$$.not_equal(me[Pe],U)&&(me[Pe]=U,t(20,me))}function Ie(U,Pe){e.$$.not_equal(ve[Pe],U)&&(ve[Pe]=U,t(19,ve),t(2,j))}return e.$$set=U=>{"selectedProductId"in U&&t(5,N=U.selectedProductId),"salesTaxRate"in U&&t(6,M=U.salesTaxRate),"brokerFeeRate"in U&&t(7,b=U.brokerFeeRate),"requiredQuantity"in U&&t(8,R=U.requiredQuantity),"materialEfficiency"in U&&t(0,F=U.materialEfficiency),"timeEfficiency"in U&&t(1,W=U.timeEfficiency),"producedItems"in U&&t(2,j=U.producedItems),"selectedLocationId"in U&&t(4,X=U.selectedLocationId),"unitCost"in U&&t(3,ce=U.unitCost),"compact"in U&&t(9,Me=U.compact),"extents"in U&&t(39,Xe=U.extents)},e.$$.update=()=>{var U,Pe,nt,Ee,xe;if(e.$$.dirty[0]&32|e.$$.dirty[1]&1&&t(30,i=ri(_,N)),e.$$.dirty[0]&1073741824|e.$$.dirty[1]&1&&t(27,n=ys(_,i==null?void 0:i.type_id)),e.$$.dirty[0]&1073741824&&t(12,L=i==null?void 0:i.activities[pt]),e.$$.dirty[0]&12576&&R!==null&&!V&&L&&t(11,G=Math.ceil(R/L.products[N].quantity)),e.$$.dirty[0]&134217728&&(n||t(22,re=!1)),e.$$.dirty[0]&12582912&&re&&t(11,G=se),e.$$.dirty[0]&198657&&t(18,_e=Oe=>{var de,Ct;return Math.max(G,Math.ceil(Oe*G*(1-F/100)*(1+((de=ee==null?void 0:ee.materialConsumptionModifier)!=null?de:0)/100)*(1+((Ct=ne==null?void 0:ne.materialReductionBonus)!=null?Ct:0)/100)))}),e.$$.dirty[0]&4096|e.$$.dirty[1]&16896&&(t(40,he=0),L))for(let Oe in L.materials)t(40,he+=L.materials[Oe].quantity*((Pe=(U=y[Oe])==null?void 0:U.adjusted_price)!=null?Pe:0));if(e.$$.dirty[0]&116736|e.$$.dirty[1]&512&&t(29,s=he*Y*(1+((nt=ee==null?void 0:ee.jobCostModifier)!=null?nt:0)/100)*(1+le/100)*G),e.$$.dirty[0]&540285952&&(t(21,Re=0),L)){for(let Oe in L.materials){let de=_e(L.materials[Oe].quantity);t(21,Re+=de*me[Oe])}t(21,Re+=s),t(21,Re+=D*G)}if(e.$$.dirty[0]&524292)for(let Oe in ve)j[Oe]||t(19,ve[Oe]=void 0,ve);e.$$.dirty[1]&8192&&v(t(36,r=li[S])),e.$$.dirty[0]&4096|e.$$.dirty[1]&6144&&t(41,u=L?[...Object.values(L.requiredSkills||{}).map(Oe=>Oe.type_id),Qi].reduce((Oe,de)=>{var St,At,Xt,Ht,Dt,gt,Kt,Qt;if(k.types[de]===void 0)return Oe;let Ct=(gt=(Dt=(Xt=(St=k.types[de][440])==null?void 0:St.value)!=null?Xt:(At=k.types[de][1982])==null?void 0:At.value)!=null?Dt:(Ht=k.types[de][1961])==null?void 0:Ht.value)!=null?gt:0;return Ct*=(Qt=(Kt=h==null?void 0:h.skills.find(_t=>_t.skill_id==de))==null?void 0:Kt.active_skill_level)!=null?Qt:0,Oe*(1+Ct*.01)},1):1),e.$$.dirty[0]&202754|e.$$.dirty[1]&1024&&t(35,c=(L==null?void 0:L.time)*(1-W/100)*u*(1+((Ee=ee==null?void 0:ee.jobDurationModifier)!=null?Ee:0)/100)*(1+((xe=ne==null?void 0:ne.timeReductionBonus)!=null?xe:0)/100)*G),e.$$.dirty[0]&1048608&&t(28,f=me[N]),e.$$.dirty[0]&6176&&t(26,p=(L==null?void 0:L.products[N].quantity)*G),e.$$.dirty[0]&337641472&&t(34,d=f*p-Re),e.$$.dirty[0]&69210112&&t(3,ce=L?Re/p:null),e.$$.dirty[0]&118493224|e.$$.dirty[1]&256&&(Xe===null?L&&t(32,oe[1]=1.1*Math.max(me[N],ce,ge!=null?ge:0,pe!=null?pe:0)*p,oe):t(32,oe=Xe)),e.$$.dirty[1]&1&&t(33,rt=Oe=>ri(_,Oe)!=null||Jl(Oe,_).activity!=null)},[F,W,j,ce,X,N,M,b,R,Me,D,G,L,V,Y,le,ee,ne,_e,ve,me,Re,re,se,ge,pe,p,n,f,s,i,_,oe,rt,d,c,r,P,ze,Xe,he,u,h,k,S,y,K,A,$,ue,Ne,ke,Le,be,st,Ae,Tt,bt,x,Ve,Ot,Ue,yt,vt,qt,jt,Ze,Qe,Ie]}class Nr extends vl{constructor(l){super();gl(this,l,un,nn,kl,{selectedProductId:5,salesTaxRate:6,brokerFeeRate:7,requiredQuantity:8,materialEfficiency:0,timeEfficiency:1,producedItems:2,selectedLocationId:4,unitCost:3,compact:9,extents:39},null,[-1,-1,-1])}}function Lr(e,l,t){const i=e.slice();return i[13]=l[t].type_id,i[14]=l[t].name,i}function Vr(e,l,t){const i=e.slice();return i[17]=l[t],i[18]=l,i[19]=t,i}function Ur(e,l,t){const i=e.slice();return i[20]=l[t].market_group_id,i[14]=l[t].name,i}function Fr(e){let l,t=e[14]+"",i,n;return{c(){l=E("option"),i=B(t),this.h()},l(s){l=I(s,"OPTION",{});var r=O(l);i=w(r,t),r.forEach(o),this.h()},h(){l.__value=n=e[20],l.value=l.__value},m(s,r){q(s,l,r),a(l,i)},p(s,r){r&6&&t!==(t=s[14]+"")&&Z(i,t),r&6&&n!==(n=s[20])&&(l.__value=n,l.value=l.__value)},d(s){s&&o(l)}}}function Ar(e){let l,t,i,n,s=Object.values(e[17]).filter(e[9]),r=[];for(let f=0;f<s.length;f+=1)r[f]=Fr(Ur(e,s,f));function u(){e[10].call(l,e[19])}function c(...f){return e[11](e[17],e[19],...f)}return{c(){l=E("select");for(let f=0;f<r.length;f+=1)r[f].c();this.h()},l(f){l=I(f,"SELECT",{name:!0,class:!0});var p=O(l);for(let d=0;d<r.length;d+=1)r[d].l(p);p.forEach(o),this.h()},h(){T(l,"name",t=e[19].toString()),T(l,"class","svelte-l65zkr"),e[3][e[19]]===void 0&&Fl(u)},m(f,p){q(f,l,p);for(let d=0;d<r.length;d+=1)r[d].m(l,null);Ut(l,e[3][e[19]]),i||(n=[ye(l,"change",u),ye(l,"change",c)],i=!0)},p(f,p){if(e=f,p&6){s=Object.values(e[17]).filter(e[9]);let d;for(d=0;d<s.length;d+=1){const _=Ur(e,s,d);r[d]?r[d].p(_,p):(r[d]=Fr(_),r[d].c(),r[d].m(l,null))}for(;d<r.length;d+=1)r[d].d(1);r.length=s.length}p&14&&Ut(l,e[3][e[19]])},d(f){f&&o(l),It(r,f),i=!1,Ql(n)}}}function Qr(e){let l,t=e[14]+"",i,n;return{c(){l=E("option"),i=B(t),this.h()},l(s){l=I(s,"OPTION",{});var r=O(l);i=w(r,t),r.forEach(o),this.h()},h(){l.__value=n=e[13],l.value=l.__value},m(s,r){q(s,l,r),a(l,i)},p(s,r){r&16&&t!==(t=s[14]+"")&&Z(i,t),r&16&&n!==(n=s[13])&&(l.__value=n,l.value=l.__value)},d(s){s&&o(l)}}}function on(e){let l,t,i,n,s,r,u,c=e[2],f=[];for(let _=0;_<c.length;_+=1)f[_]=Ar(Vr(e,c,_));let p=e[4],d=[];for(let _=0;_<p.length;_+=1)d[_]=Qr(Lr(e,p,_));return{c(){l=E("p");for(let _=0;_<f.length;_+=1)f[_].c();t=J(),i=E("br"),n=B(`\r
    Item \r
    `),s=E("select");for(let _=0;_<d.length;_+=1)d[_].c();this.h()},l(_){l=I(_,"P",{});var h=O(l);for(let v=0;v<f.length;v+=1)f[v].l(h);t=z(h),i=I(h,"BR",{}),n=w(h,`\r
    Item \r
    `),s=I(h,"SELECT",{class:!0});var m=O(s);for(let v=0;v<d.length;v+=1)d[v].l(m);m.forEach(o),h.forEach(o),this.h()},h(){T(s,"class","svelte-l65zkr")},m(_,h){q(_,l,h);for(let m=0;m<f.length;m+=1)f[m].m(l,null);a(l,t),a(l,i),a(l,n),a(l,s);for(let m=0;m<d.length;m+=1)d[m].m(s,null);Ut(s,e[0]),r||(u=ye(s,"change",e[5]),r=!0)},p(_,[h]){if(h&14){c=_[2];let m;for(m=0;m<c.length;m+=1){const v=Vr(_,c,m);f[m]?f[m].p(v,h):(f[m]=Ar(v),f[m].c(),f[m].m(l,t))}for(;m<f.length;m+=1)f[m].d(1);f.length=c.length}if(h&16){p=_[4];let m;for(m=0;m<p.length;m+=1){const v=Lr(_,p,m);d[m]?d[m].p(v,h):(d[m]=Qr(v),d[m].c(),d[m].m(s,null))}for(;m<d.length;m+=1)d[m].d(1);d.length=p.length}h&17&&Ut(s,_[0])},i:Se,o:Se,d(_){_&&o(l),It(f,_),It(d,_),r=!1,u()}}}function Gr(e){if(e.child_groups===void 0)return[e.market_group_id];let l=Object.keys(e.child_groups).map(t=>parseInt(t));for(let t in e.child_groups)l=l.concat(Gr(e.child_groups[t]));return l}function an(e,l,t){let i;Ke(e,ql,k=>t(8,i=k));let n=new Set,s=[],r=[null],u=[],c=[],{selectableTypes:f=void 0}=l,{selectedTypeId:p=null}=l;const d=Zr();function _(k){d("change",parseInt(k.target.value))}const h=k=>n.has(k.market_group_id);function m(k){r[k]=Al(this),t(3,r),t(2,s),t(8,i),t(3,r),t(1,n),t(8,i),t(7,u),t(6,f)}const v=(k,S,y)=>{k[y.target.value].child_groups&&t(3,r=[...r.slice(0,S+1),null])};return e.$$set=k=>{"selectableTypes"in k&&t(6,f=k.selectableTypes),"selectedTypeId"in k&&t(0,p=k.selectedTypeId)},e.$$.update=()=>{if(e.$$.dirty&320&&i.types&&t(7,u=f||Object.values(i.types)),e.$$.dirty&408){let k=r[r.length-1]||r[r.length-2];if(k){t(4,c=[]);let S=new Set,y=new Set(u.map(D=>D.type_id)),P=Gr(i.markets.groups[k]);for(let D of P)i.markets.groups[D].types.forEach(N=>{y.has(N)&&S.add(N)});t(4,c=Array.from(S).map(D=>i.types[D]))}else t(4,c=u);c.sort((S,y)=>S.name.localeCompare(y.name))}if(e.$$.dirty&386&&i.markets&&i.types&&i.markets.groups){let k=new Set(u.map(S=>S.type_id));n.clear();for(let S in i.markets.groups){let y=i.markets.groups[S];for(let P of y.types)if(k.has(P)){let D=parseInt(S);do n.add(D),D=i.markets.groups[D].parent_group_id;while(D!==void 0)}}t(1,n),t(8,i),t(7,u),t(6,f)}if(e.$$.dirty&268&&i.markets){t(2,s=[i.markets.groupTree]);for(let k of r)k!=null&&i.markets.groups[k].child_groups&&s.push(i.markets.groups[k].child_groups)}},[p,n,s,r,c,_,f,u,i,h,m,v]}class fn extends vl{constructor(l){super();gl(this,l,an,on,kl,{selectableTypes:6,selectedTypeId:0})}}function _n(e){var P,D,N,M;let l,t,i,n,s,r,u,c,f,p,d,_,h,m;document.title=l=""+((((P=e[1])==null?void 0:P.types)&&((D=e[1])==null?void 0:D.types[e[4]])?`${(M=(N=e[1])==null?void 0:N.types[e[4]])==null?void 0:M.name} - `:"")+"EVE Online Visual Industry Calculator");function v(b){e[13](b)}let k={};e[0]!==void 0&&(k.value=e[0]),i=new ms({props:k}),De.push(()=>Be(i,"value",v));function S(b){e[14](b)}let y={allowUnselected:!0};return e[5]!==void 0&&(y.value=e[5]),u=new Ei({props:y}),De.push(()=>Be(u,"value",S)),p=new fn({props:{selectedTypeId:e[4],selectableTypes:e[2]}}),p.$on("change",e[15]),h=new Nr({props:{selectedProductId:e[4]}}),{c(){t=J(),et(i.$$.fragment),s=E("br"),r=B(`\r
Filter market `),et(u.$$.fragment),f=J(),et(p.$$.fragment),d=J(),_=E("p"),et(h.$$.fragment)},l(b){xr('[data-svelte="svelte-xymh63"]',document.head).forEach(o),t=z(b),tt(i.$$.fragment,b),s=I(b,"BR",{}),r=w(b,`\r
Filter market `),tt(u.$$.fragment,b),f=z(b),tt(p.$$.fragment,b),d=z(b),_=I(b,"P",{}),O(_).forEach(o),tt(h.$$.fragment,b)},m(b,R){q(b,t,R),lt(i,b,R),q(b,s,R),q(b,r,R),lt(u,b,R),q(b,f,R),lt(p,b,R),q(b,d,R),q(b,_,R),lt(h,b,R),m=!0},p(b,[R]){var L,V,X,Y;(!m||R&18)&&l!==(l=""+((((L=b[1])==null?void 0:L.types)&&((V=b[1])==null?void 0:V.types[b[4]])?`${(Y=(X=b[1])==null?void 0:X.types[b[4]])==null?void 0:Y.name} - `:"")+"EVE Online Visual Industry Calculator"))&&(document.title=l);const G={};!n&&R&1&&(n=!0,G.value=b[0],we(()=>n=!1)),i.$set(G);const F={};!c&&R&32&&(c=!0,F.value=b[5],we(()=>c=!1)),u.$set(F);const W={};R&16&&(W.selectedTypeId=b[4]),R&4&&(W.selectableTypes=b[2]),p.$set(W);const j={};R&16&&(j.selectedProductId=b[4]),h.$set(j)},i(b){m||(ie(i.$$.fragment,b),ie(u.$$.fragment,b),ie(p.$$.fragment,b),ie(h.$$.fragment,b),m=!0)},o(b){fe(i.$$.fragment,b),fe(u.$$.fragment,b),fe(p.$$.fragment,b),fe(h.$$.fragment,b),m=!1},d(b){b&&o(t),it(i,b),b&&o(s),b&&o(r),it(u,b),b&&o(f),it(p,b),b&&o(d),b&&o(_),it(h,b)}}}function cn(e,l,t){let i,n,s,r=Se,u=()=>(r(),r=Ol(n,b=>t(10,s=b)),n),c,f,p,d,_;Ke(e,ql,b=>t(1,f=b)),Ke(e,Yl,b=>t(11,p=b)),Ke(e,rs,b=>t(12,d=b)),e.$$.on_destroy.push(()=>r());let h=null;const m=[60003760,1028858195912];let v=[],k=Ml({}),S=!1;Si(()=>{t(9,S=!0)}),ci(()=>{v.forEach(b=>b&&b())}),hi("locations",k);let y=Ml(null);Ke(e,y,b=>t(5,_=b)),hi("marketFilterLocation",y);let P=Ml(null);Ke(e,P,b=>t(0,c=b)),hi("currentCharacter",P);function D(b){c=b,P.set(c)}function N(b){_=b,y.set(_)}const M=b=>{ts(`${b.detail}`,{keepfocus:!0})};return e.$$.update=()=>{if(e.$$.dirty&4096&&t(4,i=parseInt(d.params.type)||null),e.$$.dirty&2050&&p.types&&f.types){let b=function(G){var F,W;return Object.keys((W=(F=p.types[G].activities[pt])==null?void 0:F.products)!=null?W:{}).map(j=>parseInt(j))},R=[];Object.values(p.types).forEach(G=>{R=[...R,...b(G.type_id)]}),t(2,h=R.filter(G=>f.types[G]!==void 0).map(G=>f.types[G]))}if(e.$$.dirty&1&&u(t(3,n=Vi[c])),e.$$.dirty&1792&&S){v.forEach(G=>G()),t(8,v=[]);let b={};k.set(b),s==null||s.forEach(G=>{b[G.location_id]=null}),m.forEach(G=>b[G]=null),Object.keys(b).forEach(G=>{let F=cs(parseInt(G)).subscribe(W=>{b[G]=W,k.set(b)});typeof F=="function"&&v.push(F)})}},[c,f,h,n,i,_,y,P,v,S,s,p,d,D,N,M]}class mn extends vl{constructor(l){super();gl(this,l,cn,_n,kl,{})}}export{mn as default};
