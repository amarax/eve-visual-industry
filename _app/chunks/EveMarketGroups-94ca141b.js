var xe=Object.defineProperty,$e=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable;var he=(l,t,e)=>t in l?xe(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,H=(l,t)=>{for(var e in t||(t={}))tt.call(t,e)&&he(l,e,t[e]);if(me)for(var e of me(t))lt.call(t,e)&&he(l,e,t[e]);return l},ue=(l,t)=>$e(l,et(t));import{V as J,W as be,C as ae,X as Q,S as it,i as ot,s as st,e as R,c as B,a as w,d as y,f as S,t as D,g as T,D as d,h as P,G as X,b as F,k as Y,n as V,l as W,I as te,E as rt,F as ye,H as ce,L as fe,Y as nt,M as ut,K as at}from"./vendor-dd7e5550.js";import{b as le}from"./paths-28a87002.js";async function de(l,t){let e=new URL(`https://esi.evetech.net/${t&&t.dev?"dev":"latest"}${l}`);const i=await fetch(e.toString(),{method:"GET",headers:{accept:"application/json"}}),r=await i.json();if(i.ok){let o=i.headers.get("X-Pages");return o&&parseInt(o)>1&&console.log("More pages were available but not retrieved",e.toString()),r}return Promise.reject(i)}async function ct(){const l=await fetch(`${le}/eve-sde/categories.json`,{method:"GET",headers:{accept:"application/json"}}),t=await l.json();return l.ok?t:Promise.reject(l)}async function ft(){let l;try{l=await K("invMarketGroups")}catch(i){console.error(i)}let t={groups:{},groupTree:{}};l.forEach(i=>{t.groups[i.market_group_id]=i,i.types=[],i.parent_group_id=="None"&&delete i.parent_group_id});let e={};for(let i in t.groups){let r=t.groups[i];if(r.parent_group_id){let o=t.groups[r.parent_group_id];o.child_groups===void 0&&(o.child_groups={}),o.child_groups[i]=r}}for(let i in t.groups){let r=t.groups[i];r.parent_group_id===void 0&&(e[r.market_group_id]=r)}return t.groupTree=e,t}function K(l){let t=i=>({header:!0,dynamicTyping:!0,complete:async r=>{i(r.data)}}),e=`${le}/eve-sde/${l}.csv`;return new Promise(i=>{be.parse(e,H({download:!0},t(i)))})}async function dt(l){return new Promise(t=>{be.parse(`${le}/eve-sde/types.csv`,{download:!0,header:!0,dynamicTyping:!0,complete:async(e,i)=>{let r={};for(let o of e.data)o.published?(r[o.type_id]=o,o.market_group_id==="None"?delete o.market_group_id:l[o.market_group_id].types.push(o.type_id)):delete r[o.type_id];t(r)}})})}let ie={},ve=!1;function _t(l){if(ve)return()=>{};const t={categories:null,types:ie,markets:null};return l(t),ct().then(e=>{t.categories=e,l(t)}).catch(e=>{console.error(e)}),ft().then(e=>{t.markets=e,l(t),dt(e.groups).then(i=>{ie=i,t.types=ie,l(t),ve=!0}).catch(i=>{console.error(i)})}).catch(e=>{console.error(e)}),()=>{}}async function Ut(l){try{let t=await de(`/universe/types/${l}/`);return ie[l]=t,t}catch(t){console.error(t)}}const pt=J({types:{}},_t);J({},mt);function mt(l){return l({attributes:null}),()=>{}}let oe={};function ht(){const{subscribe:l,update:t}=ae({});return{subscribe:l,update:e=>t(i=>{for(let r in e)i[r]===void 0&&(i[r]={}),Object.assign(i[r],e[r]);return i})}}const ge=ht();function se(l){return 6e7<=l&&l<7e7}function qt(l){return oe[l]===void 0&&(se(l)?oe[l]=Te(`/universe/stations/${l}/`):oe[l]=bt(`/universe/structures/${l}/`)),oe[l]}var De;(function(l){l[l.loading=0]="loading",l[l.loaded=1]="loaded",l[l.error=2]="error"})(De||(De={}));function Te(l,t){let e={status:0,subscribe:null};function i(o){return e.status!==1&&de(l).then(s=>{t&&(s=t(s)),e.status=1,o(s)}).catch(s=>{e.status=2,o(null),console.error(s)}),()=>{}}const{subscribe:r}=ae(null,i);return e.subscribe=r,e}function bt(l,t){let e={status:0,subscribe:null};function i(o){return e.status!==1&&fetch(`${le}/esi-cache${l}index.json`).then(s=>s.ok?s.json():Promise.reject("Fetch failed")).then(s=>{t&&(s=t(s)),e.status=1,o(s)}).catch(s=>{e.status=2,o(null),console.error(s)}),()=>{}}const{subscribe:r}=ae(null,i);return e.subscribe=r,e}let re=new Map,Ie=J(re,l=>{re.size===0&&K("types").then(t=>{t=t.filter(e=>e.type_id),re=new Map(t.map(e=>[e.type_id,e])),l(re)})}),x=new Map;const yt=Q(Ie,(l,t)=>{x.clear(),l.forEach((e,i)=>{x.has(e.market_group_id)||x.set(e.market_group_id,[]),x.get(e.market_group_id).push(i)}),t(x)}),U=1,vt=8,G=11;let ke=!1;function gt(l){if(ke)return()=>{};let t={activities:{},types:{}};return K("ramActivities").then(e=>{e.filter(i=>i.activityID).forEach(i=>t.activities[i.activityID]=i)}).then(()=>K("industryActivity")).then(e=>{e.forEach(i=>{if(i.type_id===null)return;let r=t.types[i.type_id];r===void 0&&(r={type_id:i.type_id,activities:{}},t.types[i.type_id]=r),r.activities[i.activityID]={activity:t.activities[i.activityID],time:i.time,materials:{},products:{}}})}).then(()=>K("industryActivityMaterials")).then(e=>{e.forEach(i=>{if(i.typeID===null)return;let r=t.types[i.typeID];console.assert(r!==void 0,i);let o=r.activities[i.activityID].materials;console.assert(o instanceof Object),o[i.materialTypeID]={materialTypeID:i.materialTypeID,quantity:i.quantity}})}).then(()=>K("industryActivityProducts")).then(e=>{e.forEach(i=>{if(i.type_id===null)return;let r=t.types[i.type_id].activities[i.activityID];r.products[i.productTypeID]={type_id:i.productTypeID,quantity:i.quantity}})}).then(()=>K("industryActivityProbabilities")).then(e=>{e.forEach(i=>{if(i.typeID===null)return;let r=t.types[i.typeID].activities[i.activityID];r.products[i.productTypeID].probability=i.probability})}).then(()=>K("industryActivitySkills")).then(e=>{e.forEach(i=>{if(i.typeID===null)return;let r=t.types[i.typeID].activities[i.activityID];r.requiredSkills===void 0&&(r.requiredSkills={}),r.requiredSkills[i.skillID]={type_id:i.skillID,level:i.level}})}).then(()=>K("industryBlueprints")).then(e=>{e.forEach(i=>t.types[i.type_id].maxProductionLimit=i.maxProductionLimit),l(t),ke=!0}).catch(e=>console.error(e)),l(t),()=>{}}const Ee=J(null,gt);function Dt(l,t){return Object.values(l.types).find(e=>{var i;return(i=e.activities[U])==null?void 0:i.products[t]})}function Yt(l,t){return Object.values(l.types).find(e=>{var i;return(i=e.activities[vt])==null?void 0:i.products[t]})}const Vt=Q(pt,(l,t)=>(Tt(l).then(e=>t(e)),()=>{}),{});async function Tt(l){const t=1873;let e=Object.keys(l.types).filter(r=>l.types[r].market_group_id==t),i={};try{for(let r of e)i[r]=await de(`/universe/types/${r}/`)}catch(r){console.error(r)}return i}const Kt=3388,It=Te("/industry/systems/"),kt={manufacturing:1,researching_time_efficiency:3,researching_material_efficiency:4,copying:5,invention:8,reaction:11};function Et(l,t,e){var i,r;return(r=(i=l==null?void 0:l.find(o=>{var s;return o.solar_system_id===((s=t==null?void 0:t.solar_system_id)!=null?s:t==null?void 0:t.system_id)}))==null?void 0:i.cost_indices.find(o=>kt[o.activity]==e))==null?void 0:r.cost_index}function Ct(l,t){let e=Object.values(t.types).find(i=>{var r;return(r=i.activities[G])==null?void 0:r.products[l]});return{type:e,activity:e==null?void 0:e.activities[G]}}function zt(l,t){return Dt(t,l)!=null||Ct(l,t).activity!=null}const Mt=[U,G],Rt=Q([Ee,Ie],([l,t])=>{var i;let e=new Map;for(const r in l.types)!((i=t.get(parseInt(r)))==null?void 0:i.published)||Object.keys(l.types[r].activities).filter(o=>Mt.includes(parseInt(o))).forEach(o=>{for(const s in l.types[r].activities[o].products)e.has(parseInt(s))&&console.warn("Product already produced in activity",s,l.types[r],o),e.set(parseInt(s),{type:l.types[r],activity:l.types[r].activities[o]})});return e});let $="en-US";const Ce={useGrouping:!0,maximumFractionDigits:2,minimumFractionDigits:2},Ht=new Intl.NumberFormat($,H({},Ce)).format,Xt=new Intl.NumberFormat($,ue(H({},Ce),{signDisplay:"always"})).format;let _e=new Intl.NumberFormat($,{minimumIntegerDigits:2}).format;function Wt(l){let t=Math.ceil(l%60),e=Math.floor(l%(60*60)/60),i=Math.floor(l%(24*60*60)/(60*60)),r=Math.floor(l/(24*60*60)),o=`${_e(i)}:${_e(e)}:${_e(t)}`;return r>0&&(o=`${r}d `+o),o}const Me={style:"percent",minimumFractionDigits:3,maximumFractionDigits:3},ne=new Intl.NumberFormat($,H({},Me)).format,Zt=new Intl.NumberFormat($,ue(H({},Me),{signDisplay:"always"})).format;function Re(l,t,e){const i=l.slice();return i[27]=t[e],i}function Be(l,t,e){const i=l.slice();return i[27]=t[e],i}function je(l,t,e){const i=l.slice();return i[27]=t[e],i}function we(l,t,e){const i=l.slice();return i[34]=t[e],i}function Se(l){let t,e;return{c(){t=R("option"),this.h()},l(i){t=B(i,"OPTION",{}),w(t).forEach(y),this.h()},h(){t.__value=e=null,t.value=t.__value},m(i,r){S(i,t,r)},d(i){i&&y(t)}}}function Ne(l){var o;let t,e=((o=l[34].name)!=null?o:l[34].location_id)+"",i,r;return{c(){t=R("option"),i=D(e),this.h()},l(s){t=B(s,"OPTION",{});var n=w(t);i=T(n,e),n.forEach(y),this.h()},h(){t.__value=r=l[34].location_id,t.value=t.__value},m(s,n){S(s,t,n),d(t,i)},p(s,n){var h;n[0]&1024&&e!==(e=((h=s[34].name)!=null?h:s[34].location_id)+"")&&P(i,e),n[0]&1024&&r!==(r=s[34].location_id)&&(t.__value=r,t.value=t.__value)},d(s){s&&y(t)}}}function Oe(l){let t,e=(l[5]?"+":"-")+"",i,r,o;return{c(){t=R("button"),i=D(e)},l(s){t=B(s,"BUTTON",{});var n=w(t);i=T(n,e),n.forEach(y)},m(s,n){S(s,t,n),d(t,i),r||(o=X(t,"click",l[22]),r=!0)},p(s,n){n[0]&32&&e!==(e=(s[5]?"+":"-")+"")&&P(i,e)},d(s){s&&y(t),r=!1,o()}}}function Le(l){let t,e,i,r,o,s=ne(l[1])+"",n,h,u,c=l[9].activityName+"",M,_,E,I,p=l[8]&&Pe(l);return{c(){t=R("div"),e=R("dl"),i=R("dt"),r=D("System cost index"),o=R("dd"),n=D(s),h=R("dt"),u=D("Tax for "),M=D(c),_=R("dd"),E=D(l[3]),I=D("%"),p&&p.c(),this.h()},l(f){t=B(f,"DIV",{class:!0});var v=w(t);e=B(v,"DL",{});var g=w(e);i=B(g,"DT",{});var C=w(i);r=T(C,"System cost index"),C.forEach(y),o=B(g,"DD",{});var O=w(o);n=T(O,s),O.forEach(y),h=B(g,"DT",{});var k=w(h);u=T(k,"Tax for "),M=T(k,c),k.forEach(y),_=B(g,"DD",{});var a=w(_);E=T(a,l[3]),I=T(a,"%"),a.forEach(y),p&&p.l(g),g.forEach(y),v.forEach(y),this.h()},h(){F(t,"class","overlay")},m(f,v){S(f,t,v),d(t,e),d(e,i),d(i,r),d(e,o),d(o,n),d(e,h),d(h,u),d(h,M),d(e,_),d(_,E),d(_,I),p&&p.m(e,null)},p(f,v){v[0]&2&&s!==(s=ne(f[1])+"")&&P(n,s),v[0]&512&&c!==(c=f[9].activityName+"")&&P(M,c),v[0]&8&&P(E,f[3]),f[8]?p?p.p(f,v):(p=Pe(f),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},d(f){f&&y(t),p&&p.d()}}}function Pe(l){let t,e,i,r,o=l[2].materialConsumptionModifier+"",s,n,h=l[2].jobCostModifier+"",u,c,M=l[2].jobDurationModifier+"",_,E,I,p,f,v,g,C=l[4].timeReductionBonus+"",O,k,a=(l[7]===U||l[7]===G)&&Fe(l),m=l[7]!==U&&l[7]!==G&&Ge(l);return{c(){t=R("dt"),e=D("Structure role bonuses"),i=R("dd"),r=D("ME "),s=D(o),n=D("% | Cost "),u=D(h),c=D("% | TE "),_=D(M),E=D("%"),I=R("dt"),p=D("Structure rig bonuses"),f=R("dd"),a&&a.c(),v=Y(),m&&m.c(),g=D(`\r
                | TE `),O=D(C),k=D("%"),this.h()},l(b){t=B(b,"DT",{class:!0});var N=w(t);e=T(N,"Structure role bonuses"),N.forEach(y),i=B(b,"DD",{class:!0});var L=w(i);r=T(L,"ME "),s=T(L,o),n=T(L,"% | Cost "),u=T(L,h),c=T(L,"% | TE "),_=T(L,M),E=T(L,"%"),L.forEach(y),I=B(b,"DT",{class:!0});var A=w(I);p=T(A,"Structure rig bonuses"),A.forEach(y),f=B(b,"DD",{class:!0});var z=w(f);a&&a.l(z),v=V(z),m&&m.l(z),g=T(z,`\r
                | TE `),O=T(z,C),k=T(z,"%"),z.forEach(y),this.h()},h(){F(t,"class","full-width"),F(i,"class","full-width"),F(I,"class","full-width"),F(f,"class","full-width")},m(b,N){S(b,t,N),d(t,e),S(b,i,N),d(i,r),d(i,s),d(i,n),d(i,u),d(i,c),d(i,_),d(i,E),S(b,I,N),d(I,p),S(b,f,N),a&&a.m(f,null),d(f,v),m&&m.m(f,null),d(f,g),d(f,O),d(f,k)},p(b,N){N[0]&4&&o!==(o=b[2].materialConsumptionModifier+"")&&P(s,o),N[0]&4&&h!==(h=b[2].jobCostModifier+"")&&P(u,h),N[0]&4&&M!==(M=b[2].jobDurationModifier+"")&&P(_,M),b[7]===U||b[7]===G?a?a.p(b,N):(a=Fe(b),a.c(),a.m(f,v)):a&&(a.d(1),a=null),b[7]!==U&&b[7]!==G?m?m.p(b,N):(m=Ge(b),m.c(),m.m(f,g)):m&&(m.d(1),m=null),N[0]&16&&C!==(C=b[4].timeReductionBonus+"")&&P(O,C)},d(b){b&&y(t),b&&y(i),b&&y(I),b&&y(f),a&&a.d(),m&&m.d()}}}function Fe(l){let t,e=l[4].materialReductionBonus+"",i,r;return{c(){t=D("ME "),i=D(e),r=D("%")},l(o){t=T(o,"ME "),i=T(o,e),r=T(o,"%")},m(o,s){S(o,t,s),S(o,i,s),S(o,r,s)},p(o,s){s[0]&16&&e!==(e=o[4].materialReductionBonus+"")&&P(i,e)},d(o){o&&y(t),o&&y(i),o&&y(r)}}}function Ge(l){let t,e=l[4].costReductionBonus+"",i,r;return{c(){t=D("Cost "),i=D(e),r=D("%")},l(o){t=T(o,"Cost "),i=T(o,e),r=T(o,"%")},m(o,s){S(o,t,s),S(o,i,s),S(o,r,s)},p(o,s){s[0]&16&&e!==(e=o[4].costReductionBonus+"")&&P(i,e)},d(o){o&&y(t),o&&y(i),o&&y(r)}}}function Ae(l){let t,e,i,r,o=ne(l[1])+"",s,n,h,u=l[9].activityName+"",c,M,_,E,I,p,f,v,g,C,O,k=l[8]&&Ue(l);return{c(){t=R("dl"),e=R("dt"),i=D("System cost index"),r=R("dd"),s=D(o),n=R("dt"),h=D("Tax for "),c=D(u),M=R("dd"),_=R("input"),v=Y(),g=D(l[3]),k&&k.c(),this.h()},l(a){t=B(a,"DL",{});var m=w(t);e=B(m,"DT",{});var b=w(e);i=T(b,"System cost index"),b.forEach(y),r=B(m,"DD",{});var N=w(r);s=T(N,o),N.forEach(y),n=B(m,"DT",{});var L=w(n);h=T(L,"Tax for "),c=T(L,u),L.forEach(y),M=B(m,"DD",{});var A=w(M);_=B(A,"INPUT",{type:!0,min:!0,max:!0,step:!0}),v=V(A),g=T(A,l[3]),A.forEach(y),k&&k.l(m),m.forEach(y),this.h()},h(){F(_,"type","range"),F(_,"min",E=0),F(_,"max",I=20),F(_,"step",p=.5),_.value=l[3],_.disabled=f=se(l[0])},m(a,m){S(a,t,m),d(t,e),d(e,i),d(t,r),d(r,s),d(t,n),d(n,h),d(n,c),d(t,M),d(M,_),d(M,v),d(M,g),k&&k.m(t,null),C||(O=X(_,"input",l[12]),C=!0)},p(a,m){m[0]&2&&o!==(o=ne(a[1])+"")&&P(s,o),m[0]&512&&u!==(u=a[9].activityName+"")&&P(c,u),m[0]&8&&(_.value=a[3]),m[0]&1025&&f!==(f=se(a[0]))&&(_.disabled=f),m[0]&8&&P(g,a[3]),a[8]?k?k.p(a,m):(k=Ue(a),k.c(),k.m(t,null)):k&&(k.d(1),k=null)},d(a){a&&y(t),k&&k.d(),C=!1,O()}}}function Ue(l){let t,e,i,r,o=l[2].materialConsumptionModifier+"",s,n,h=l[2].jobCostModifier+"",u,c,M=l[2].jobDurationModifier+"",_,E,I,p,f,v,g=(l[7]===U||l[7]===G)&&qe(l),C=l[7]!==U&&l[7]!==G&&Ve(l),O=l[14],k=[];for(let a=0;a<O.length;a+=1)k[a]=ze(Re(l,O,a));return{c(){t=R("dt"),e=D("Structure role bonuses"),i=R("dd"),r=D("ME "),s=D(o),n=D("% | Cost "),u=D(h),c=D("% | TE "),_=D(M),E=D("%"),g&&g.c(),I=W(),C&&C.c(),p=R("dt"),f=D("Structure rig duration bonus"),v=R("dd");for(let a=0;a<k.length;a+=1)k[a].c()},l(a){t=B(a,"DT",{});var m=w(t);e=T(m,"Structure role bonuses"),m.forEach(y),i=B(a,"DD",{});var b=w(i);r=T(b,"ME "),s=T(b,o),n=T(b,"% | Cost "),u=T(b,h),c=T(b,"% | TE "),_=T(b,M),E=T(b,"%"),b.forEach(y),g&&g.l(a),I=W(),C&&C.l(a),p=B(a,"DT",{});var N=w(p);f=T(N,"Structure rig duration bonus"),N.forEach(y),v=B(a,"DD",{});var L=w(v);for(let A=0;A<k.length;A+=1)k[A].l(L);L.forEach(y)},m(a,m){S(a,t,m),d(t,e),S(a,i,m),d(i,r),d(i,s),d(i,n),d(i,u),d(i,c),d(i,_),d(i,E),g&&g.m(a,m),S(a,I,m),C&&C.m(a,m),S(a,p,m),d(p,f),S(a,v,m);for(let b=0;b<k.length;b+=1)k[b].m(v,null)},p(a,m){if(m[0]&4&&o!==(o=a[2].materialConsumptionModifier+"")&&P(s,o),m[0]&4&&h!==(h=a[2].jobCostModifier+"")&&P(u,h),m[0]&4&&M!==(M=a[2].jobDurationModifier+"")&&P(_,M),a[7]===U||a[7]===G?g?g.p(a,m):(g=qe(a),g.c(),g.m(I.parentNode,I)):g&&(g.d(1),g=null),a[7]!==U&&a[7]!==G?C?C.p(a,m):(C=Ve(a),C.c(),C.m(p.parentNode,p)):C&&(C.d(1),C=null),m[0]&16400){O=a[14];let b;for(b=0;b<O.length;b+=1){const N=Re(a,O,b);k[b]?k[b].p(N,m):(k[b]=ze(N),k[b].c(),k[b].m(v,null))}for(;b<k.length;b+=1)k[b].d(1);k.length=O.length}},d(a){a&&y(t),a&&y(i),g&&g.d(a),a&&y(I),C&&C.d(a),a&&y(p),a&&y(v),te(k,a)}}}function qe(l){let t,e,i,r,o=l[13],s=[];for(let n=0;n<o.length;n+=1)s[n]=Ye(je(l,o,n));return{c(){t=R("dt"),e=D("Structure rig material bonus"),i=R("dd");for(let n=0;n<s.length;n+=1)s[n].c();r=Y()},l(n){t=B(n,"DT",{});var h=w(t);e=T(h,"Structure rig material bonus"),h.forEach(y),i=B(n,"DD",{});var u=w(i);for(let c=0;c<s.length;c+=1)s[c].l(u);r=V(u),u.forEach(y)},m(n,h){S(n,t,h),d(t,e),S(n,i,h);for(let u=0;u<s.length;u+=1)s[u].m(i,null);d(i,r)},p(n,h){if(h[0]&8208){o=n[13];let u;for(u=0;u<o.length;u+=1){const c=je(n,o,u);s[u]?s[u].p(c,h):(s[u]=Ye(c),s[u].c(),s[u].m(i,r))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}},d(n){n&&y(t),n&&y(i),te(s,n)}}}function Ye(l){let t,e,i,r=l[27]+"",o,s,n,h;return{c(){t=R("label"),e=R("input"),i=Y(),o=D(r),s=D("%"),this.h()},l(u){t=B(u,"LABEL",{});var c=w(t);e=B(c,"INPUT",{type:!0,name:!0}),i=V(c),o=T(c,r),s=T(c,"%"),c.forEach(y),this.h()},h(){F(e,"type","radio"),F(e,"name","MEBonus"),e.__value=l[27],e.value=e.__value,l[24][0].push(e)},m(u,c){S(u,t,c),d(t,e),e.checked=e.__value===l[4].materialReductionBonus,d(t,i),d(t,o),d(t,s),n||(h=X(e,"change",l[23]),n=!0)},p(u,c){c[0]&16&&(e.checked=e.__value===u[4].materialReductionBonus)},d(u){u&&y(t),l[24][0].splice(l[24][0].indexOf(e),1),n=!1,h()}}}function Ve(l){let t,e,i,r,o=l[15],s=[];for(let n=0;n<o.length;n+=1)s[n]=Ke(Be(l,o,n));return{c(){t=R("dt"),e=D("Structure rig cost bonus"),i=R("dd");for(let n=0;n<s.length;n+=1)s[n].c();r=Y()},l(n){t=B(n,"DT",{});var h=w(t);e=T(h,"Structure rig cost bonus"),h.forEach(y),i=B(n,"DD",{});var u=w(i);for(let c=0;c<s.length;c+=1)s[c].l(u);r=V(u),u.forEach(y)},m(n,h){S(n,t,h),d(t,e),S(n,i,h);for(let u=0;u<s.length;u+=1)s[u].m(i,null);d(i,r)},p(n,h){if(h[0]&32784){o=n[15];let u;for(u=0;u<o.length;u+=1){const c=Be(n,o,u);s[u]?s[u].p(c,h):(s[u]=Ke(c),s[u].c(),s[u].m(i,r))}for(;u<s.length;u+=1)s[u].d(1);s.length=o.length}},d(n){n&&y(t),n&&y(i),te(s,n)}}}function Ke(l){let t,e,i,r=l[27]+"",o,s,n,h;return{c(){t=R("label"),e=R("input"),i=Y(),o=D(r),s=D("%"),this.h()},l(u){t=B(u,"LABEL",{});var c=w(t);e=B(c,"INPUT",{type:!0,name:!0}),i=V(c),o=T(c,r),s=T(c,"%"),c.forEach(y),this.h()},h(){F(e,"type","radio"),F(e,"name","CostBonus"),e.__value=l[27],e.value=e.__value,l[24][1].push(e)},m(u,c){S(u,t,c),d(t,e),e.checked=e.__value===l[4].costReductionBonus,d(t,i),d(t,o),d(t,s),n||(h=X(e,"change",l[25]),n=!0)},p(u,c){c[0]&16&&(e.checked=e.__value===u[4].costReductionBonus)},d(u){u&&y(t),l[24][1].splice(l[24][1].indexOf(e),1),n=!1,h()}}}function ze(l){let t,e,i,r=l[27]+"",o,s,n,h;return{c(){t=R("label"),e=R("input"),i=Y(),o=D(r),s=D("%"),this.h()},l(u){t=B(u,"LABEL",{});var c=w(t);e=B(c,"INPUT",{type:!0,name:!0}),i=V(c),o=T(c,r),s=T(c,"%"),c.forEach(y),this.h()},h(){F(e,"type","radio"),F(e,"name","TEBonus"),e.__value=l[27],e.value=e.__value,l[24][2].push(e)},m(u,c){S(u,t,c),d(t,e),e.checked=e.__value===l[4].timeReductionBonus,d(t,i),d(t,o),d(t,s),n||(h=X(e,"change",l[26]),n=!0)},p(u,c){c[0]&16&&(e.checked=e.__value===u[4].timeReductionBonus)},d(u){u&&y(t),l[24][2].splice(l[24][2].indexOf(e),1),n=!1,h()}}}function Bt(l){let t,e,i,r,o,s,n,h,u,c=l[6]&&Se(),M=l[10],_=[];for(let f=0;f<M.length;f+=1)_[f]=Ne(we(l,M,f));let E=l[9]&&Oe(l),I=l[9]&&l[5]&&Le(l),p=l[9]&&!l[5]&&Ae(l);return{c(){t=R("span"),e=R("select"),c&&c.c(),i=W();for(let f=0;f<_.length;f+=1)_[f].c();r=Y(),E&&E.c(),o=Y(),I&&I.c(),s=Y(),p&&p.c(),n=W(),this.h()},l(f){t=B(f,"SPAN",{class:!0});var v=w(t);e=B(v,"SELECT",{class:!0});var g=w(e);c&&c.l(g),i=W();for(let C=0;C<_.length;C+=1)_[C].l(g);g.forEach(y),r=V(v),E&&E.l(v),o=V(v),I&&I.l(v),v.forEach(y),s=V(f),p&&p.l(f),n=W(),this.h()},h(){F(e,"class","svelte-1kq2d5g"),l[0]===void 0&&rt(()=>l[21].call(e)),F(t,"class","overlay-parent svelte-1kq2d5g")},m(f,v){S(f,t,v),d(t,e),c&&c.m(e,null),d(e,i);for(let g=0;g<_.length;g+=1)_[g].m(e,null);ye(e,l[0]),d(t,r),E&&E.m(t,null),d(t,o),I&&I.m(t,null),S(f,s,v),p&&p.m(f,v),S(f,n,v),h||(u=X(e,"change",l[21]),h=!0)},p(f,v){if(f[6]?c||(c=Se(),c.c(),c.m(e,i)):c&&(c.d(1),c=null),v[0]&1024){M=f[10];let g;for(g=0;g<M.length;g+=1){const C=we(f,M,g);_[g]?_[g].p(C,v):(_[g]=Ne(C),_[g].c(),_[g].m(e,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=M.length}v[0]&1025&&ye(e,f[0]),f[9]?E?E.p(f,v):(E=Oe(f),E.c(),E.m(t,o)):E&&(E.d(1),E=null),f[9]&&f[5]?I?I.p(f,v):(I=Le(f),I.c(),I.m(t,null)):I&&(I.d(1),I=null),f[9]&&!f[5]?p?p.p(f,v):(p=Ae(f),p.c(),p.m(n.parentNode,n)):p&&(p.d(1),p=null)},i:ce,o:ce,d(f){f&&y(t),c&&c.d(),te(_,f),E&&E.d(),I&&I.d(),f&&y(s),p&&p.d(f),f&&y(n),h=!1,u()}}}const pe=.01,jt=35825,wt=35826,St=35827,Nt=35835,He=10;function Ot(l,t,e){let i,r,o,s,n=ce,h=()=>(n(),n=ut(i,j=>e(17,s=j)),i),u,c,M;fe(l,ge,j=>e(18,u=j)),fe(l,It,j=>e(19,c=j)),fe(l,Ee,j=>e(20,M=j)),l.$$.on_destroy.push(()=>n());let{value:_=null}=t,{allowUnselected:E=!1}=t,{selectedLocation:I=null}=t,{activity:p=null}=t,{activitySystemCostIndex:f=pe}=t,{structureRoleBonuses:v=null}=t,{activityTax:g=He}=t;function C(j){let q={};q[_]={},q[_][p]=parseFloat(j.target.value),ge.update(q)}const O=[0,-2,-2.4],k=[0,-20,-24],a=[0,-10,-12];let{structureRigBonuses:m=null}=t,{collapsed:b=!0}=t,N=[];const L=[[],[],[]];function A(){_=at(this),e(0,_),e(6,E),e(17,s),e(10,N),e(17,s)}const z=()=>{e(5,b=!b)};function Ze(){m.materialReductionBonus=this.__value,e(4,m),e(8,o),e(16,I),e(0,_),e(17,s),e(6,E)}function Je(){m.costReductionBonus=this.__value,e(4,m),e(8,o),e(16,I),e(0,_),e(17,s),e(6,E)}function Qe(){m.timeReductionBonus=this.__value,e(4,m),e(8,o),e(16,I),e(0,_),e(17,s),e(6,E)}return l.$$set=j=>{"value"in j&&e(0,_=j.value),"allowUnselected"in j&&e(6,E=j.allowUnselected),"selectedLocation"in j&&e(16,I=j.selectedLocation),"activity"in j&&e(7,p=j.activity),"activitySystemCostIndex"in j&&e(1,f=j.activitySystemCostIndex),"structureRoleBonuses"in j&&e(2,v=j.structureRoleBonuses),"activityTax"in j&&e(3,g=j.activityTax),"structureRigBonuses"in j&&e(4,m=j.structureRigBonuses),"collapsed"in j&&e(5,b=j.collapsed)},l.$$.update=()=>{var j;if(l.$$.dirty[0]&131137&&!E&&Object.keys(s).length>0&&Object.keys(s).map(q=>parseInt(q)).indexOf(_)<0&&e(0,_=parseInt(Object.keys(s)[0])),l.$$.dirty[0]&131073&&e(16,I=s[_]),l.$$.dirty[0]&1048704&&e(9,r=M.activities[p]),l.$$.dirty[0]&590464&&(r?e(1,f=(j=Et(c,I,p))!=null?j:pe):e(1,f=pe)),l.$$.dirty[0]&65537&&e(8,o=I&&!se(_)),l.$$.dirty[0]&65920)if(o)switch(I.type_id){case jt:e(2,v={jobDurationModifier:-15,materialConsumptionModifier:0,jobCostModifier:-3}),(p===U||p===G)&&e(2,v.materialConsumptionModifier=-1,v);break;case wt:e(2,v={jobDurationModifier:-20,materialConsumptionModifier:0,jobCostModifier:-4}),(p===U||p===G)&&e(2,v.materialConsumptionModifier=-1,v);break;case St:e(2,v={jobDurationModifier:-30,materialConsumptionModifier:0,jobCostModifier:-5}),(p===U||p===G)&&e(2,v.materialConsumptionModifier=-1,v);break;case Nt:e(2,v={jobDurationModifier:0,materialConsumptionModifier:0,jobCostModifier:0});break;default:e(2,v=null)}else e(2,v=null);l.$$.dirty[0]&262529&&(o&&u[_]&&u[_][p]!==void 0?e(3,g=u[_][p]):e(3,g=He)),l.$$.dirty[0]&256&&(o?e(4,m={materialReductionBonus:-2,timeReductionBonus:0,costReductionBonus:0}):e(4,m=null)),l.$$.dirty[0]&131072&&e(10,N=Object.keys(s).map(q=>{var Z;return{location_id:parseInt(q),name:(Z=s[q])==null?void 0:Z.name}}).sort((q,Z)=>q.name&&Z.name?q.name.localeCompare(Z.name):0))},h(e(11,i=nt("locations"))),[_,f,v,g,m,b,E,p,o,r,N,i,C,O,k,a,I,s,u,c,M,A,z,Ze,L,Je,Qe]}class Jt extends it{constructor(t){super();ot(this,t,Ot,Bt,st,{value:0,allowUnselected:6,selectedLocation:16,activity:7,activitySystemCostIndex:1,structureRoleBonuses:2,activityTax:3,structureRigBonuses:4,collapsed:5},null,[-1,-1])}}let ee=new Map,Xe=J(ee,l=>{ee.size===0&&K("invMarketGroups").then(t=>{ee.clear();for(let e of t)e.parent_group_id=="None"&&delete e.parent_group_id,ee.set(e.market_group_id,e);l(ee)}).catch(t=>console.error(t))});function We(l,t){let e=[...t.keys()].filter(r=>t.get(r).parent_group_id==l),i=[];for(const r of e)i=[...i,...We(r,t)];return new Set([...e,...i])}const Lt=Q(Xe,l=>{let t=new Map;for(const[e,i]of l)t.set(e,We(e,l));return t});function Pt(l,t,e,i){var o;let r=[];return[l,...(o=t.get(l))!=null?o:[]].forEach(s=>{var n,h;r=[...r,...(h=(n=e.get(s))==null?void 0:n.filter(u=>i.has(u)))!=null?h:[]]}),r}const Qt=Q([Xe,Lt,yt,Rt],([l,t,e,i])=>{let r=new Map;for(const[o,s]of l){let n=Pt(o,t,e,i);(n==null?void 0:n.length)>0&&r.set(o,s)}return r});export{Kt as A,Te as C,Vt as D,De as E,Ht as F,qt as G,Ee as I,Jt as L,U as M,Rt as P,G as R,pt as U,Ie as a,bt as b,Wt as c,vt as d,Xt as e,zt as f,Ct as g,Dt as h,Yt as i,Pt as j,yt as k,Ut as l,Lt as m,Qt as n,de as o,K as p,Zt as q,Xe as s};
