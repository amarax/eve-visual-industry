import{r as ze}from"./singletons-12a22614.js";import{Z as pe,V as ge,S as Je,i as Ue,s as Ve,B as T,l as w,f as g,a4 as M,a5 as q,a as C,d as y,a6 as N,a7 as B,p as x,b as c,a3 as we,I as He,t as oe,g as ne,D as F,h as ke,G as $,H as fe,$ as We,T as Ye,A as Ze,J as Ke,z as Te,U as xe,a8 as he,a9 as $e,aa as et,ab as tt,L as Me,C as it}from"./vendor-c867dc14.js";import{j as rt,C as lt,k as qe,F as ee,E as st,i as at}from"./LocationSelector-31fe7db1.js";const ut=ze,gt=ot;async function ot(t,e){return ut.goto(t,e,[])}const nt=()=>{const t=pe("__svelte__");return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:t.navigating.subscribe}},session:t.session}},wt={subscribe(t){return nt().page.subscribe(t)}};class ft{constructor(e){this.orders={buy:[],sell:[],lastUpdated:null},this.type_id=e}}const te={regions:{10000002:{types:{}}},prices:ge({},t=>(rt("/markets/prices/?datasource=tranquility").then(e=>{let i={};e.forEach(a=>{i[a.type_id]=a}),t(i)}).catch(e=>console.error(e)),()=>{}))},kt=te.prices;function ht(t,e=10000002){return te.regions[e].types[t]===void 0&&(te.regions[e].types[t]=lt(`/markets/${e}/orders/?order_type=all&type_id=${t}`,i=>{let a=new ft(t);return a.orders.buy=i.filter(r=>r.is_buy_order).sort((r,l)=>l.price-r.price),a.orders.sell=i.filter(r=>!r.is_buy_order).sort((r,l)=>r.price-l.price),a.orders.lastUpdated=new Date().getTime(),a})),te.regions[e].types[t]}const Mt=ge({attributes:{},types:{}},t=>{let e={},i={};qe("dgmAttributeTypes").then(a=>{a.forEach(r=>e[r.attributeID]=r)}).then(()=>qe("dgmIndustryTypeAttributes")).then(a=>{a.filter(r=>e[r.attributeID]!==void 0).forEach(r=>{var l;i[r.typeID]=(l=i[r.typeID])!=null?l:{},i[r.typeID][r.attributeID]={type_id:r.typeID,attribute_id:r.attributeID,value:r.valueInt==="None"?r.valueFloat:r.valueInt}}),t({attributes:e,types:i})}).catch(a=>console.error(a))});function ct(t,e){return e*(1+(t!=null?t:0)/100)}function ce(t,e){let i=t;return e.forEach(a=>{i=isNaN(a.value)?i:ct(a.value,i)}),i}function Ce(t,e,i){const a=t.slice();return a[49]=e[i],a[51]=i,a}function Ee(t){let e,i,a,r=!isNaN(t[6])&&t[6]!==null,l,s,o=t[11],m=[];for(let u=0;u<o.length;u+=1)m[u]=Ie(Ce(t,o,u));let v=t[9]&&t[9].price!==null&&Pe(t),d=t[10]&&t[10].price!==null&&Ne(t),b=r&&De(t),_=t[3]&&je(t);return{c(){for(let u=0;u<m.length;u+=1)m[u].c();e=w(),v&&v.c(),i=w(),d&&d.c(),a=w(),b&&b.c(),l=w(),_&&_.c(),s=w()},l(u){for(let h=0;h<m.length;h+=1)m[h].l(u);e=w(),v&&v.l(u),i=w(),d&&d.l(u),a=w(),b&&b.l(u),l=w(),_&&_.l(u),s=w()},m(u,h){for(let n=0;n<m.length;n+=1)m[n].m(u,h);g(u,e,h),v&&v.m(u,h),g(u,i,h),d&&d.m(u,h),g(u,a,h),b&&b.m(u,h),g(u,l,h),_&&_.m(u,h),g(u,s,h)},p(u,h){if(h[0]&12584960){o=u[11];let n;for(n=0;n<o.length;n+=1){const p=Ce(u,o,n);m[n]?m[n].p(p,h):(m[n]=Ie(p),m[n].c(),m[n].m(e.parentNode,e))}for(;n<m.length;n+=1)m[n].d(1);m.length=o.length}u[9]&&u[9].price!==null?v?v.p(u,h):(v=Pe(u),v.c(),v.m(i.parentNode,i)):v&&(v.d(1),v=null),u[10]&&u[10].price!==null?d?d.p(u,h):(d=Ne(u),d.c(),d.m(a.parentNode,a)):d&&(d.d(1),d=null),h[0]&64&&(r=!isNaN(u[6])&&u[6]!==null),r?b?b.p(u,h):(b=De(u),b.c(),b.m(l.parentNode,l)):b&&(b.d(1),b=null),u[3]?_?_.p(u,h):(_=je(u),_.c(),_.m(s.parentNode,s)):_&&(_.d(1),_=null)},d(u){He(m,u),u&&y(e),v&&v.d(u),u&&y(i),d&&d.d(u),u&&y(a),b&&b.d(u),u&&y(l),_&&_.d(u),u&&y(s)}}}function Ie(t){let e,i,a,r=[{class:"mark scale"},{style:i=t[22](t[49])},{width:a=1},t[23]],l={};for(let s=0;s<r.length;s+=1)l=T(l,r[s]);return{c(){e=M("rect"),this.h()},l(s){e=q(s,"rect",{class:!0,style:!0,width:!0}),C(e).forEach(y),this.h()},h(){N(e,l),B(e,"svelte-1r3qimx",!0)},m(s,o){g(s,e,o)},p(s,o){N(e,l=x(r,[{class:"mark scale"},o[0]&4196352&&i!==(i=s[22](s[49]))&&{style:i},{width:a},o[0]&8388608&&s[23]])),B(e,"svelte-1r3qimx",!0)},d(s){s&&y(e)}}}function Pe(t){let e,i,a,r=t[4]!=0&&Re(t);return{c(){e=M("path"),r&&r.c(),a=w(),this.h()},l(l){e=q(l,"path",{class:!0,d:!0}),C(e).forEach(y),r&&r.l(l),a=w(),this.h()},h(){var l;c(e,"class","graph buy svelte-1r3qimx"),c(e,"d",i=t[25].y(t[24]())([{price:t[9].price,volume_remain:0},...(l=t[16])==null?void 0:l.orders.buy.filter(t[8])]))},m(l,s){g(l,e,s),r&&r.m(l,s),g(l,a,s)},p(l,s){var o;s[0]&50397952&&i!==(i=l[25].y(l[24]())([{price:l[9].price,volume_remain:0},...(o=l[16])==null?void 0:o.orders.buy.filter(l[8])]))&&c(e,"d",i),l[4]!=0?r?r.p(l,s):(r=Re(l),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null)},d(l){l&&y(e),r&&r.d(l),l&&y(a)}}}function Re(t){let e,i,a,r=[{class:"overhead buy"},{x:i=t[12](t[9].price*Math.min(1,1+t[4])*t[7])},{width:a=t[12](Math.abs(t[4]*t[9].price*t[7]))},t[23]],l={};for(let s=0;s<r.length;s+=1)l=T(l,r[s]);return{c(){e=M("rect"),this.h()},l(s){e=q(s,"rect",{class:!0,x:!0,width:!0}),C(e).forEach(y),this.h()},h(){N(e,l),B(e,"svelte-1r3qimx",!0)},m(s,o){g(s,e,o)},p(s,o){N(e,l=x(r,[{class:"overhead buy"},o[0]&4752&&i!==(i=s[12](s[9].price*Math.min(1,1+s[4])*s[7]))&&{x:i},o[0]&4752&&a!==(a=s[12](Math.abs(s[4]*s[9].price*s[7])))&&{width:a},o[0]&8388608&&s[23]])),B(e,"svelte-1r3qimx",!0)},d(s){s&&y(e)}}}function Ne(t){let e,i,a,r=t[5]!=0&&Be(t);return{c(){e=M("path"),r&&r.c(),a=w(),this.h()},l(l){e=q(l,"path",{class:!0,d:!0}),C(e).forEach(y),r&&r.l(l),a=w(),this.h()},h(){var l;c(e,"class","graph sell svelte-1r3qimx"),c(e,"d",i=t[25].y(t[24]())([{price:t[10].price,volume_remain:0},...(l=t[16])==null?void 0:l.orders.sell.filter(t[8])]))},m(l,s){g(l,e,s),r&&r.m(l,s),g(l,a,s)},p(l,s){var o;s[0]&50398464&&i!==(i=l[25].y(l[24]())([{price:l[10].price,volume_remain:0},...(o=l[16])==null?void 0:o.orders.sell.filter(l[8])]))&&c(e,"d",i),l[5]!=0?r?r.p(l,s):(r=Be(l),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null)},d(l){l&&y(e),r&&r.d(l),l&&y(a)}}}function Be(t){let e,i,a,r=[{class:"overhead sell"},{x:i=t[12](t[10].price*Math.min(1,1+t[5])*t[7])},{width:a=t[12](Math.abs(t[5]*t[10].price*t[7]))},t[23]],l={};for(let s=0;s<r.length;s+=1)l=T(l,r[s]);return{c(){e=M("rect"),this.h()},l(s){e=q(s,"rect",{class:!0,x:!0,width:!0}),C(e).forEach(y),this.h()},h(){N(e,l),B(e,"svelte-1r3qimx",!0)},m(s,o){g(s,e,o)},p(s,o){N(e,l=x(r,[{class:"overhead sell"},o[0]&5280&&i!==(i=s[12](s[10].price*Math.min(1,1+s[5])*s[7]))&&{x:i},o[0]&5280&&a!==(a=s[12](Math.abs(s[5]*s[10].price*s[7])))&&{width:a},o[0]&8388608&&s[23]])),B(e,"svelte-1r3qimx",!0)},d(s){s&&y(e)}}}function De(t){let e,i,a,r=t[1]!=0&&Ae(t);return{c(){e=M("rect"),r&&r.c(),a=w(),this.h()},l(l){e=q(l,"rect",{class:!0,x:!0,width:!0,height:!0}),C(e).forEach(y),r&&r.l(l),a=w(),this.h()},h(){c(e,"class","mark cost svelte-1r3qimx"),c(e,"x",i=t[12](t[6])),c(e,"width",1),c(e,"height",t[2])},m(l,s){g(l,e,s),r&&r.m(l,s),g(l,a,s)},p(l,s){s[0]&4160&&i!==(i=l[12](l[6]))&&c(e,"x",i),s[0]&4&&c(e,"height",l[2]),l[1]!=0?r?r.p(l,s):(r=Ae(l),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null)},d(l){l&&y(e),r&&r.d(l),l&&y(a)}}}function Ae(t){let e,i,a,r,l;return{c(){e=M("rect"),this.h()},l(s){e=q(s,"rect",{class:!0,x:!0,width:!0,y:!0,height:!0}),C(e).forEach(y),this.h()},h(){c(e,"class",i=""+(we(`difference profit ${t[13]>t[1]?"negative":"positive"}`)+" svelte-1r3qimx")),c(e,"x",a=Math.min(t[12](t[6]),t[12](t[1]*t[7]))),c(e,"width",r=Math.abs(t[12](t[6])-t[12](t[1]*t[7]))),c(e,"y",l=t[14](.5)),c(e,"height",1)},m(s,o){g(s,e,o)},p(s,o){o[0]&8194&&i!==(i=""+(we(`difference profit ${s[13]>s[1]?"negative":"positive"}`)+" svelte-1r3qimx"))&&c(e,"class",i),o[0]&4290&&a!==(a=Math.min(s[12](s[6]),s[12](s[1]*s[7])))&&c(e,"x",a),o[0]&4290&&r!==(r=Math.abs(s[12](s[6])-s[12](s[1]*s[7])))&&c(e,"width",r),o[0]&16384&&l!==(l=s[14](.5))&&c(e,"y",l)},d(s){s&&y(e)}}}function je(t){let e,i,a;return{c(){e=M("circle"),this.h()},l(r){e=q(r,"circle",{class:!0,cx:!0,cy:!0,r:!0}),C(e).forEach(y),this.h()},h(){c(e,"class","mark price svelte-1r3qimx"),c(e,"cx",i=t[12](t[1]*t[7])),c(e,"cy",a=t[14](.5)),c(e,"r",2)},m(r,l){g(r,e,l)},p(r,l){l[0]&4226&&i!==(i=r[12](r[1]*r[7]))&&c(e,"cx",i),l[0]&16384&&a!==(a=r[14](.5))&&c(e,"cy",a)},d(r){r&&y(e)}}}function Se(t){let e,i=ee(t[19]*t[7])+"",a,r,l=ee(t[19])+"",s,o,m,v,d,b,_,u,h;return{c(){e=M("text"),a=oe(i),r=oe(" @"),s=oe(l),d=M("circle"),this.h()},l(n){e=q(n,"text",{class:!0,style:!0,y:!0,dy:!0,"text-anchor":!0});var p=C(e);a=ne(p,i),r=ne(p," @"),s=ne(p,l),p.forEach(y),d=q(n,"circle",{class:!0,style:!0,cx:!0,cy:!0,r:!0}),C(d).forEach(y),this.h()},h(){c(e,"class","hover svelte-1r3qimx"),c(e,"style",o=t[22](t[19]*t[7])),c(e,"y",m=t[14](0)),c(e,"dy",v=8),c(e,"text-anchor","middle"),c(d,"class","hover svelte-1r3qimx"),c(d,"style",b=t[22](t[19]*t[7])),c(d,"cx",_=0),c(d,"cy",u=t[14](.5)),c(d,"r",h=4)},m(n,p){g(n,e,p),F(e,a),F(e,r),F(e,s),t[40](e),g(n,d,p)},p(n,p){p[0]&524416&&i!==(i=ee(n[19]*n[7])+"")&&ke(a,i),p[0]&524288&&l!==(l=ee(n[19])+"")&&ke(s,l),p[0]&4718720&&o!==(o=n[22](n[19]*n[7]))&&c(e,"style",o),p[0]&16384&&m!==(m=n[14](0))&&c(e,"y",m),p[0]&4718720&&b!==(b=n[22](n[19]*n[7]))&&c(d,"style",b),p[0]&16384&&u!==(u=n[14](.5))&&c(d,"cy",u)},d(n){n&&y(e),t[40](null),n&&y(d)}}}function _t(t){let e,i,a,r,l,s,o,m,v,d=[{class:"graphArea"},{width:t[0]},t[23]],b={};for(let h=0;h<d.length;h+=1)b=T(b,d[h]);let _=t[17]&&Ee(t),u=t[18]&&Se(t);return{c(){e=M("svg"),i=M("rect"),_&&_.c(),a=w(),u&&u.c(),r=M("rect"),this.h()},l(h){e=q(h,"svg",{height:!0,viewBox:!0,xmlns:!0,class:!0});var n=C(e);i=q(n,"rect",{class:!0,width:!0}),C(i).forEach(y),_&&_.l(n),a=w(),u&&u.l(n),r=q(n,"rect",{class:!0,width:!0,y:!0,height:!0}),C(r).forEach(y),n.forEach(y),this.h()},h(){N(i,b),B(i,"svelte-1r3qimx",!0),c(r,"class","hitArea svelte-1r3qimx"),c(r,"width",t[0]),c(r,"y",l=t[14](1)),c(r,"height",s=t[14](0)-t[14](1)),c(e,"height",t[2]),c(e,"viewBox",o=`0 0 ${t[0]} ${t[2]}`),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"class","svelte-1r3qimx")},m(h,n){g(h,e,n),F(e,i),_&&_.m(e,null),F(e,a),u&&u.m(e,null),F(e,r),t[43](e),m||(v=[$(r,"mouseenter",t[41]),$(r,"mouseleave",t[42]),$(r,"mousemove",t[27]),$(r,"click",t[28])],m=!0)},p(h,n){N(i,b=x(d,[{class:"graphArea"},n[0]&1&&{width:h[0]},n[0]&8388608&&h[23]])),B(i,"svelte-1r3qimx",!0),h[17]?_?_.p(h,n):(_=Ee(h),_.c(),_.m(e,a)):_&&(_.d(1),_=null),h[18]?u?u.p(h,n):(u=Se(h),u.c(),u.m(e,r)):u&&(u.d(1),u=null),n[0]&1&&c(r,"width",h[0]),n[0]&16384&&l!==(l=h[14](1))&&c(r,"y",l),n[0]&16384&&s!==(s=h[14](0)-h[14](1))&&c(r,"height",s),n[0]&4&&c(e,"height",h[2]),n[0]&5&&o!==(o=`0 0 ${h[0]} ${h[2]}`)&&c(e,"viewBox",o)},i:fe,o:fe,d(h){h&&y(e),_&&_.d(),u&&u.d(),t[43](null),m=!1,We(v)}}}let Fe=8;function dt(t,e,i){let a,r,l,s,o,m,v,d,b,_,u,h=fe,n=()=>(h(),h=xe(a,f=>i(16,u=f)),a),p;t.$$.on_destroy.push(()=>h());let{compact:U=!1}=e,{height:V=U?24:40}=e,{width:j=500}=e,{extents:D=[0,1e3]}=e,{type_id:S=null}=e,_e=pe("marketFilterLocation");Ye(t,_e,f=>i(39,p=f));let H=()=>!0;function de(f,k){return f?k?f.filter(H)[0]:f[0]:null}let{buyOverheadRate:ie=0}=e,{sellOverheadRate:W=0}=e,L=null,P=null,{lowestSellPrice:re=0}=e,{highestBuyPrice:le=0}=e,{price:O=null}=e,{overridePrice:G=null}=e,Q=null,se=null,{totalCost:Y=null}=e,{quantity:R=1}=e,me=U?[0,V-Fe]:[0,V-2*Fe],ye=!1,ae=[],ue=!1,I=[],Z=0,K=0;function be(f){var z;let k=f.clientX-f.target.getBoundingClientRect().left;K=tt(I,E=>Math.abs(E.price*R-s.invert(k))/R),i(19,Z=(z=I[K])==null?void 0:z.price)}function Le(f){var k;((k=I[K])==null?void 0:k.is_buy_order)!==void 0&&(i(34,Q=Z),i(34,Q*=1+(I[K].is_buy_order?ie:W)))}function ve(f){i(0,j=X.getBoundingClientRect().width)}let X;Ze(()=>{i(0,j=X.getBoundingClientRect().width),window.addEventListener("resize",ve)}),Ke(()=>{window.removeEventListener("resize",ve)});let A;Te(()=>{if(A){let f=A.getBBox().width/2,k=s(Z*R);k-f<0?A.setAttribute("style",`transform: translateX(${k+f}px)`):k+f>j&&A.setAttribute("style",`transform: translateX(${k-f}px)`)}});function Oe(f){Me[f?"unshift":"push"](()=>{A=f,i(21,A)})}const Ge=f=>{i(18,ue=!0),be(f)},Qe=f=>i(18,ue=!1);function Xe(f){Me[f?"unshift":"push"](()=>{X=f,i(20,X)})}return t.$$set=f=>{"compact"in f&&i(31,U=f.compact),"height"in f&&i(2,V=f.height),"width"in f&&i(0,j=f.width),"extents"in f&&i(32,D=f.extents),"type_id"in f&&i(3,S=f.type_id),"buyOverheadRate"in f&&i(4,ie=f.buyOverheadRate),"sellOverheadRate"in f&&i(5,W=f.sellOverheadRate),"lowestSellPrice"in f&&i(29,re=f.lowestSellPrice),"highestBuyPrice"in f&&i(30,le=f.highestBuyPrice),"price"in f&&i(1,O=f.price),"overridePrice"in f&&i(33,G=f.overridePrice),"totalCost"in f&&i(6,Y=f.totalCost),"quantity"in f&&i(7,R=f.quantity)},t.$$.update=()=>{var f,k,z;if(t.$$.dirty[0]&8&&n(i(15,a=S&&ht(S))),t.$$.dirty[1]&256&&i(8,H=E=>p?E.location_id===p:!0),t.$$.dirty[0]&65536|t.$$.dirty[1]&256&&(i(9,L=de(u==null?void 0:u.orders.buy,p)),i(10,P=de(u==null?void 0:u.orders.sell,p))),t.$$.dirty[0]&1536&&(i(29,re=P==null?void 0:P.price),i(30,le=L==null?void 0:L.price)),t.$$.dirty[0]&98304&&((u==null?void 0:u.orders)?a==null||a.status:st.loading),t.$$.dirty[0]&1056&&i(38,r=(P==null?void 0:P.price)*(1+W)),t.$$.dirty[0]&8|t.$$.dirty[1]&16&&se!==S&&(i(34,Q=null),i(35,se=S)),t.$$.dirty[0]&2|t.$$.dirty[1]&140&&(i(1,O=(f=G!=null?G:Q)!=null?f:r),isNaN(O)&&i(1,O=0)),t.$$.dirty[0]&192&&i(13,l=Y/R),t.$$.dirty[0]&1|t.$$.dirty[1]&2&&i(12,s=he().domain([D[0],D[1]]).range([0,j])),t.$$.dirty[0]&128&&i(37,m=he().domain([R*2,0]).range(me)),t.$$.dirty[0]&4224&&i(25,v=$e().curve(et).x(E=>s(E.price*R))),t.$$.dirty[1]&64&&i(24,d=()=>{let E=0;return J=>(E+=J.volume_remain,m(E))}),t.$$.dirty[0]&2048|t.$$.dirty[1]&2){i(17,ye=D[1]>D[0]),i(11,ae=[]);let E=10;for(let J=1e6;J<D[1];J*=E)ae.push(J)}t.$$.dirty[0]&16384&&i(23,b={y:o(1),height:Math.abs(o(0)-o(1))}),t.$$.dirty[0]&4096&&i(22,_=E=>`transform: translateX(${s(E)}px)`),t.$$.dirty[0]&74048|t.$$.dirty[1]&32&&(u&&u.orders?i(36,I=(z=u==null?void 0:u.orders)==null?void 0:z.buy.concat((k=u==null?void 0:u.orders)==null?void 0:k.sell).filter(H)):i(36,I=[]),Y&&i(36,I=[...I,{price:l}]))},i(14,o=he().domain([1,0]).range(me)),[j,O,V,S,ie,W,Y,R,H,L,P,ae,s,l,o,a,u,ye,ue,Z,X,A,_,b,d,v,_e,be,Le,re,le,U,D,G,Q,se,I,m,r,p,Oe,Ge,Qe,Xe]}class qt extends Je{constructor(e){super();Ue(this,e,dt,_t,Ve,{compact:31,height:2,width:0,extents:32,type_id:3,buyOverheadRate:4,sellOverheadRate:5,lowestSellPrice:29,highestBuyPrice:30,price:1,overridePrice:33,totalCost:6,quantity:7},null,[-1,-1])}}class mt{constructor(e,i){var a,r,l,s,o,m,v;this.activity=e,this.selectedProduct=(v=(m=(r=(a=this.activity)==null?void 0:a.products[i])==null?void 0:r.type_id)!=null?m:(o=Object.values((s=(l=this.activity)==null?void 0:l.products)!=null?s:{})[0])==null?void 0:o.type_id)!=null?v:null,this.facilityModifiers={taxRate:10,systemCostIndex:.05},this.prices={},this.indexPrices={},this.blueprintCostPerRun=0,this.runs=1}get producedQuantity(){var e;return((e=this.activity)==null?void 0:e.products[this.selectedProduct].quantity)*this.runs}set requiredQuantity(e){var i,a;this.runs=Math.ceil(e/((a=(i=this.activity)==null?void 0:i.products[this.selectedProduct])==null?void 0:a.quantity))}qty(e){var a,r,l;if(e==null)return 0;let i=ce(e*this.runs,[{value:-((a=this.blueprintModifiers)==null?void 0:a.materialEfficiency)},{value:(r=this.facilityModifiers.roleModifiers)==null?void 0:r.materialConsumption},{value:(l=this.facilityModifiers.rigModifiers)==null?void 0:l.materialReduction}]);return Math.max(this.runs,Math.ceil(i))}materialQuantity(e){var i,a;return this.qty((a=(i=this.activity)==null?void 0:i.materials[e])==null?void 0:a.quantity)}get estimatedItemValue(){var i,a,r,l;let e=0;for(let s in(a=(i=this.activity)==null?void 0:i.materials)!=null?a:[])e+=this.activity.materials[s].quantity*((l=(r=this.indexPrices[s])==null?void 0:r.adjusted_price)!=null?l:0);return e}get jobCost(){var i;return ce(this.estimatedItemValue*this.facilityModifiers.systemCostIndex*this.runs,[{value:(i=this.facilityModifiers.roleModifiers)==null?void 0:i.jobCost},{value:this.facilityModifiers.taxRate}])}get totalCost(){var i,a,r,l;let e=0;for(let s in(a=(i=this.activity)==null?void 0:i.materials)!=null?a:[])e+=this.qty(this.activity.materials[s].quantity)*((r=this.prices[s])!=null?r:0);return e+=this.jobCost,e+=((l=this.blueprintCostPerRun)!=null?l:0)*this.runs,e}get unitCost(){return this.totalCost/this.producedQuantity}get jobDuration(){var e,i,a,r,l;return ce(((e=this.activity)==null?void 0:e.time)*this.runs,[{value:-((i=this.blueprintModifiers)==null?void 0:i.timeEfficiency)},{value:(a=this.characterModifiers)==null?void 0:a.skill_jobDuration},{value:(r=this.facilityModifiers.roleModifiers)==null?void 0:r.jobDuration},{value:(l=this.facilityModifiers.rigModifiers)==null?void 0:l.timeReduction}])}get profit(){return this.prices[this.selectedProduct]*this.producedQuantity-this.totalCost}}function yt(t,e){let i=new mt(t,e),{subscribe:a,set:r}=it(i);return{subscribe:a,update:l=>{for(let s in l){if(s=="indexPrices"){i[s]=l[s];continue}if(!i[s]||typeof l[s]!="object")i[s]=l[s];else for(let o in l[s])i[s][o]=l[s][o]}r(i)}}}function Ct(t,e){let{activity:i}=at(t);return yt(i,t)}export{ce as A,Ct as C,Mt as I,qt as M,kt as a,ht as b,gt as g,wt as p};
