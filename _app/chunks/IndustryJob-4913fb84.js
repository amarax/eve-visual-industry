import{r as $e}from"./singletons-12a22614.js";import{Y as ke,S as we,i as Me,s as Ee,e as fe,c as he,a as w,d as v,b as p,f as g,D as R,F as qe,G as J,t as ee,g as te,h as ce,I as _e,l as k,H as V,L as de,_ as et,V as Ce,B as H,a3 as E,a4 as q,a5 as I,a6 as P,p as U,a2 as Ie,a0 as tt,A as it,J as rt,z as lt,M as st,a7 as Pe,a8 as at,a9 as ut,aa as nt,N as Ne,C as ot}from"./vendor-dd7e5550.js";import{n as ft,m as ht,o as ct,C as _t,p as Be,F as ie,E as dt}from"./EveMarketGroups-94ca141b.js";const mt=$e,Dt=pt;async function pt(t,e){return mt.goto(t,e,[])}const yt=()=>{const t=ke("__svelte__");return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:t.navigating.subscribe}},session:t.session}},Rt={subscribe(t){return yt().page.subscribe(t)}};function De(t,e,i){const a=t.slice();return a[8]=e[i],a[10]=i,a}function Re(t,e,i){const a=t.slice();return a[11]=e[i].market_group_id,a[12]=e[i].name,a}function Se(t){let e,i=t[12]+"",a,r;return{c(){e=fe("option"),a=ee(i),this.h()},l(s){e=he(s,"OPTION",{});var l=w(e);a=te(l,i),l.forEach(v),this.h()},h(){e.__value=r=t[11],e.value=e.__value},m(s,l){g(s,e,l),R(e,a)},p(s,l){l&2&&i!==(i=s[12]+"")&&ce(a,i),l&2&&r!==(r=s[11])&&(e.__value=r,e.value=e.__value)},d(s){s&&v(e)}}}function Ae(t){let e,i,a,r,s,l,o,y=[...t[8]],m=[];for(let n=0;n<y.length;n+=1)m[n]=Se(Re(t,y,n));function d(...n){return t[7](t[10],...n)}return{c(){e=fe("select"),i=fe("option");for(let n=0;n<m.length;n+=1)m[n].c();this.h()},l(n){e=he(n,"SELECT",{name:!0});var f=w(e);i=he(f,"OPTION",{}),w(i).forEach(v);for(let u=0;u<m.length;u+=1)m[u].l(f);f.forEach(v),this.h()},h(){i.__value=a=null,i.value=i.__value,p(e,"name",r=t[10].toString())},m(n,f){g(n,e,f),R(e,i);for(let u=0;u<m.length;u+=1)m[u].m(e,null);qe(e,t[2][t[10]]),l||(o=J(e,"change",d),l=!0)},p(n,f){if(t=n,f&2){y=[...t[8]];let u;for(u=0;u<y.length;u+=1){const c=Re(t,y,u);m[u]?m[u].p(c,f):(m[u]=Se(c),m[u].c(),m[u].m(e,null))}for(;u<m.length;u+=1)m[u].d(1);m.length=y.length}f&6&&s!==(s=t[2][t[10]])&&qe(e,t[2][t[10]])},d(n){n&&v(e),_e(m,n),l=!1,o()}}}function vt(t){let e,i=t[1],a=[];for(let r=0;r<i.length;r+=1)a[r]=Ae(De(t,i,r));return{c(){for(let r=0;r<a.length;r+=1)a[r].c();e=k()},l(r){for(let s=0;s<a.length;s+=1)a[s].l(r);e=k()},m(r,s){for(let l=0;l<a.length;l+=1)a[l].m(r,s);g(r,e,s)},p(r,[s]){if(s&15){i=r[1];let l;for(l=0;l<i.length;l+=1){const o=De(r,i,l);a[l]?a[l].p(o,s):(a[l]=Ae(o),a[l].c(),a[l].m(e.parentNode,e))}for(;l<a.length;l+=1)a[l].d(1);a.length=i.length}},i:V,o:V,d(r){_e(a,r),r&&v(e)}}}function bt(t,e){return[...e.values()].filter(i=>i.parent_group_id===t)}function gt(t,e,i){let a,r;de(t,ft,n=>i(5,a=n)),de(t,ht,n=>i(6,r=n));let s,l=[null],o,{value:y}=e;const m=et(),d=(n,f)=>{var u;f.currentTarget.value!=="null"?i(0,y=parseInt(f.currentTarget.value)):i(0,y=(u=l[n-1])!=null?u:null),m("change",y)};return t.$$set=n=>{"value"in n&&i(0,y=n.value)},t.$$.update=()=>{if(t.$$.dirty&64&&i(4,o=n=>{var f;return((f=r.get(n))==null?void 0:f.size)>0}),t.$$.dirty&33){let n=[],f=a.get(y);for(;f;)n=[f.market_group_id,...n],f=a.get(f.parent_group_id);i(2,l=n)}if(t.$$.dirty&54){i(1,s=[[...a.values()].filter(n=>n.parent_group_id==null)]);for(const n of l)o(n)&&i(1,s=[...s,bt(n,a)])}},[y,s,l,m,o,a,r,d]}class St extends we{constructor(e){super();Me(this,e,gt,vt,Ee,{value:0})}}class kt{constructor(e){this.orders={buy:[],sell:[],lastUpdated:null},this.type_id=e}}const re={regions:{10000002:{types:{}}},prices:Ce({},t=>(ct("/markets/prices/?datasource=tranquility").then(e=>{let i={};e.forEach(a=>{i[a.type_id]=a}),t(i)}).catch(e=>console.error(e)),()=>{}))},At=re.prices;function wt(t,e=10000002){return re.regions[e].types[t]===void 0&&(re.regions[e].types[t]=_t(`/markets/${e}/orders/?order_type=all&type_id=${t}`,i=>{let a=new kt(t);return a.orders.buy=i.filter(r=>r.is_buy_order).sort((r,s)=>s.price-r.price),a.orders.sell=i.filter(r=>!r.is_buy_order).sort((r,s)=>r.price-s.price),a.orders.lastUpdated=new Date().getTime(),a})),re.regions[e].types[t]}const jt=Ce({attributes:{},types:{}},t=>{let e={},i={};Be("dgmAttributeTypes").then(a=>{a.forEach(r=>e[r.attributeID]=r)}).then(()=>Be("dgmIndustryTypeAttributes")).then(a=>{a.filter(r=>e[r.attributeID]!==void 0).forEach(r=>{var s;i[r.typeID]=(s=i[r.typeID])!=null?s:{},i[r.typeID][r.attributeID]={type_id:r.typeID,attribute_id:r.attributeID,value:r.valueInt==="None"?r.valueFloat:r.valueInt}}),t({attributes:e,types:i})}).catch(a=>console.error(a))});function Mt(t,e){return e*(1+(t!=null?t:0)/100)}function me(t,e){let i=t;return e.forEach(a=>{i=isNaN(a.value)?i:Mt(a.value,i)}),i}function je(t,e,i){const a=t.slice();return a[48]=e[i],a[50]=i,a}function Oe(t){let e,i,a,r=!isNaN(t[6])&&t[6]!==null,s,l,o=t[11],y=[];for(let u=0;u<o.length;u+=1)y[u]=Ge(je(t,o,u));let m=t[9]&&t[9].price!==null&&Fe(t),d=t[10]&&t[10].price!==null&&Qe(t),n=r&&Xe(t),f=t[3]&&Je(t);return{c(){for(let u=0;u<y.length;u+=1)y[u].c();e=k(),m&&m.c(),i=k(),d&&d.c(),a=k(),n&&n.c(),s=k(),f&&f.c(),l=k()},l(u){for(let c=0;c<y.length;c+=1)y[c].l(u);e=k(),m&&m.l(u),i=k(),d&&d.l(u),a=k(),n&&n.l(u),s=k(),f&&f.l(u),l=k()},m(u,c){for(let h=0;h<y.length;h+=1)y[h].m(u,c);g(u,e,c),m&&m.m(u,c),g(u,i,c),d&&d.m(u,c),g(u,a,c),n&&n.m(u,c),g(u,s,c),f&&f.m(u,c),g(u,l,c)},p(u,c){if(c[0]&12584960){o=u[11];let h;for(h=0;h<o.length;h+=1){const b=je(u,o,h);y[h]?y[h].p(b,c):(y[h]=Ge(b),y[h].c(),y[h].m(e.parentNode,e))}for(;h<y.length;h+=1)y[h].d(1);y.length=o.length}u[9]&&u[9].price!==null?m?m.p(u,c):(m=Fe(u),m.c(),m.m(i.parentNode,i)):m&&(m.d(1),m=null),u[10]&&u[10].price!==null?d?d.p(u,c):(d=Qe(u),d.c(),d.m(a.parentNode,a)):d&&(d.d(1),d=null),c[0]&64&&(r=!isNaN(u[6])&&u[6]!==null),r?n?n.p(u,c):(n=Xe(u),n.c(),n.m(s.parentNode,s)):n&&(n.d(1),n=null),u[3]?f?f.p(u,c):(f=Je(u),f.c(),f.m(l.parentNode,l)):f&&(f.d(1),f=null)},d(u){_e(y,u),u&&v(e),m&&m.d(u),u&&v(i),d&&d.d(u),u&&v(a),n&&n.d(u),u&&v(s),f&&f.d(u),u&&v(l)}}}function Ge(t){let e,i,a,r=[{class:"mark scale"},{style:i=t[22](t[48])},{width:a=1},t[23]],s={};for(let l=0;l<r.length;l+=1)s=H(s,r[l]);return{c(){e=E("rect"),this.h()},l(l){e=q(l,"rect",{class:!0,style:!0,width:!0}),w(e).forEach(v),this.h()},h(){I(e,s),P(e,"svelte-1r3qimx",!0)},m(l,o){g(l,e,o)},p(l,o){I(e,s=U(r,[{class:"mark scale"},o[0]&4196352&&i!==(i=l[22](l[48]))&&{style:i},{width:a},o[0]&8388608&&l[23]])),P(e,"svelte-1r3qimx",!0)},d(l){l&&v(e)}}}function Fe(t){let e,i,a,r=t[4]!=0&&Le(t);return{c(){e=E("path"),r&&r.c(),a=k(),this.h()},l(s){e=q(s,"path",{class:!0,d:!0}),w(e).forEach(v),r&&r.l(s),a=k(),this.h()},h(){var s;p(e,"class","graph buy svelte-1r3qimx"),p(e,"d",i=t[25].y(t[24]())([{price:t[9].price,volume_remain:0},...(s=t[16])==null?void 0:s.orders.buy.filter(t[8])]))},m(s,l){g(s,e,l),r&&r.m(s,l),g(s,a,l)},p(s,l){var o;l[0]&50397952&&i!==(i=s[25].y(s[24]())([{price:s[9].price,volume_remain:0},...(o=s[16])==null?void 0:o.orders.buy.filter(s[8])]))&&p(e,"d",i),s[4]!=0?r?r.p(s,l):(r=Le(s),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null)},d(s){s&&v(e),r&&r.d(s),s&&v(a)}}}function Le(t){let e,i,a,r=[{class:"overhead buy"},{x:i=t[12](t[9].price*Math.min(1,1+t[4])*t[7])},{width:a=t[12](Math.abs(t[4]*t[9].price*t[7]))},t[23]],s={};for(let l=0;l<r.length;l+=1)s=H(s,r[l]);return{c(){e=E("rect"),this.h()},l(l){e=q(l,"rect",{class:!0,x:!0,width:!0}),w(e).forEach(v),this.h()},h(){I(e,s),P(e,"svelte-1r3qimx",!0)},m(l,o){g(l,e,o)},p(l,o){I(e,s=U(r,[{class:"overhead buy"},o[0]&4752&&i!==(i=l[12](l[9].price*Math.min(1,1+l[4])*l[7]))&&{x:i},o[0]&4752&&a!==(a=l[12](Math.abs(l[4]*l[9].price*l[7])))&&{width:a},o[0]&8388608&&l[23]])),P(e,"svelte-1r3qimx",!0)},d(l){l&&v(e)}}}function Qe(t){let e,i,a,r=t[5]!=0&&Te(t);return{c(){e=E("path"),r&&r.c(),a=k(),this.h()},l(s){e=q(s,"path",{class:!0,d:!0}),w(e).forEach(v),r&&r.l(s),a=k(),this.h()},h(){var s;p(e,"class","graph sell svelte-1r3qimx"),p(e,"d",i=t[25].y(t[24]())([{price:t[10].price,volume_remain:0},...(s=t[16])==null?void 0:s.orders.sell.filter(t[8])]))},m(s,l){g(s,e,l),r&&r.m(s,l),g(s,a,l)},p(s,l){var o;l[0]&50398464&&i!==(i=s[25].y(s[24]())([{price:s[10].price,volume_remain:0},...(o=s[16])==null?void 0:o.orders.sell.filter(s[8])]))&&p(e,"d",i),s[5]!=0?r?r.p(s,l):(r=Te(s),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null)},d(s){s&&v(e),r&&r.d(s),s&&v(a)}}}function Te(t){let e,i,a,r=[{class:"overhead sell"},{x:i=t[12](t[10].price*Math.min(1,1+t[5])*t[7])},{width:a=t[12](Math.abs(t[5]*t[10].price*t[7]))},t[23]],s={};for(let l=0;l<r.length;l+=1)s=H(s,r[l]);return{c(){e=E("rect"),this.h()},l(l){e=q(l,"rect",{class:!0,x:!0,width:!0}),w(e).forEach(v),this.h()},h(){I(e,s),P(e,"svelte-1r3qimx",!0)},m(l,o){g(l,e,o)},p(l,o){I(e,s=U(r,[{class:"overhead sell"},o[0]&5280&&i!==(i=l[12](l[10].price*Math.min(1,1+l[5])*l[7]))&&{x:i},o[0]&5280&&a!==(a=l[12](Math.abs(l[5]*l[10].price*l[7])))&&{width:a},o[0]&8388608&&l[23]])),P(e,"svelte-1r3qimx",!0)},d(l){l&&v(e)}}}function Xe(t){let e,i,a,r=t[1]!=0&&ze(t);return{c(){e=E("rect"),r&&r.c(),a=k(),this.h()},l(s){e=q(s,"rect",{class:!0,x:!0,width:!0,height:!0}),w(e).forEach(v),r&&r.l(s),a=k(),this.h()},h(){p(e,"class","mark cost svelte-1r3qimx"),p(e,"x",i=t[12](t[6])),p(e,"width",1),p(e,"height",t[2])},m(s,l){g(s,e,l),r&&r.m(s,l),g(s,a,l)},p(s,l){l[0]&4160&&i!==(i=s[12](s[6]))&&p(e,"x",i),l[0]&4&&p(e,"height",s[2]),s[1]!=0?r?r.p(s,l):(r=ze(s),r.c(),r.m(a.parentNode,a)):r&&(r.d(1),r=null)},d(s){s&&v(e),r&&r.d(s),s&&v(a)}}}function ze(t){let e,i,a,r,s;return{c(){e=E("rect"),this.h()},l(l){e=q(l,"rect",{class:!0,x:!0,width:!0,y:!0,height:!0}),w(e).forEach(v),this.h()},h(){p(e,"class",i=""+(Ie(`difference profit ${t[13]>t[1]?"negative":"positive"}`)+" svelte-1r3qimx")),p(e,"x",a=Math.min(t[12](t[6]),t[12](t[1]*t[7]))),p(e,"width",r=Math.abs(t[12](t[6])-t[12](t[1]*t[7]))),p(e,"y",s=t[14](t[7])),p(e,"height",1)},m(l,o){g(l,e,o)},p(l,o){o[0]&8194&&i!==(i=""+(Ie(`difference profit ${l[13]>l[1]?"negative":"positive"}`)+" svelte-1r3qimx"))&&p(e,"class",i),o[0]&4290&&a!==(a=Math.min(l[12](l[6]),l[12](l[1]*l[7])))&&p(e,"x",a),o[0]&4290&&r!==(r=Math.abs(l[12](l[6])-l[12](l[1]*l[7])))&&p(e,"width",r),o[0]&16512&&s!==(s=l[14](l[7]))&&p(e,"y",s)},d(l){l&&v(e)}}}function Je(t){let e,i,a;return{c(){e=E("circle"),this.h()},l(r){e=q(r,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(e).forEach(v),this.h()},h(){p(e,"class","mark price svelte-1r3qimx"),p(e,"cx",i=t[12](t[1]*t[7])),p(e,"cy",a=t[14](t[7])),p(e,"r",2)},m(r,s){g(r,e,s)},p(r,s){s[0]&4226&&i!==(i=r[12](r[1]*r[7]))&&p(e,"cx",i),s[0]&16512&&a!==(a=r[14](r[7]))&&p(e,"cy",a)},d(r){r&&v(e)}}}function Ve(t){let e,i=ie(t[19]*t[7])+"",a,r,s=ie(t[19])+"",l,o,y,m,d,n,f,u,c;return{c(){e=E("text"),a=ee(i),r=ee(" @"),l=ee(s),d=E("circle"),this.h()},l(h){e=q(h,"text",{class:!0,style:!0,y:!0,dy:!0,"text-anchor":!0});var b=w(e);a=te(b,i),r=te(b," @"),l=te(b,s),b.forEach(v),d=q(h,"circle",{class:!0,style:!0,cx:!0,cy:!0,r:!0}),w(d).forEach(v),this.h()},h(){p(e,"class","hover svelte-1r3qimx"),p(e,"style",o=t[22](t[19]*t[7])),p(e,"y",y=t[14](0)),p(e,"dy",m=8),p(e,"text-anchor","middle"),p(d,"class","hover svelte-1r3qimx"),p(d,"style",n=t[22](t[19]*t[7])),p(d,"cx",f=0),p(d,"cy",u=t[14](t[7])),p(d,"r",c=4)},m(h,b){g(h,e,b),R(e,a),R(e,r),R(e,l),t[39](e),g(h,d,b)},p(h,b){b[0]&524416&&i!==(i=ie(h[19]*h[7])+"")&&ce(a,i),b[0]&524288&&s!==(s=ie(h[19])+"")&&ce(l,s),b[0]&4718720&&o!==(o=h[22](h[19]*h[7]))&&p(e,"style",o),b[0]&16384&&y!==(y=h[14](0))&&p(e,"y",y),b[0]&4718720&&n!==(n=h[22](h[19]*h[7]))&&p(d,"style",n),b[0]&16512&&u!==(u=h[14](h[7]))&&p(d,"cy",u)},d(h){h&&v(e),t[39](null),h&&v(d)}}}function Et(t){let e,i,a,r,s,l,o,y=[{class:"graphArea"},{width:t[0]},t[23]],m={};for(let c=0;c<y.length;c+=1)m=H(m,y[c]);let d=t[17]&&Oe(t),n=t[18]&&Ve(t),f=[{class:"hitArea"},{width:t[0]},t[23]],u={};for(let c=0;c<f.length;c+=1)u=H(u,f[c]);return{c(){e=E("svg"),i=E("rect"),d&&d.c(),a=k(),n&&n.c(),r=E("rect"),this.h()},l(c){e=q(c,"svg",{height:!0,viewBox:!0,xmlns:!0,class:!0});var h=w(e);i=q(h,"rect",{class:!0,width:!0}),w(i).forEach(v),d&&d.l(h),a=k(),n&&n.l(h),r=q(h,"rect",{class:!0,width:!0}),w(r).forEach(v),h.forEach(v),this.h()},h(){I(i,m),P(i,"svelte-1r3qimx",!0),I(r,u),P(r,"svelte-1r3qimx",!0),p(e,"height",t[2]),p(e,"viewBox",s=`0 0 ${t[0]} ${t[2]}`),p(e,"xmlns","http://www.w3.org/2000/svg"),p(e,"class","svelte-1r3qimx")},m(c,h){g(c,e,h),R(e,i),d&&d.m(e,null),R(e,a),n&&n.m(e,null),R(e,r),t[42](e),l||(o=[J(r,"mouseenter",t[40]),J(r,"mouseleave",t[41]),J(r,"mousemove",t[27]),J(r,"click",t[28])],l=!0)},p(c,h){I(i,m=U(y,[{class:"graphArea"},h[0]&1&&{width:c[0]},h[0]&8388608&&c[23]])),P(i,"svelte-1r3qimx",!0),c[17]?d?d.p(c,h):(d=Oe(c),d.c(),d.m(e,a)):d&&(d.d(1),d=null),c[18]?n?n.p(c,h):(n=Ve(c),n.c(),n.m(e,r)):n&&(n.d(1),n=null),I(r,u=U(f,[{class:"hitArea"},h[0]&1&&{width:c[0]},h[0]&8388608&&c[23]])),P(r,"svelte-1r3qimx",!0),h[0]&4&&p(e,"height",c[2]),h[0]&5&&s!==(s=`0 0 ${c[0]} ${c[2]}`)&&p(e,"viewBox",s)},i:V,o:V,d(c){c&&v(e),d&&d.d(),n&&n.d(),t[42](null),l=!1,tt(o)}}}let He=8;function qt(t,e,i){let a,r,s,l,o,y,m,d,n,f,u=V,c=()=>(u(),u=st(a,_=>i(16,f=_)),a),h;t.$$.on_destroy.push(()=>u());let{compact:b=!1}=e,{height:W=b?24:40}=e,{width:j=500}=e,{extents:S=[0,1e3]}=e,{type_id:O=null}=e,pe=ke("marketFilterLocation");de(t,pe,_=>i(38,h=_));let Y=()=>!0;function ye(_,M){return _?M?_.filter(Y)[0]:_[0]:null}let{buyOverheadRate:le=0}=e,{sellOverheadRate:K=0}=e,G=null,B=null,{lowestSellPrice:se=0}=e,{highestBuyPrice:ae=0}=e,{price:F=null}=e,{overridePrice:L=null}=e,Q=null,ue=null,{totalCost:Z=null}=e,{quantity:D=1}=e,Ue=b?[0,W-He]:[0,W-2*He],ve=!1,ne=[],oe=!1,N=[],x=0,$=0;function be(_){var X;let M=_.clientX-_.target.getBoundingClientRect().left;$=nt(N,C=>Math.abs(C.price*D-l.invert(M))/D),i(19,x=(X=N[$])==null?void 0:X.price)}function We(_){var M;((M=N[$])==null?void 0:M.is_buy_order)!==void 0&&(i(34,Q=x),i(34,Q*=1+(N[$].is_buy_order?le:K)))}function ge(_){i(0,j=T.getBoundingClientRect().width)}let T;it(()=>{i(0,j=T.getBoundingClientRect().width),window.addEventListener("resize",ge)}),rt(()=>{window.removeEventListener("resize",ge)});let A;lt(()=>{if(A){let _=A.getBBox().width/2,M=l(x*D);M-_<0?A.setAttribute("style",`transform: translateX(${M+_}px)`):M+_>j&&A.setAttribute("style",`transform: translateX(${M-_}px)`)}});function Ye(_){Ne[_?"unshift":"push"](()=>{A=_,i(21,A)})}const Ke=_=>{i(18,oe=!0),be(_)},Ze=_=>i(18,oe=!1);function xe(_){Ne[_?"unshift":"push"](()=>{T=_,i(20,T)})}return t.$$set=_=>{"compact"in _&&i(31,b=_.compact),"height"in _&&i(2,W=_.height),"width"in _&&i(0,j=_.width),"extents"in _&&i(32,S=_.extents),"type_id"in _&&i(3,O=_.type_id),"buyOverheadRate"in _&&i(4,le=_.buyOverheadRate),"sellOverheadRate"in _&&i(5,K=_.sellOverheadRate),"lowestSellPrice"in _&&i(29,se=_.lowestSellPrice),"highestBuyPrice"in _&&i(30,ae=_.highestBuyPrice),"price"in _&&i(1,F=_.price),"overridePrice"in _&&i(33,L=_.overridePrice),"totalCost"in _&&i(6,Z=_.totalCost),"quantity"in _&&i(7,D=_.quantity)},t.$$.update=()=>{var _,M,X;if(t.$$.dirty[0]&8&&c(i(15,a=O&&wt(O))),t.$$.dirty[1]&128&&i(8,Y=C=>h?C.location_id===h:!0),t.$$.dirty[0]&65536|t.$$.dirty[1]&128&&(i(9,G=ye(f==null?void 0:f.orders.buy,h)),i(10,B=ye(f==null?void 0:f.orders.sell,h))),t.$$.dirty[0]&1536&&(i(29,se=B==null?void 0:B.price),i(30,ae=G==null?void 0:G.price)),t.$$.dirty[0]&98304&&((f==null?void 0:f.orders)?a==null||a.status:dt.loading),t.$$.dirty[0]&1056&&i(37,r=(B==null?void 0:B.price)*(1+K)),t.$$.dirty[0]&8|t.$$.dirty[1]&16&&ue!==O&&(i(34,Q=null),i(35,ue=O)),t.$$.dirty[0]&2|t.$$.dirty[1]&76&&(i(1,F=(_=L!=null?L:Q)!=null?_:r),isNaN(F)&&i(1,F=0)),t.$$.dirty[0]&192&&i(13,s=Z/D),t.$$.dirty[0]&1|t.$$.dirty[1]&2&&i(12,l=Pe().domain([S[0],S[1]]).range([0,j])),t.$$.dirty[0]&128&&i(14,o=Pe().domain([D*4,0]).range(Ue)),t.$$.dirty[0]&4224&&i(25,y=at().curve(ut).x(C=>l(C.price*D))),t.$$.dirty[0]&16384&&i(24,m=()=>{let C=0;return z=>(C+=z.volume_remain,o(C))}),t.$$.dirty[0]&2048|t.$$.dirty[1]&2){i(17,ve=S[1]>S[0]),i(11,ne=[]);let C=10;for(let z=1e6;z<S[1];z*=C)ne.push(z)}t.$$.dirty[0]&16384&&i(23,d={y:Math.min(o.range()[0],o.range()[1]),height:Math.abs(o.range()[0]-o.range()[1])}),t.$$.dirty[0]&4096&&i(22,n=C=>`transform: translateX(${l(C)}px)`),t.$$.dirty[0]&74048|t.$$.dirty[1]&32&&(f&&f.orders?i(36,N=(X=f==null?void 0:f.orders)==null?void 0:X.buy.concat((M=f==null?void 0:f.orders)==null?void 0:M.sell).filter(Y)):i(36,N=[]),Z&&i(36,N=[...N,{price:s}]))},[j,F,W,O,le,K,Z,D,Y,G,B,ne,l,s,o,a,f,ve,oe,x,T,A,n,d,m,y,pe,be,We,se,ae,b,S,L,Q,ue,N,r,h,Ye,Ke,Ze,xe]}class Ot extends we{constructor(e){super();Me(this,e,qt,Et,Ee,{compact:31,height:2,width:0,extents:32,type_id:3,buyOverheadRate:4,sellOverheadRate:5,lowestSellPrice:29,highestBuyPrice:30,price:1,overridePrice:33,totalCost:6,quantity:7},null,[-1,-1])}}class Ct{constructor(e,i){var a,r,s,l,o,y,m;this.activity=e,this.selectedProduct=(m=(y=(r=(a=this.activity)==null?void 0:a.products[i])==null?void 0:r.type_id)!=null?y:(o=Object.values((l=(s=this.activity)==null?void 0:s.products)!=null?l:{})[0])==null?void 0:o.type_id)!=null?m:null,this.facilityModifiers={taxRate:10,systemCostIndex:.05},this.prices={},this.indexPrices={},this.blueprintCostPerRun=0,this.runs=1}get producedQuantity(){var e;return((e=this.activity)==null?void 0:e.products[this.selectedProduct].quantity)*this.runs}set requiredQuantity(e){var i,a;this.runs=Math.ceil(e/((a=(i=this.activity)==null?void 0:i.products[this.selectedProduct])==null?void 0:a.quantity))}qty(e){var a,r,s;if(e==null)return 0;let i=me(e*this.runs,[{value:-((a=this.blueprintModifiers)==null?void 0:a.materialEfficiency)},{value:(r=this.facilityModifiers.roleModifiers)==null?void 0:r.materialConsumption},{value:(s=this.facilityModifiers.rigModifiers)==null?void 0:s.materialReduction}]);return Math.max(this.runs,Math.ceil(i))}materialQuantity(e){var i,a;return this.qty((a=(i=this.activity)==null?void 0:i.materials[e])==null?void 0:a.quantity)}get estimatedItemValue(){var i,a,r,s;let e=0;for(let l in(a=(i=this.activity)==null?void 0:i.materials)!=null?a:[])e+=this.activity.materials[l].quantity*((s=(r=this.indexPrices[l])==null?void 0:r.adjusted_price)!=null?s:0);return e}get jobCost(){var i;return me(this.estimatedItemValue*this.facilityModifiers.systemCostIndex*this.runs,[{value:(i=this.facilityModifiers.roleModifiers)==null?void 0:i.jobCost},{value:this.facilityModifiers.taxRate}])}get totalCost(){var i,a,r,s;let e=0;for(let l in(a=(i=this.activity)==null?void 0:i.materials)!=null?a:[])e+=this.qty(this.activity.materials[l].quantity)*((r=this.prices[l])!=null?r:0);return e+=this.jobCost,e+=((s=this.blueprintCostPerRun)!=null?s:0)*this.runs,e}get unitCost(){return this.totalCost/this.producedQuantity}get jobDuration(){var e,i,a,r,s;return me(((e=this.activity)==null?void 0:e.time)*this.runs,[{value:-((i=this.blueprintModifiers)==null?void 0:i.timeEfficiency)},{value:(a=this.characterModifiers)==null?void 0:a.skill_jobDuration},{value:(r=this.facilityModifiers.roleModifiers)==null?void 0:r.jobDuration},{value:(s=this.facilityModifiers.rigModifiers)==null?void 0:s.timeReduction}])}get profit(){return this.prices[this.selectedProduct]*this.producedQuantity-this.totalCost}}function It(t,e){let i=new Ct(t,e),{subscribe:a,set:r}=ot(i);return{subscribe:a,update:s=>{for(let l in s){if(l=="indexPrices"){i[l]=s[l];continue}if(!i[l]||typeof s[l]!="object")i[l]=s[l];else for(let o in s[l])i[l][o]=s[l][o]}r(i)}}}function Gt(t,e){var a;let i=(a=e.get(t))==null?void 0:a.activity;return It(i,t)}export{me as A,Gt as C,jt as I,Ot as M,At as a,St as b,wt as c,Dt as g,Rt as p};
